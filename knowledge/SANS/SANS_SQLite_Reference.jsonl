{"text": "SQLite databases are a self-contained database stored as a file system file (but may have a few supporting files that will also be needed for analysis!) Files have the magic number \"SQLite format 3\". SQLite files correspond to a database that contains tables. Tables contain rows of data with corresponding columns that describe the data in the row.", "metadata": {"source": "SANS_SQLite", "title": "SQLite Database Basics", "category": "reference", "platform": "windows"}}
{"text": "Some temporary files may also be created, including Journal files and Write Ahead Logs. Journal files store original data before a transaction change so the database can be restored to a known state if an error occurs. They are created by default.", "metadata": {"source": "SANS_SQLite", "title": "Journal Files", "category": "reference", "platform": "windows"}}
{"text": "Write Ahead Logs (WAL) contain new data changes, leaving original database untouched. After a set number of page changes, the WAL is used to update the actual database. Write ahead logs are optional.", "metadata": {"source": "SANS_SQLite", "title": "Write Ahead Logs (WAL)", "category": "reference", "platform": "windows"}}
{"text": "DB Browser for SQLite - Free GUI utility available for Mac/Windows/*nix - sqlitebrowser.org", "metadata": {"source": "SANS_SQLite", "title": "SQLite Analysis Tools - DB Browser", "category": "reference", "platform": "windows"}}
{"text": "sqlite3 - Free CLI utility available for (or native to) Mac/iOS/Android/*nix/Windows - sqlite.org/cli.html", "metadata": {"source": "SANS_SQLite", "title": "SQLite Analysis Tools - sqlite3 CLI", "category": "reference", "platform": "windows"}}
{"text": "SQLite Spy - Free GUI utility for Windows - https://www.yunqa.de/delphi/products/sqlitespy/index", "metadata": {"source": "SANS_SQLite", "title": "SQLite Analysis Tools - SQLite Spy", "category": "reference", "platform": "windows"}}
{"text": "Sanderson Forensic Toolkit for SQLite - Commercial GUI utility for Windows - sandersonforensics.com", "metadata": {"source": "SANS_SQLite", "title": "SQLite Analysis Tools - Sanderson Forensic Toolkit", "category": "reference", "platform": "windows"}}
{"text": "SQLite Miner - Free script to extract blobs from databases - https://github.com/threeplanetssoftware/sqlite_miner", "metadata": {"source": "SANS_SQLite", "title": "SQLite Analysis Tools - SQLite Miner", "category": "reference", "platform": "windows"}}
{"text": "NULL - NULL Value", "metadata": {"source": "SANS_SQLite", "title": "Data Types - NULL", "category": "reference", "platform": "windows"}}
{"text": "INTEGER - Signed Integer", "metadata": {"source": "SANS_SQLite", "title": "Data Types - INTEGER", "category": "reference", "platform": "windows"}}
{"text": "REAL - Floating Point Number", "metadata": {"source": "SANS_SQLite", "title": "Data Types - REAL", "category": "reference", "platform": "windows"}}
{"text": "TEXT - Text String (UTF-8, UTF-16BE or UTF-16LE)", "metadata": {"source": "SANS_SQLite", "title": "Data Types - TEXT", "category": "reference", "platform": "windows"}}
{"text": "BLOB - (Binary Large OBjects) to store large chunks of data. This data may be a picture, video, audio, or archive (Gzip) files. This data is not defined in the database, it may contain anything an app developer desires. This data is often overlooked but may contain forensic nuggets of gold!", "metadata": {"source": "SANS_SQLite", "title": "Data Types - BLOB", "category": "reference", "platform": "windows"}}
{"text": "Arithmetic Operators: Addition [ + ], Subtraction [ - ], Multiplication [ * ], Division [ / ], Modulus [ % ]", "metadata": {"source": "SANS_SQLite", "title": "Operators - Arithmetic", "category": "reference", "platform": "windows"}}
{"text": "Comparison Operators: Equal [ == ] or [ = ], Not Equal [ != ] or [ <> ], Greater Than [ > ] or Greater Than or Equal [ >=], Less Than [ < ] or Less Than or Equal [ <= ]", "metadata": {"source": "SANS_SQLite", "title": "Operators - Comparison", "category": "reference", "platform": "windows"}}
{"text": "IS / IS NOT - Equal/Not Equal", "metadata": {"source": "SANS_SQLite", "title": "Operators - Logic - IS", "category": "reference", "platform": "windows"}}
{"text": "IN / NOT IN - Is value in (or not) a list of values?", "metadata": {"source": "SANS_SQLite", "title": "Operators - Logic - IN", "category": "reference", "platform": "windows"}}
{"text": "LIKE (Case Insensitive) / GLOB (Case Sensitive) - Is value like this other value? Uses wildcards.", "metadata": {"source": "SANS_SQLite", "title": "Operators - Logic - LIKE and GLOB", "category": "reference", "platform": "windows"}}
{"text": "AND / OR - Use with WHERE clause to create complex logic.", "metadata": {"source": "SANS_SQLite", "title": "Operators - Logic - AND OR", "category": "reference", "platform": "windows"}}
{"text": "BETWEEN - Look for values between two values.", "metadata": {"source": "SANS_SQLite", "title": "Operators - Logic - BETWEEN", "category": "reference", "platform": "windows"}}
{"text": "Get everything from a single table: SELECT * FROM A_TABLE;", "metadata": {"source": "SANS_SQLite", "title": "Basic Query - Select All", "category": "reference", "platform": "windows"}}
{"text": "Get two columns from a single table: SELECT COLUMN_A, COLUMN_B FROM A_TABLE;", "metadata": {"source": "SANS_SQLite", "title": "Basic Query - Select Columns", "category": "reference", "platform": "windows"}}
{"text": "Column Renaming: A_TABLE.ZAWKWARDCOLUMNNAME AS \"Chat Messages\"", "metadata": {"source": "SANS_SQLite", "title": "Useful Stuff - Column Renaming", "category": "reference", "platform": "windows"}}
{"text": "Counting: SELECT COUNT(*) FROM A_TABLE;", "metadata": {"source": "SANS_SQLite", "title": "Useful Stuff - Counting", "category": "reference", "platform": "windows"}}
{"text": "Aggregating with GROUP BY and COUNT (Count chat messages per contact): SELECT MESSAGES,COUNT(*) FROM CHAT GROUP BY CONTACT;", "metadata": {"source": "SANS_SQLite", "title": "Useful Stuff - Aggregating", "category": "reference", "platform": "windows"}}
{"text": "Sorting with ORDER BY: SELECT * FROM CHAT ORDER BY A_TIMESTAMP ASC. ASC = Ascending, DESC = Descending", "metadata": {"source": "SANS_SQLite", "title": "Useful Stuff - Sorting", "category": "reference", "platform": "windows"}}
{"text": "Searching with WHERE and LIKE: SELECT CONTACT, MESSAGE FROM CHAT WHERE CONTACT LIKE '%Hank%'", "metadata": {"source": "SANS_SQLite", "title": "Useful Stuff - Searching", "category": "reference", "platform": "windows"}}
{"text": "LEFT JOIN - Resulting rows are returned from the LEFT table even if there are no matches in the right. Using the LEFT JOIN produced all the text messages including those with and without attachments.", "metadata": {"source": "SANS_SQLite", "title": "Table Joins - LEFT JOIN", "category": "reference", "platform": "windows"}}
{"text": "INNER JOIN - Resulting rows are returned when both items are a match. Using the INNER JOIN (also achieved by typing \"JOIN\" in the query) returned just the messages that included attachments.", "metadata": {"source": "SANS_SQLite", "title": "Table Joins - INNER JOIN", "category": "reference", "platform": "windows"}}
{"text": "SELECT ZVIBERMESSAGE.ZTEXT AS \"Message Text\", ZATTACHMENT.ZNAME AS \"Attachment Filename\", datetime(ZVIBERMESSAGE.ZDATE+978307200,'unixepoch','localtime') AS \"Message Date\", ZVIBERMESSAGE.ZSTATE AS \"Message Direction/State\" FROM ZVIBERMESSAGE LEFT JOIN ZATTACHMENT on ZATTACHMENT.Z_PK=ZVIBERMESSAGE.ZATTACHMENT", "metadata": {"source": "SANS_SQLite", "title": "Table Joins - LEFT JOIN Example", "category": "reference", "platform": "windows"}}
{"text": "Timestamps are stored in the databases as one of several numerical representations. (Timestamps are assumed to be stored in UTC, you may need to verify this.)", "metadata": {"source": "SANS_SQLite", "title": "Timestamp Conversion Overview", "category": "reference", "platform": "windows"}}
{"text": "UNIX Epoch (10-digit number - number of seconds since 01/01/1970 00:00:00): SELECT datetime(TS_COLUMN,'unixepoch')", "metadata": {"source": "SANS_SQLite", "title": "Timestamp Conversion - UNIX Epoch", "category": "reference", "platform": "windows"}}
{"text": "UNIX Epoch in local time as suggested by the device settings: SELECT datetime(TS_COLUMN,'unixepoch', 'localtime')", "metadata": {"source": "SANS_SQLite", "title": "Timestamp Conversion - UNIX Epoch Local Time", "category": "reference", "platform": "windows"}}
{"text": "UNIX Epoch MILLISECONDS (13-digit number - number of milliseconds since 01/01/1970 00:00:00): SELECT datetime(TS_COLUMN/1000,'unixepoch');", "metadata": {"source": "SANS_SQLite", "title": "Timestamp Conversion - UNIX Epoch Milliseconds", "category": "reference", "platform": "windows"}}
{"text": "Mac Absolute time, number of seconds since 01/01/2001 00:00:00. To correctly convert this timestamp, first, add the number of seconds since UNIXEPOCH time to Mac Absolute Time (978307200), then convert: SELECT datetime(TS_COLUMN + 978307200, 'unixepoch');", "metadata": {"source": "SANS_SQLite", "title": "Timestamp Conversion - Mac Absolute Time", "category": "reference", "platform": "windows"}}
{"text": "Chrome time accounts for time accurate to the MICROSECOND, which requires dividing the number by 1,000,000: SELECT datetime(TS_COLUMN/1000000 + (strftime('%s','1601-01-01')),'UNIXEPOCH');", "metadata": {"source": "SANS_SQLite", "title": "Timestamp Conversion - Chrome Time", "category": "reference", "platform": "windows"}}
{"text": "Use the command line version of the sqlite3 program (sqlite.org/cli.html) either in a SQLite shell, or just query via CLI: $ sqlite3 <db_file> or $ sqlite3 <db_file> 'select * from a_table'", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI Usage", "category": "reference", "platform": "windows"}}
{"text": ".help - Provides a list of these 'dot-commands'", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .help", "category": "reference", "platform": "windows"}}
{"text": ".tables - Show the table names in the database", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .tables", "category": "reference", "platform": "windows"}}
{"text": ".headers on - Show the column names in the output", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .headers", "category": "reference", "platform": "windows"}}
{"text": ".mode column - Show left-aligned columns", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .mode column", "category": "reference", "platform": "windows"}}
{"text": ".mode tabs - Show tab separated columns", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .mode tabs", "category": "reference", "platform": "windows"}}
{"text": ".output <filename> - Send output to file", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .output", "category": "reference", "platform": "windows"}}
{"text": ".dump - Dump database contents (use with .output)", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .dump", "category": "reference", "platform": "windows"}}
{"text": ".quit - Quit sqlite3 shell", "metadata": {"source": "SANS_SQLite", "title": "sqlite3 CLI - .quit", "category": "reference", "platform": "windows"}}
{"text": "The SQLite header for every database will contain offsets enabling you to differentiate if a journal or WAL is being used to support the database.", "metadata": {"source": "SANS_SQLite", "title": "WAL vs Journaling Detection", "category": "reference", "platform": "windows"}}
{"text": "File Offset 18 (1 byte) = x01 = Journaling, File Offset 19 (1 byte) = x01 = Journaling", "metadata": {"source": "SANS_SQLite", "title": "WAL vs Journaling - Journaling Header Values", "category": "reference", "platform": "windows"}}
{"text": "File Offset 18 (1 byte) = x02 = WAL, File Offset 19 (1 byte) = x02 = WAL", "metadata": {"source": "SANS_SQLite", "title": "WAL vs Journaling - WAL Header Values", "category": "reference", "platform": "windows"}}
{"text": "Examine the table to determine if data is moved to the free pages or a Boolean value is entered to mark the data deleted.", "metadata": {"source": "SANS_SQLite", "title": "SQLite Deletion - Examine Table", "category": "reference", "platform": "windows"}}
{"text": "Use a SQLite Editor to examine the free pages in a Hex view to carve for deleted artifacts.", "metadata": {"source": "SANS_SQLite", "title": "SQLite Deletion - Hex View Carving", "category": "reference", "platform": "windows"}}
{"text": "Use scripts and tools available to conduct a cursory scan of the free pages for deleted SQLite entries.", "metadata": {"source": "SANS_SQLite", "title": "SQLite Deletion - Free Pages Scanning", "category": "reference", "platform": "windows"}}
{"text": "SQLite Deleted Records Parser - Python script and GUI to parse deleted data from SQLite databases - https://github.com/mdegrazia/SQLite-Deleted-RecordsParser/tree/master/Old_Versions/sqlparse_v1_1", "metadata": {"source": "SANS_SQLite", "title": "SQLite Deletion - Deleted Records Parser Tool", "category": "reference", "platform": "windows"}}
{"text": "Official SQLite Documentation: https://sqlite.org", "metadata": {"source": "SANS_SQLite", "title": "References - Official Documentation", "category": "reference", "platform": "windows"}}
{"text": "FOR518 - Mac Forensic Analysis - FOR518.com", "metadata": {"source": "SANS_SQLite", "title": "References - SANS FOR518", "category": "reference", "platform": "windows"}}
{"text": "FOR585 - Advanced Smartphone Forensics - FOR585.com", "metadata": {"source": "SANS_SQLite", "title": "References - SANS FOR585", "category": "reference", "platform": "windows"}}
