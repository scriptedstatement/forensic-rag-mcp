{"text": "This reference supports the SANS Institute FOR508 Advanced Incident Response, Threat Hunting, and Digital Forensics Course. It is not intended to be an exhaustive resource for MemProcFS, Volatility, or any other tools. Volatility is a trademark of the Volatility Foundation. The SANS Institute is not sponsored, approved by, or affiliated with the Volatility Foundation.", "metadata": {"source": "SANS_Memory_Forensics", "title": "Memory Forensics Cheat Sheet - Purpose", "category": "memory", "platform": "windows"}}
{"text": "Memory analysis is one of the most powerful tools available to forensic examiners. This guide aims to document and simplify the overwhelming number of tools and available capabilities. Windows memory analysis can generally be split into six steps: 1. Identify Rogue Processes 2. Analyze Process Objects 3. Review Network Artifacts 4. Look for Evidence of Code Injection 5. Audit Drivers and Rootkit Detection 6. Dump Memory Objects of Interest", "metadata": {"source": "SANS_Memory_Forensics", "title": "Memory Forensics - How To Use This Document", "category": "memory", "platform": "windows"}}
{"text": "In this reference guide we outline the most useful MemProcFS and Volatility capabilities to support these six stages of memory forensics. Further information is provided for: Memory Acquisition, Live Memory Scanning, Using Indicators of Compromise, Alternate Windows Memory Locations", "metadata": {"source": "SANS_Memory_Forensics", "title": "Memory Forensics - Topics Covered", "category": "memory", "platform": "windows"}}
{"text": "WinPmem https://github.com/Velocidex/WinPmem Execute command terminal as Administrator. Options: -d Output to <filename>, -l Load driver for live memory analysis. Example: winpmem_mini_x64_<version>.exe -d D:\\mem.img (64-bit)", "metadata": {"source": "SANS_Memory_Forensics", "title": "WinPmem - Memory Acquisition", "category": "memory", "platform": "windows"}}
{"text": "Magnet DumpIt https://for508.com/dumpit Options: /OUTPUT Image destination, /TYPE Memory output format (RAW | DMP), /NOCOMPRESS Do not compress output when > 32GB. Example: DumpIt.exe /TYPE DMP /OUTPUT D:\\mem.img", "metadata": {"source": "SANS_Memory_Forensics", "title": "Magnet DumpIt - Memory Acquisition", "category": "memory", "platform": "windows"}}
{"text": "Moneta - Memory scanning tool looking for dynamic/unknown code, suspicious PE image regions, and advanced indicators of compromise. https://github.com/forrest-orr/moneta Options: -p Process IDs to scan (* for all), -m ioc Scan only suspicious memory regions (-m * for all), -d Dump selected process memory to local file system, --filter Limit scans to reduce false positives (* | unsigned-module | metadata-modules | clr-heap | clr-prvx | wow64-init). Example: moneta64.exe -m ioc -p * --filter * -d", "metadata": {"source": "SANS_Memory_Forensics", "title": "Moneta - Live Memory Scanning", "category": "memory", "platform": "windows"}}
{"text": "Hollows Hunter - Identifies potential process implants, shellcode, hooks, and in-memory patches. https://github.com/hasherezade/hollows_hunter Options: /pname Scan specific processes by name, /pid Scan specific processes by PID, /dnet Set policy for skipping .NET processes, /hooks Detect code patches and inline hooks (noisy), /dir Directory to save dumps and reporting. Example: hollows_hunter64.exe /pid 1290;454 /dir .\\Output", "metadata": {"source": "SANS_Memory_Forensics", "title": "Hollows Hunter - Live Memory Scanning", "category": "memory", "platform": "windows"}}
{"text": "Get-InjectedThreadEx - Find suspicious threads (and associated processes) indicative of code injection. https://github.com/jdu2600/Get-InjectedThreadEx Example: Get-InjectedThreadEx.exe > .\\output.txt", "metadata": {"source": "SANS_Memory_Forensics", "title": "Get-InjectedThreadEx - Live Memory Scanning", "category": "memory", "platform": "windows"}}
{"text": "Hibernation File (Compressed): C:\\hiberfil.sys. Page and Swap Files: C:\\pagefile.sys, C:\\swapfile.sys (Windows 8+ \\ Server 2012+). Crash Dump: C:\\Windows\\MEMORY.DMP. In rare instances locations can differ from the defaults (except hiberfil.sys).", "metadata": {"source": "SANS_Memory_Forensics", "title": "Alternate Windows Memory Locations", "category": "memory", "platform": "windows"}}
{"text": "Volatility 3 VadYaraScan. Option: --yara-file Text file of YARA rules. Example: vol.py -f mem.img windows.vadyarascan --yara-file rules", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 VadYaraScan - YARA Analysis", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS includes built-in YARA signatures from Elastic Security. Add to Command line: -license-accept-elastic-license-2-0. Built-in YARA hits: M:\\forensic\\csv\\findevil.csv. Include Custom Signatures: -forensic-yara-rules rules. Custom YARA hits: M:\\forensic\\yara", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS YARA Integration", "category": "memory", "platform": "windows"}}
{"text": "Many Volatility 3 plugins have an option to \"--dump\" objects: pslist, psscan, dlllist, modules, modscan, malfind. Example: vol.py -f mem.img windows.pslist.PsList --pid 840 --dump. Extraction plugins also exist for other Windows memory objects: windows.memmap.Memmap, windows.filescan.FileScan, windows.dumpfiles.DumpFiles, windows.mftscan.MFTScan, windows.svcscan.SvcScan", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 - Dump Memory Objects", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS (Windows Memory Analysis) https://github.com/ufrisk/MemProcFS Command: MemProcFS.exe [options] -device <memory image>. Options: -device: Memory image (includes hibernation file support), -v: Enable verbose auditing in console, -pagefile0: Specify pagefile.sys file (not required), -pagefile1: Specify swapfile.sys file (not required), -mount: Drive letter for analysis output (M:\\ is default), -forensic [0-4]: Start forensic scan of memory upon startup.", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS Overview", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS -forensic [0-4] options: 0 = not enabled (default value), 1 = forensic mode with in-memory sqlite database, 2 = forensic mode with temp sqlite database deleted upon exit, 3 = forensic mode with temp sqlite database remaining upon exit, 4 = forensic mode with static named sqlite database (vmm.sqlite3)", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS Forensic Mode Options", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS Processes: Process Tree: M:\\sys\\proc\\proc.txt. CSV (requires -forensic): M:\\forensic\\csv\\process.csv. Process Objects: Objects represented as files. Use a simple copy/paste for \"dumping\". By PID: M:\\pid. By Name: M:\\name", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS - Process Analysis", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS Network Artifacts: Text: M:\\sys\\net\\netstat.txt. CSV (requires -forensic): M:\\forensic\\csv\\net.csv", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS - Network Artifacts", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS Code Injection and Anomaly Detection (requires -forensic): Text: M:\\forensic\\findevil\\findevil.txt. CSV: M:\\forensic\\csv\\findevil.csv", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS - Code Injection and Anomaly Detection", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS Cached Files (requires -forensic): Extracted files in virtualized file system: M:\\forensic\\files. List of available cached files: M:\\forensic\\csv\\files.csv", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS - Cached Files", "category": "memory", "platform": "windows"}}
{"text": "MemProcFS Other Analysis Capabilities (most require -forensic): Virtualized Registry: M:\\registry. MFT Virtualized File System: M:\\forensic\\ntfs. Drivers: M:\\forensic\\csv\\drivers.csv. Services: M:\\forensic\\csv\\services.csv. Scheduled Tasks: M:\\forensic\\csv\\tasks.csv. Forensic Timeline: M:\\forensic\\csv\\timeline_all.csv", "metadata": {"source": "SANS_Memory_Forensics", "title": "MemProcFS - Other Analysis Capabilities", "category": "memory", "platform": "windows"}}
{"text": "Getting Help (Windows / Linux / Mac Memory Analysis) https://github.com/volatilityfoundation/volatility3. vol.py -h (show options and supported plugins). vol.py plugin -h (show plugin usage)", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 - Getting Help", "category": "memory", "platform": "windows"}}
{"text": "Sample Command Line: vol.py -f mem.img plugin. Query Memory Image Metadata (OS Profile & SystemTime): vol.py -f mem.img windows.info.Info", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 - Basic Usage", "category": "memory", "platform": "windows"}}
{"text": "Create and use JSON Config File to Accelerate Processing: vol.py --write-config -f mem.img windows.info.Info. vol.py -c config.json -f mem.img plugin", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 - JSON Config File", "category": "memory", "platform": "windows"}}
{"text": "Output and Format Options. These options must precede the plugin within the command-line: -r <csv | pretty | json> Output format, -o folder Output folder for extracted items (useful with --dump). Plugin specific options must follow the plugin name: --pid PID1,PID2 Limit data to specific process IDs (most plugins). Plugin names can be shortened if they still result in a unique match. Example: vol.py -f mem.img -r csv windows.pslist --pid 4", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 - Output and Format Options", "category": "memory", "platform": "windows"}}
{"text": "pslist - High level view of running processes. Option: --dump Extract process executables. Example: vol.py -f mem.img windows.pslist.PsList", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 pslist - Identify Rogue Processes", "category": "memory", "platform": "windows"}}
{"text": "psscan - Deep scan of memory for EPROCESS blocks. Example: vol.py -f mem.img windows.psscan.PsScan", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 psscan - Identify Rogue Processes", "category": "memory", "platform": "windows"}}
{"text": "pstree - Display parent-process relationships. Option: --pid Display mini-process tree for single parent process. Example: vol.py -f mem.img windows.pstree.PsTree", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 pstree - Identify Rogue Processes", "category": "memory", "platform": "windows"}}
{"text": "dlllist - List of loaded DLLs by process. Option: --dump Extract DLLs from the memory image. Example: vol.py -f mem.img windows.dlllist.DllList --pid 840", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 dlllist - Analyze Process Objects", "category": "memory", "platform": "windows"}}
{"text": "cmdline - Display process command lines from PEB. Example: vol.py -f mem.img windows.cmdline.CmdLine", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 cmdline - Analyze Process Objects", "category": "memory", "platform": "windows"}}
{"text": "getsids - Print process security identifiers. Example: vol.py -f mem.img windows.getsids.GetSIDs", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 getsids - Analyze Process Objects", "category": "memory", "platform": "windows"}}
{"text": "handles - List of open handles for each process. Pipe results to egrep to display only handles of a certain type. Example: vol.py -f mem.img windows.handles.Handles --pid 840 | egrep 'File|Key|Mutant'", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 handles - Analyze Process Objects", "category": "memory", "platform": "windows"}}
{"text": "netstat - Display data from network tracking structures. Example: vol.py -f mem.img windows.netstat.NetStat", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 netstat - Review Network Artifacts", "category": "memory", "platform": "windows"}}
{"text": "netscan - Deep scan for network connections and sockets. Option: --include-corrupt Relax validation for more results. Example: vol.py -f mem.img windows.netscan.NetScan", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 netscan - Review Network Artifacts", "category": "memory", "platform": "windows"}}
{"text": "malfind - Find suspicious RWX sections not mapped to disk. Option: --dump Save suspicious memory sections to a folder. Example: vol.py -f mem.img -o tmp windows.malfind.Malfind --dump", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 malfind - Code Injection Detection", "category": "memory", "platform": "windows"}}
{"text": "ldrmodules - Detect unlinked DLLs. Example: vol.py -f mem.img windows.ldrmodules.LdrModules", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 ldrmodules - Code Injection Detection", "category": "memory", "platform": "windows"}}
{"text": "modules - View list of loaded kernel drivers. Options: --dump Extract listed drivers, --name driver Info on named driver (can use with --dump). Example: vol.py -f mem.img windows.modules.Modules --name ks.sys", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 modules - Audit Drivers and Rootkit Detection", "category": "memory", "platform": "windows"}}
{"text": "modscan - Scan for loaded, unloaded, and unlinked drivers. Option: --dump Extract all available drivers. Example: vol.py -f mem.img -o tmp windows.modscan.ModScan --dump", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 modscan - Audit Drivers and Rootkit Detection", "category": "memory", "platform": "windows"}}
{"text": "ssdt - Output System Service Descriptor Table. Example: vol.py -f mem.img windows.ssdt.SSDT", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 ssdt - Audit Drivers and Rootkit Detection", "category": "memory", "platform": "windows"}}
{"text": "driverirp - Print driver IRP (major function) tables. Example: vol.py -f mem.img windows.driverirp.DriverIrp", "metadata": {"source": "SANS_Memory_Forensics", "title": "Volatility 3 driverirp - Audit Drivers and Rootkit Detection", "category": "memory", "platform": "windows"}}
