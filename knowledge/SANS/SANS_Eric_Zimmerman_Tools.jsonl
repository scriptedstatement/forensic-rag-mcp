{"text": "Eric Zimmerman tools Cheat Sheet v1.0", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Eric Zimmerman Tools Cheat Sheet", "category": "tools", "platform": "windows"}}
{"text": "Incident Responders are on the front lines of intrusion investigations. This guide aims to support DFIR analysts in their quest to uncover the truth.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Purpose Statement", "category": "tools", "platform": "windows"}}
{"text": "This cheat sheet covers the basics of using several command line programs by Eric Zimmerman.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Cheat Sheet Overview", "category": "tools", "platform": "windows"}}
{"text": "This sheet is split into these sections: Lnk files with LECmd, Prefetch files with PECmd, Jumplists with JLECmd, String searching with bstrings, Shimcache with AppCompatCacheParser, Amcache.hve with AmcacheParser", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Sheet Sections", "category": "tools", "platform": "windows"}}
{"text": "Individual tools are available at https://ericzimmerman.github.io/. Chocolatey packages for each are also available. To get all tools at once, use chocolatey to install the EricZimmermanTools package", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Download Location", "category": "tools", "platform": "windows"}}
{"text": "Most tools have common options for exporting data, displaying higher precision timestamps, using custom date formats, etc.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Common Functionality", "category": "tools", "platform": "windows"}}
{"text": "When --mp is used, higher precision timestamps are displayed and will also be reflected in any exported data.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "High Precision Timestamps", "category": "tools", "platform": "windows"}}
{"text": "Data can be exported to several formats such as csv, json, HTML, etc. at the same time.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Export Formats", "category": "tools", "platform": "windows"}}
{"text": "PECmd.exe -d <directory> --csv c:\\temp --html c:\\temp\\html", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "Multi-format Export Example", "category": "tools", "platform": "windows"}}
{"text": "Shimcache with AppCompatCacheParser - Type of artifact: Evidence of execution", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AppCompatCacheParser Artifact Type", "category": "tools", "platform": "windows"}}
{"text": "AppCompatCacheParser.exe -f <path to>\\SYSTEM --csv c:\\temp", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AppCompatCacheParser Basic Usage", "category": "tools", "platform": "windows"}}
{"text": "AppCompatCacheParser output file is a tab separated file that can be imported into Timeline Explorer or Excel.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AppCompatCacheParser Output Format", "category": "tools", "platform": "windows"}}
{"text": "AppCompatCacheParser key data: Full path for executable and execution flag", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AppCompatCacheParser Key Data", "category": "tools", "platform": "windows"}}
{"text": "AppCompatCacheParser.exe --csv c:\\temp - Omitting -f switch pulls AppCompatCache data from the Registry hive loaded into memory.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AppCompatCacheParser Live Registry", "category": "tools", "platform": "windows"}}
{"text": "The -d switch can be used to inspect all available details for an entry in AppCompatCacheParser", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AppCompatCacheParser Details Switch", "category": "tools", "platform": "windows"}}
{"text": "Amcache.hve with AmcacheParser - Type of artifact: Evidence of execution", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser Artifact Type", "category": "tools", "platform": "windows"}}
{"text": "AmcacheParser.exe -f <path to>\\Amcache.hve --csv c:\\temp", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser Basic Usage", "category": "tools", "platform": "windows"}}
{"text": "AmcacheParser output file is a tab separated file that can be imported into Timeline Explorer or Excel.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser Output Format", "category": "tools", "platform": "windows"}}
{"text": "AmcacheParser key data - FullPath: The full path to the executed file", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser FullPath Field", "category": "tools", "platform": "windows"}}
{"text": "AmcacheParser key data - SHA-1: The SHA-1 hash of the file", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser SHA-1 Field", "category": "tools", "platform": "windows"}}
{"text": "AmcacheParser key data - FileIDLastWriteTimestamp: First executed timestamp", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser Timestamp Field", "category": "tools", "platform": "windows"}}
{"text": "AmcacheParser key data - MFTEntryNumber: NTFS entry number from FILE record", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser MFT Entry Field", "category": "tools", "platform": "windows"}}
{"text": "AmcacheParser key data - MFTSequenceNumber: NTFS sequence number from FILE record", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser MFT Sequence Field", "category": "tools", "platform": "windows"}}
{"text": "Use the -b and -w switches to blacklist or whitelist SHA-1 hashes to further reduce the amount of data to review in AmcacheParser", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser Hash Filtering", "category": "tools", "platform": "windows"}}
{"text": "Use -i to generate a list of associated program/file entries in AmcacheParser", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "AmcacheParser Associated Entries", "category": "tools", "platform": "windows"}}
{"text": "Lnk files with LECmd - Type of artifact: Document creation and opening", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "LECmd Artifact Type", "category": "tools", "platform": "windows"}}
{"text": "LECmd.exe -f <file>", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "LECmd Single File Usage", "category": "tools", "platform": "windows"}}
{"text": "LECmd.exe -d <directory>", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "LECmd Directory Usage", "category": "tools", "platform": "windows"}}
{"text": "LECmd key data: Target timestamps, Volume information, Absolute file path, Target ID information", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "LECmd Key Data", "category": "tools", "platform": "windows"}}
{"text": "Use the --all switch to process all files in a directory vs. only those ending in '.lnk' in LECmd.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "LECmd All Files Switch", "category": "tools", "platform": "windows"}}
{"text": "Prefetch files with PECmd - Type of artifact: Evidence of execution", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "PECmd Artifact Type", "category": "tools", "platform": "windows"}}
{"text": "PECmd.exe -f <file>", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "PECmd Single File Usage", "category": "tools", "platform": "windows"}}
{"text": "PECmd.exe -d <directory>", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "PECmd Directory Usage", "category": "tools", "platform": "windows"}}
{"text": "PECmd default output is to standard out. Data can be exported to several formats such as csv, json, HTML, etc.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "PECmd Output Options", "category": "tools", "platform": "windows"}}
{"text": "PECmd.exe -d <directory> --csv c:\\temp", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "PECmd CSV Export", "category": "tools", "platform": "windows"}}
{"text": "PECmd key data: Execution timestamps, total number of executions, and files/directories referenced", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "PECmd Key Data", "category": "tools", "platform": "windows"}}
{"text": "To display higher precision timestamps in PECmd, use the --mp switch. When --mp is used, the higher precision timestamps will be reflected in any exported data as well.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "PECmd High Precision Timestamps", "category": "tools", "platform": "windows"}}
{"text": "Jump lists with JLECmd - Type of artifact: Document creation and opening", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd Artifact Type", "category": "tools", "platform": "windows"}}
{"text": "JLECmd.exe -f <file>", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd Single File Usage", "category": "tools", "platform": "windows"}}
{"text": "JLECmd.exe -d <directory>", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd Directory Usage", "category": "tools", "platform": "windows"}}
{"text": "JLECmd key data: Same as LECmd key data plus Application ID and DestList entry information (for automaticDestinations jump lists)", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd Key Data", "category": "tools", "platform": "windows"}}
{"text": "The --ld and --fd switch can be used to display more information about each embedded lnk file in JLECmd.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd Lnk Details Switches", "category": "tools", "platform": "windows"}}
{"text": "Use the --appIDs switch to supply a list of application IDs that will be added to the internal list of over 375 appIDs in JLECmd.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd Application IDs", "category": "tools", "platform": "windows"}}
{"text": "In some cases, an automaticDestinations jump list can contain additional lnk files tracked in its Directory that are not accounted for in DestList entries. When this happens, a warning will be given and the --withDir switch can be used to process all available lnk files regardless of them being present in the DestList.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd withDir Switch", "category": "tools", "platform": "windows"}}
{"text": "JLECmd also allows for exporting out all available lnk files from a jump list to a directory via the --dumpTo switch. Once lnk files have been dumped from a jump list, they can be investigated using any parser that understands lnk files (LECmd for example).", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "JLECmd Dump Lnk Files", "category": "tools", "platform": "windows"}}
{"text": "String searching with bstrings - Type of artifact: Any", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Artifact Type", "category": "tools", "platform": "windows"}}
{"text": "bstrings -f <file>", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Basic Usage", "category": "tools", "platform": "windows"}}
{"text": "To search for specific strings in bstrings, use --ls: bstrings -f <file> --ls \"forensics\"", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings String Search", "category": "tools", "platform": "windows"}}
{"text": "Use the -x and -m switches to set maximum and minimum string lengths in bstrings", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings String Length Limits", "category": "tools", "platform": "windows"}}
{"text": "Use --off to show the offset for each search hit in bstrings", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Offset Display", "category": "tools", "platform": "windows"}}
{"text": "In addition to Unicode strings, bstrings looks for strings encoded using Western (1252) code page. Use the --cp switch to search in any other code page supported by .net. A full listing of available code pages is available at https://goo.gl/ig6DxW", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Code Page Support", "category": "tools", "platform": "windows"}}
{"text": "bstrings also supports regular expression searches via the --lr switch. bstrings also contains over a dozen built in regular expression patterns for things like credit card numbers, social security numbers, IP addresses, email addresses, and more.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Regex Support", "category": "tools", "platform": "windows"}}
{"text": "To see a list of all built-in regular expressions in bstrings, use the -p switch. When using a built-in expression, use the value in the Name column.", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Built-in Regex List", "category": "tools", "platform": "windows"}}
{"text": "bstrings -f <some file> --lr email - Example to look for email addresses using built-in regex", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Email Regex Example", "category": "tools", "platform": "windows"}}
{"text": "bstrings also allows searching for several strings or regular expressions at once using the --fr and --fs switches", "metadata": {"source": "SANS_Zimmerman_Tools", "title": "bstrings Multiple Search", "category": "tools", "platform": "windows"}}
