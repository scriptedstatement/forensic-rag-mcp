{"text": "Apple Mail - com.apple.mail/com.apple.mobilemail: This is a default email application that can be configured to use a number of email clients.", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail Description", "category": "dfir", "platform": "macos"}}
{"text": "Apple Mail macOS Location: Mailboxes: ~/Library/Mail/V#/<UUID>/*.mbox, Mailbox organization: ~/Library/Mail/V#/<UUID>/.mboxCache.plist, Envelope Index: ~/Library/Mail/V#/MailData/Envelope Index", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Apple Mail Downloaded email attachments may be stored in: ~/Library/Containers/com.apple.mail/Data/Library/MailDownloads/, ~/Downloads/, Extended Attributes (find using ls -l@)", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail Attachments Location", "category": "dfir", "platform": "macos"}}
{"text": "Apple Mail iOS Location: /private/var/mobile/Containers/Data/Application/<UUID>/, /private/var/mobile/Library/Mail/, Envelope Index: /private/var/mobile/Library/Mail/Envelope Index", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Apple Mail Interpretation: The UUID folders can be correlated with the Account4.sqlite database. Mailboxes can contain nested mailboxes, messages and attachments.", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail Interpretation", "category": "dfir", "platform": "macos"}}
{"text": "Apple Mail: Messages (macOS) or MessageData (iOS) folder contains raw EMLX email messages with an appended plist containing message metadata.", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail Messages Folder", "category": "dfir", "platform": "macos"}}
{"text": "Apple Mail: Attachments (macOS) or AttachmentData (iOS) folder contains message file attachments.", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail Attachments Folder", "category": "dfir", "platform": "macos"}}
{"text": "Apple Mail: Envelope Index sqlite database contains indexed mail data. It includes flags to show whether the email has been read, flagged, or deleted. Database timestamps are in Unix Epoch format.", "metadata": {"source": "SANS_FOR518", "title": "Apple Mail Envelope Index", "category": "dfir", "platform": "macos"}}
{"text": "Wallet and Apple Pay: The Wallet application keeps track of tickets, cards, and passes. The user can add a credit card to the Apple Pay portion of the application to use for purchases.", "metadata": {"source": "SANS_FOR518", "title": "Wallet and Apple Pay Description", "category": "dfir", "platform": "macos"}}
{"text": "Wallet macOS Location: ~/Library/Passes/*, iCloud synced data: ~/Library/Mobile Documents/com~apple~shoebox/UbiquitousCards/*.pkpass", "metadata": {"source": "SANS_FOR518", "title": "Wallet macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Wallet iOS Location: /private/var/mobile/Library/Passes/*, iCloud synced data: /private/var/mobile/Library/Mobile Documents/com~apple~shoebox/UbiquitousCards/*.pkpass", "metadata": {"source": "SANS_FOR518", "title": "Wallet iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "passes23.sqlite Interpretation: Database timestamps are in Unix Epoch format. UNIQUE_ID will match the .pkpass filename. GROUP_ORDER shows the order of passes as shown to the user, with 0 at the top.", "metadata": {"source": "SANS_FOR518", "title": "Wallet passes23.sqlite", "category": "dfir", "platform": "macos"}}
{"text": "Wallet: Not all transactions may be saved in this database. Only Apple Card transactions are synced across devices. Transactions specific to Apple Cash are called 'peer payments' and may have more related information.", "metadata": {"source": "SANS_FOR518", "title": "Wallet Transactions", "category": "dfir", "platform": "macos"}}
{"text": "Wallet: Journeys using a stored transit card are recorded, including start and end stations.", "metadata": {"source": "SANS_FOR518", "title": "Wallet Transit Records", "category": "dfir", "platform": "macos"}}
{"text": "Wallet .pkpass files: Each card is a .pkpass package format directory. pass.json stores the actual pass or card data.", "metadata": {"source": "SANS_FOR518", "title": "Wallet pkpass Files", "category": "dfir", "platform": "macos"}}
{"text": "Photos - com.apple.Photos: Photos is the native photo gallery application, including photos and videos taken using the camera, screenshots, and synced media files.", "metadata": {"source": "SANS_FOR518", "title": "Photos Description", "category": "dfir", "platform": "macos"}}
{"text": "Photos macOS Location: ~/Pictures/Photos Library.photoslibrary/*", "metadata": {"source": "SANS_FOR518", "title": "Photos macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Photos iOS Location: /private/var/mobile/Media/PhotoData/*, /private/var/mobile/Media/DCIM/*, /private/var/mobile/Media/PhotoStreamsData/*, /private/var/mobile/Media/PhotoCloudSharingData/*", "metadata": {"source": "SANS_FOR518", "title": "Photos iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Photos: Photos Library.photoslibrary on macOS is a package format directory.", "metadata": {"source": "SANS_FOR518", "title": "Photos Library Format", "category": "dfir", "platform": "macos"}}
{"text": "Photos: Extended attributes show a file was synced from iCloud if com.apple.quarantine contains cloudphotosd.", "metadata": {"source": "SANS_FOR518", "title": "Photos iCloud Sync Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "Photos: Photos application adds the com.apple.assetsd.* extended attribute. This includes the original filename, location, timezone, flags for 'hidden' and 'favorite,' and quarantine information.", "metadata": {"source": "SANS_FOR518", "title": "Photos Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "Photos: Photos taken with iOS 11+ use High Efficiency Image Container (HEIC) format.", "metadata": {"source": "SANS_FOR518", "title": "Photos HEIC Format", "category": "dfir", "platform": "ios"}}
{"text": "Photos: Photos.sqlite database includes metadata for each media file. It includes extracted EXIF embedded metadata, annotations, location information, and detected faces and objects.", "metadata": {"source": "SANS_FOR518", "title": "Photos.sqlite Database", "category": "dfir", "platform": "macos"}}
{"text": "Photos: Each subfolder of DCIM can contain up to 999 files, which are sequentially named from IMG_0001.", "metadata": {"source": "SANS_FOR518", "title": "Photos DCIM Structure", "category": "dfir", "platform": "ios"}}
{"text": "Photos: Other photos may be stored by third-party applications - use TCC.db to find those with Camera permissions.", "metadata": {"source": "SANS_FOR518", "title": "Photos Third Party Apps", "category": "dfir", "platform": "macos"}}
{"text": "Reminders - com.apple.reminders: Reminders are user-created lists that can consist of tasks to be completed, or those already marked as done.", "metadata": {"source": "SANS_FOR518", "title": "Reminders Description", "category": "dfir", "platform": "macos"}}
{"text": "Reminders macOS Location: ~/Library/Reminders/Container_v1/Stores/*", "metadata": {"source": "SANS_FOR518", "title": "Reminders macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Reminders iOS Location: /private/var/mobile/Library/Reminders/Container_v1/Stores/*", "metadata": {"source": "SANS_FOR518", "title": "Reminders iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Reminders Interpretation: Each sqlite database contains reminders from a certain source (e.g., local, iCloud). Every object in the database has a different Z_ENT value, which changes for different versions of the database. OBJECT_TYPE shows which type each Z_ENT refers to.", "metadata": {"source": "SANS_FOR518", "title": "Reminders Interpretation", "category": "dfir", "platform": "macos"}}
{"text": "Calendar - com.apple.iCal/com.apple.mobilecal: This is the native calendar application on macOS and iOS with which items can be synced from a variety of accounts. It can include both personal and shared calendars.", "metadata": {"source": "SANS_FOR518", "title": "Calendar Description", "category": "dfir", "platform": "macos"}}
{"text": "Calendar macOS Location: ~/Library/Calendars/*", "metadata": {"source": "SANS_FOR518", "title": "Calendar macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Calendar iOS Location: /private/var/mobile/Library/Calendar/*", "metadata": {"source": "SANS_FOR518", "title": "Calendar iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Calendar Interpretation: Each calendar directory contains an Events folder, which contains ICS calendar files and an Info.plist file. CalDAV Info.plist and ICS files may contain more information than those within the calendar directory.", "metadata": {"source": "SANS_FOR518", "title": "Calendar Directory Structure", "category": "dfir", "platform": "macos"}}
{"text": "Calendar: Calendar.sqlitedb contains calendar information. Table names have changed over time. It includes locations, shared events, notes, contacts, and more. Database timestamps are in Unix Epoch format in local time.", "metadata": {"source": "SANS_FOR518", "title": "Calendar.sqlitedb", "category": "dfir", "platform": "macos"}}
{"text": "Messages - SMS and iMessage: This is a native instant messaging application, which can be used with various different protocols.", "metadata": {"source": "SANS_FOR518", "title": "Messages Description", "category": "dfir", "platform": "macos"}}
{"text": "Messages macOS Location: ~/Library/Messages/chat.db, ~/Library/Messages/Attachments/*", "metadata": {"source": "SANS_FOR518", "title": "Messages macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Messages iOS Location: /private/var/mobile/Library/SMS/sms.db, /private/var/mobile/Library/SMS/Attachments/*", "metadata": {"source": "SANS_FOR518", "title": "Messages iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Messages: SMS can only be used on iOS. Databases are sqlite and include messages and metadata. Timestamps are in Mac Epoch format.", "metadata": {"source": "SANS_FOR518", "title": "Messages SMS iOS Only", "category": "dfir", "platform": "ios"}}
{"text": "Messages: Apple Pay transactions are recorded in the attributedBody (BLOB) and payload_data fields (embedded binary plist).", "metadata": {"source": "SANS_FOR518", "title": "Messages Apple Pay", "category": "dfir", "platform": "macos"}}
{"text": "Messages: filename field shows the path to an attachment. mime_type shows the type of attachment. transfer_name contains the attachment's filename.", "metadata": {"source": "SANS_FOR518", "title": "Messages Attachment Fields", "category": "dfir", "platform": "macos"}}
{"text": "Messages: Users can edit messages within 15 minutes, these edits are kept in the database.", "metadata": {"source": "SANS_FOR518", "title": "Messages Edit History", "category": "dfir", "platform": "macos"}}
{"text": "Notes - com.apple.notes/com.apple.mobilenotes: Notes of various types can be created on macOS, iOS, and on iCloud.com. These can be local device notes, or synced to all devices associated with the same iCloud account.", "metadata": {"source": "SANS_FOR518", "title": "Notes Description", "category": "dfir", "platform": "macos"}}
{"text": "Notes macOS Location: ~/Library/Group Containers/group.com.apple.notes/*", "metadata": {"source": "SANS_FOR518", "title": "Notes macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Notes iOS FFS Location: /private/var/mobile/Containers/Shared/AppGroup/<UUID>/*", "metadata": {"source": "SANS_FOR518", "title": "Notes iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Notes: Even with syncing enabled, the user can choose to create local notes that are not synced.", "metadata": {"source": "SANS_FOR518", "title": "Notes Local vs Synced", "category": "dfir", "platform": "macos"}}
{"text": "Notes: Note attachments are stored in the Media folder. Note thumbnails are stored in the Preview folder.", "metadata": {"source": "SANS_FOR518", "title": "Notes Attachments and Thumbnails", "category": "dfir", "platform": "macos"}}
{"text": "Notes NoteStore.sqlite: Z_ENT is an object type field. Different values for this field may have different meanings in different versions of the database.", "metadata": {"source": "SANS_FOR518", "title": "Notes Z_ENT Field", "category": "dfir", "platform": "macos"}}
{"text": "Notes NoteStore.sqlite: ZFILENAME provides the attachment filename, as stored in the Media folder. ZISPASSWORDPROTECTED = 0 (not encrypted), 1 (encrypted note).", "metadata": {"source": "SANS_FOR518", "title": "Notes Database Fields", "category": "dfir", "platform": "macos"}}
{"text": "Notes NoteStore.sqlite: ZTITLE1 provides the note title. ZDATA stores the note body as a BLOB, which is a protobuf in a GZIP archive.", "metadata": {"source": "SANS_FOR518", "title": "Notes Content Storage", "category": "dfir", "platform": "macos"}}
{"text": "Notes NoteStore.sqlite: ZMARKEDFORDELETION shows whether the note will be cleaned up at some point.", "metadata": {"source": "SANS_FOR518", "title": "Notes Deletion Flag", "category": "dfir", "platform": "macos"}}
{"text": "Contacts - com.apple.AddressBook: The Contacts application (or Address Book) holds user contact information and can be populated by the user or by other applications.", "metadata": {"source": "SANS_FOR518", "title": "Contacts Description", "category": "dfir", "platform": "macos"}}
{"text": "Contacts macOS Location: ~/Library/Application Support/AddressBook/*", "metadata": {"source": "SANS_FOR518", "title": "Contacts macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Contacts iOS Location: /private/var/mobile/Library/AddressBook/*", "metadata": {"source": "SANS_FOR518", "title": "Contacts iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Contacts: Each source under the Sources folder could have its own associated database file and Metadata folder. Metadata directories contain a binary plist file for each person (ending with p), subscription (s), or group (g).", "metadata": {"source": "SANS_FOR518", "title": "Contacts Sources Structure", "category": "dfir", "platform": "macos"}}
{"text": "Contacts: Rename Metadata files to .plist in order to open with XCode. When searching for a person of interest, search for their UID, not just their name. Database timestamps are in Unix Epoch format in local time.", "metadata": {"source": "SANS_FOR518", "title": "Contacts Analysis Tips", "category": "dfir", "platform": "macos"}}
{"text": "Contacts FindMy: The FindMy application allows people to share their location with others. If a user has any followers or contacts on FindMy, their metadata is stored in a JSON file.", "metadata": {"source": "SANS_FOR518", "title": "Contacts FindMy Description", "category": "dfir", "platform": "ios"}}
{"text": "Contacts FindMy Location: /private/var/mobile/Library/Caches/com.apple.findmy.fmfcore/FriendCacheData.data", "metadata": {"source": "SANS_FOR518", "title": "Contacts FindMy Location", "category": "dfir", "platform": "ios"}}
{"text": "Call History - Phone and FaceTime: Phone and FaceTime are the native calling applications on macOS and iOS.", "metadata": {"source": "SANS_FOR518", "title": "Call History Description", "category": "dfir", "platform": "macos"}}
{"text": "Call History macOS Location: ~/Library/Application Support/CallHistoryDB/CallHistory.storedata", "metadata": {"source": "SANS_FOR518", "title": "Call History macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Call History iOS Location: /private/var/mobile/Library/CallHistoryDB/CallHistory.storedata", "metadata": {"source": "SANS_FOR518", "title": "Call History iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Call History: Phone reverse DNS name is com.apple.mobilephone. FaceTime reverse DNS name is com.apple.facetime.", "metadata": {"source": "SANS_FOR518", "title": "Call History Bundle IDs", "category": "dfir", "platform": "macos"}}
{"text": "Call History: Database is in sqlite format and includes calls made/received and metadata. ZDATE timestamps are in Mac Epoch format in local time.", "metadata": {"source": "SANS_FOR518", "title": "Call History Database Format", "category": "dfir", "platform": "macos"}}
{"text": "Call History Fields: ZADDRESS = phone number or email address. ZANSWERED = 0 (No), 1 (Yes). ZCALLTYPE = 1 (telephony), 8 (FaceTime), 16 (FaceTime voice).", "metadata": {"source": "SANS_FOR518", "title": "Call History Fields Part 1", "category": "dfir", "platform": "macos"}}
{"text": "Call History Fields: ZORIGINATED = 0 (incoming), 1 (outgoing with this user). ZDURATION = time in seconds for this call. ZSERVICE_PROVIDER = application used for the call.", "metadata": {"source": "SANS_FOR518", "title": "Call History Fields Part 2", "category": "dfir", "platform": "macos"}}
{"text": "Call History: macOS database may store contact information in an encrypted BLOB. Some data may be synced across devices.", "metadata": {"source": "SANS_FOR518", "title": "Call History Sync", "category": "dfir", "platform": "macos"}}
{"text": "iOS Visual Voicemail: Some, but not all, cellular carriers provide visual voicemail functionality on iOS devices, where voicemail audio files are downloaded to the device.", "metadata": {"source": "SANS_FOR518", "title": "Visual Voicemail Description", "category": "dfir", "platform": "ios"}}
{"text": "Visual Voicemail Location: /private/var/mobile/Library/Voicemail/*", "metadata": {"source": "SANS_FOR518", "title": "Visual Voicemail Location", "category": "dfir", "platform": "ios"}}
{"text": "Visual Voicemail: Each voicemail audio file (AMR file) has the ROWID from the voicemail.db sqlite database as a filename.", "metadata": {"source": "SANS_FOR518", "title": "Visual Voicemail Files", "category": "dfir", "platform": "ios"}}
{"text": "Visual Voicemail: If a voicemail has an accompanying transcript, this will be stored as an NSKeyedArchiver plist *.transcript file. Database timestamps are in Unix Epoch format in local time.", "metadata": {"source": "SANS_FOR518", "title": "Visual Voicemail Transcripts", "category": "dfir", "platform": "ios"}}
{"text": "Maps - com.apple.Maps: This is the native mapping application on macOS and iOS. Map data can be synced between devices using iCloud.", "metadata": {"source": "SANS_FOR518", "title": "Maps Description", "category": "dfir", "platform": "macos"}}
{"text": "Maps macOS Location: ~/Library/Containers/com.apple.Maps/MapsSync_0.0.1", "metadata": {"source": "SANS_FOR518", "title": "Maps macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Maps iOS Location: /private/var/mobile/Containers/Shared/AppGroup/CCB7770F-CF85-4292-8389-66232373192D/Maps/MapsSync_0.0.1", "metadata": {"source": "SANS_FOR518", "title": "Maps iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Maps: iOS backup folder for Maps may be empty.", "metadata": {"source": "SANS_FOR518", "title": "Maps Backup Note", "category": "dfir", "platform": "ios"}}
{"text": "Maps MapsSync_0.0.1: ZFAVORITEITEM table contains the user's favorite locations. ZTYPE = 2 (custom location). ZHISTORYITEM table shows user searches and queries (ZQUERY).", "metadata": {"source": "SANS_FOR518", "title": "Maps Database Tables", "category": "dfir", "platform": "macos"}}
{"text": "Maps MapsSync_0.0.1: MIXINMAPITEM table links together the history and favorite items. ZMAPITEMSTORAGE stores location data as an embedded protobuf.", "metadata": {"source": "SANS_FOR518", "title": "Maps Database Storage", "category": "dfir", "platform": "macos"}}
{"text": "iOS Health: Health information about the user is stored in a database, if enabled. This can include steps, distance, and heart rate, which can be collected using the Apple Watch.", "metadata": {"source": "SANS_FOR518", "title": "Health Description", "category": "dfir", "platform": "ios"}}
{"text": "Health Location: /private/var/mobile/Library/Health/healthdb_secure.sqlite", "metadata": {"source": "SANS_FOR518", "title": "Health Location", "category": "dfir", "platform": "ios"}}
{"text": "Health: Database is encrypted in iOS backups, but not in a Full Filesystem dump. Use APOLLO health_* modules to extract a user's health data.", "metadata": {"source": "SANS_FOR518", "title": "Health Database Encryption", "category": "dfir", "platform": "ios"}}
{"text": "Contact Interactions - InteractionC.db: This database keeps track of who the user is communicating with using applications such as Messages, Mail, and Phone.", "metadata": {"source": "SANS_FOR518", "title": "InteractionC.db Description", "category": "dfir", "platform": "macos"}}
{"text": "InteractionC.db macOS Location: /private/var/db/CoreDuet/People/interactionC.db", "metadata": {"source": "SANS_FOR518", "title": "InteractionC.db macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "InteractionC.db iOS Location: /private/var/mobile/Library/CoreDuet/People/interactionC.db", "metadata": {"source": "SANS_FOR518", "title": "InteractionC.db iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "InteractionC.db: Data stored in this database includes the direction of communication (INCOMING or OUTGOING), start and end Mac Epoch timestamps, the application bundle id, contact information, and sender and recipient information.", "metadata": {"source": "SANS_FOR518", "title": "InteractionC.db Contents", "category": "dfir", "platform": "macos"}}
{"text": "iOS CarPlay: Some information about vehicles the iOS device has been paired with are stored in plist files.", "metadata": {"source": "SANS_FOR518", "title": "CarPlay Description", "category": "dfir", "platform": "ios"}}
{"text": "CarPlay Location: /private/var/mobile/Library/SpringBoard/<UUID>-CarDisplayIconState.plist, /private/var/mobile/Library/Preferences/[com.apple.CarPlayApp|com.apple.carplay].plist", "metadata": {"source": "SANS_FOR518", "title": "CarPlay Location", "category": "dfir", "platform": "ios"}}
{"text": "CarPlay: <UUID>-CarDisplayIconState.plist shows the organization of icons on connected vehicle screens. The connected vehicle description is stored under the metadata key.", "metadata": {"source": "SANS_FOR518", "title": "CarPlay IconState", "category": "dfir", "platform": "ios"}}
{"text": "CarPlay: com.apple.carplay.plist shows the most current Icon State UUID and paired vehicle type. com.apple.CarPlayApp.plist shows recent apps under CARRecentAppHistory.", "metadata": {"source": "SANS_FOR518", "title": "CarPlay Preferences", "category": "dfir", "platform": "ios"}}
{"text": "Lockdown Files: Connecting an iOS device to another system generates a lockdown file when the user selects 'Trust This Computer'.", "metadata": {"source": "SANS_FOR518", "title": "Lockdown Files Description", "category": "dfir", "platform": "macos"}}
{"text": "Lockdown Files macOS Location: /private/var/db/lockdown/", "metadata": {"source": "SANS_FOR518", "title": "Lockdown Files macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Lockdown Files Windows Location: C:\\ProgramData\\Apple\\Lockdown\\", "metadata": {"source": "SANS_FOR518", "title": "Lockdown Files Windows Location", "category": "dfir", "platform": "windows"}}
{"text": "Lockdown Files: <iDevice UDID>.plist files are created for each iDevice paired with the system. Contains certificates, keybags, and other info used to access a locked device.", "metadata": {"source": "SANS_FOR518", "title": "Lockdown Files Contents", "category": "dfir", "platform": "macos"}}
{"text": "Lockdown Files: Device PIN/passcode is required for pairing record creation. Lockdown records expire after 30 days of no use.", "metadata": {"source": "SANS_FOR518", "title": "Lockdown Files Expiration", "category": "dfir", "platform": "macos"}}
{"text": "Time Machine Backups: Time Machine is the native backup utility on macOS, which may or may not be enabled.", "metadata": {"source": "SANS_FOR518", "title": "Time Machine Description", "category": "dfir", "platform": "macos"}}
{"text": "Time Machine Settings Location: /Library/Preferences/com.apple.TimeMachine.plist - BackupAlias contains details about any backup disks. SnapshotDates provide timestamps associated with backups.", "metadata": {"source": "SANS_FOR518", "title": "Time Machine Settings", "category": "dfir", "platform": "macos"}}
{"text": "Time Machine: Settings include filesystem type, encryption status, and backup frequency.", "metadata": {"source": "SANS_FOR518", "title": "Time Machine Settings Details", "category": "dfir", "platform": "macos"}}
{"text": "Time Machine Logs: Unified logs - Use log show --info --predicate 'process = \"backupd\"' to show backup info.", "metadata": {"source": "SANS_FOR518", "title": "Time Machine Logs", "category": "dfir", "platform": "macos"}}
{"text": "Time Machine: Unified logs show when the backup started and finished, network or local location of backup, volume name backed up, amount of data backed up, and deletion of old backups.", "metadata": {"source": "SANS_FOR518", "title": "Time Machine Log Contents", "category": "dfir", "platform": "macos"}}
{"text": "iOS Backups: iOS devices can be backed up to iCloud or to a local macOS or Windows system, either automatically or manually. Backups can be encrypted if the user chooses to enable this feature and set a backup password.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Description", "category": "dfir", "platform": "ios"}}
{"text": "iOS Backups macOS Location: ~/Library/Application Support/MobileSync/Backup/", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "iOS Backups Windows XP Location: C:\\Documents and Settings\\<user>\\Application Data\\Apple Computer\\MobileSync\\Backup\\", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Windows XP Location", "category": "dfir", "platform": "windows"}}
{"text": "iOS Backups Windows Vista+ Location: C:\\Users\\<user>\\AppData\\Roaming\\Apple Computer\\MobileSync\\Backup\\", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Windows Vista Location", "category": "dfir", "platform": "windows"}}
{"text": "iOS Backups Microsoft Store iTunes on Windows Location: C:\\Users\\<user>\\Apple\\MobileSync\\Backup\\", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups MS Store iTunes Location", "category": "dfir", "platform": "windows"}}
{"text": "iOS Backups: Each subfolder is named for the device's UDID. A11-: 40-character UDID, A12+: [8 digits]-[16 digits] UDID.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups UDID Format", "category": "dfir", "platform": "ios"}}
{"text": "iOS Backups: Folders named <UDID>-<timestamp> may also exist, which are created during a restore/update of the iDevice.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Restore Folders", "category": "dfir", "platform": "ios"}}
{"text": "iOS Backups Status.plist: includes timestamps of the backup, type, and whether a full backup was performed.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Status.plist", "category": "dfir", "platform": "ios"}}
{"text": "iOS Backups Info.plist: contains device name, serial number, ICCID, MEID, IMEI, UDID, phone number, make, model, iOS and build information, the last backup date, and installed applications.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Info.plist", "category": "dfir", "platform": "ios"}}
{"text": "iOS Backups Manifest.plist: contains the backup date, whether the backup is encrypted, whether a device passcode was set, and the lockdown key, including device info, serial number, and UDID.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Manifest.plist", "category": "dfir", "platform": "ios"}}
{"text": "iOS Backups: iOS 10+: Manifest.db contains metadata about backup files. Previous versions of iOS stored this same data in Manifest.mbdb.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Manifest.db", "category": "dfir", "platform": "ios"}}
{"text": "iOS Backups: A backup needs to be normalized by mapping files back to their original names. This may be shown differently by various tools.", "metadata": {"source": "SANS_FOR518", "title": "iOS Backups Normalization", "category": "dfir", "platform": "ios"}}
{"text": "Attached iDevices - com.apple.iPod.plist: All iDevices that have been attached to the system while logged in as that user are recorded in a plist file.", "metadata": {"source": "SANS_FOR518", "title": "Attached iDevices Description", "category": "dfir", "platform": "macos"}}
{"text": "Attached iDevices Location: ~/Library/Preferences/com.apple.iPod.plist", "metadata": {"source": "SANS_FOR518", "title": "Attached iDevices Location", "category": "dfir", "platform": "macos"}}
{"text": "Attached iDevices: Devices' key contains one subkey per device, which includes the device type, IMEI, MEID, number of connections, time of last connection, and iOS version when last connected.", "metadata": {"source": "SANS_FOR518", "title": "Attached iDevices Contents", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth Devices: Both macOS and iOS keep lists of Bluetooth devices that have been connected to the system.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth Devices Description", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth macOS Location: /Library/Preferences/com.apple.MobileBluetooth.devices.plist, /Library/Databases/com.apple.MobileBluetooth.ledevices.other.plist, /Library/Preferences/com.apple.MobileBluetooth.ledevices.paired.plist, ~/Library/Application Support/Knowledge/knowledgeC.db", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth iOS Location: /private/var/containers/Shared/SystemGroup/<GUID>/com.apple.MobileBluetooth.devices.plist, /private/var/containers/Shared/SystemGroup/<GUID>/com.apple.MobileBluetooth.ledevices.other.plist, /private/var/containers/Shared/SystemGroup/<GUID>/com.apple.MobileBluetooth.ledevices.paired.plist, /private/var/mobile/Library/CoreDuet/knowledgeC.db", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Bluetooth: Use timestamps carefully - certain user interactions can change how these timestamps may be interpreted. For example, changing the name of a device might update the first connected timestamp.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth Timestamp Warning", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth: UnlockEnabled = yes - an Apple Watch can be used to unlock this macOS device.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth Apple Watch Unlock", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth: com.apple.MobileBluetooth.devices.plist keeps track of connected Bluetooth devices. Timestamps are stored in localtime.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth devices.plist", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth: com.apple.MobileBluetooth.ledevices.other.plist file keeps track of 'seen' Bluetooth low energy devices, that have not necessarily connected to the system. Note that this file will not include all nearby Bluetooth-enabled devices. Some device MAC addresses may be randomized.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth ledevices.other.plist", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth: LastSeen is Unix Epoch timestamp in local system time when this device was last used.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth LastSeen Field", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth: com.apple.MobileBluetooth.ledevices.paired.plist keeps track of paired Bluetooth low-energy devices.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth ledevices.paired.plist", "category": "dfir", "platform": "macos"}}
{"text": "Bluetooth: KnowledgeC.db keeps track of connected Bluetooth devices using the /Bluetooth/isConnected stream. Use APOLLO knowledge_audio_bluetooth_connected module.", "metadata": {"source": "SANS_FOR518", "title": "Bluetooth KnowledgeC.db", "category": "dfir", "platform": "macos"}}
{"text": "FindMy AirTags: The FindMy application tracks information about the user's AirTags.", "metadata": {"source": "SANS_FOR518", "title": "FindMy AirTags Description", "category": "dfir", "platform": "ios"}}
{"text": "FindMy AirTags Location: /private/var/mobile/Library/Caches/com.apple.findmy.fmipcore/Items.data", "metadata": {"source": "SANS_FOR518", "title": "FindMy AirTags Location", "category": "dfir", "platform": "ios"}}
{"text": "FindMy AirTags: Items.data JSON file includes the owner, serial number, last connected timestamp and location information.", "metadata": {"source": "SANS_FOR518", "title": "FindMy AirTags Contents", "category": "dfir", "platform": "ios"}}
{"text": "Network Interfaces: These are the network interfaces on the system, interface types, and MAC addresses.", "metadata": {"source": "SANS_FOR518", "title": "Network Interfaces Description", "category": "dfir", "platform": "macos"}}
{"text": "Network Interfaces macOS Location: /Library/Preferences/SystemConfiguration/NetworkInterfaces.plist, /Library/Preferences/SystemConfiguration/preferences.plist", "metadata": {"source": "SANS_FOR518", "title": "Network Interfaces macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Network Interfaces iOS Location: /private/var/preferences/SystemConfiguration/NetworkInterfaces.plist, /private/var/preferences/SystemConfiguration/preferences.plist", "metadata": {"source": "SANS_FOR518", "title": "Network Interfaces iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Network Interfaces: Each interface has an Item key in NetworkInterfaces.plist. SCNetworkInterfaceType is IEEE802.11 for wireless interfaces, and Ethernet for wired interfaces. IOMacAddress contains the unique MAC address for the interface. It also contains the device model.", "metadata": {"source": "SANS_FOR518", "title": "Network Interfaces Contents", "category": "dfir", "platform": "macos"}}
{"text": "DHCP Settings: Files in this folder contain the last known network settings for those interfaces using DHCP.", "metadata": {"source": "SANS_FOR518", "title": "DHCP Settings Description", "category": "dfir", "platform": "macos"}}
{"text": "DHCP Settings Location: /private/var/db/dhcpclient/leases/", "metadata": {"source": "SANS_FOR518", "title": "DHCP Settings Location", "category": "dfir", "platform": "macos"}}
{"text": "DHCP Settings: Each file within this directory includes lease information, router MAC address, IP address, and SSID, for a specified interface.", "metadata": {"source": "SANS_FOR518", "title": "DHCP Settings Contents", "category": "dfir", "platform": "macos"}}
{"text": "Wireless Network Connections: This lists connections to access points, including wireless settings. It includes access points added using the WiFi menu and those synced from another device.", "metadata": {"source": "SANS_FOR518", "title": "Wireless Connections Description", "category": "dfir", "platform": "macos"}}
{"text": "Wireless Network macOS Location: /Library/Preferences/com.apple.wifi.known-networks.plist", "metadata": {"source": "SANS_FOR518", "title": "Wireless macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Wireless Network iOS Location: /private/var/preferences/com.apple.wifi.known-networks.plist", "metadata": {"source": "SANS_FOR518", "title": "Wireless iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Wireless known-networks.plist: AddReason key shows whether the data has been synced. AddedAt timestamp shows when the access point was added to this plist file.", "metadata": {"source": "SANS_FOR518", "title": "Wireless AddReason and AddedAt", "category": "dfir", "platform": "macos"}}
{"text": "Wireless known-networks.plist: JoinedByUserAt provides the timestamp when the user specifically joined the access point. JoinedBySystemAt provides the timestamp when the system auto-connected to the access point.", "metadata": {"source": "SANS_FOR518", "title": "Wireless Join Timestamps", "category": "dfir", "platform": "macos"}}
{"text": "Wireless known-networks.plist: LocationLatitude and LocationLongitude provide the coordinates of the access point. PersonalHotspot shows whether this device connected via another device's hotspot.", "metadata": {"source": "SANS_FOR518", "title": "Wireless Location and Hotspot", "category": "dfir", "platform": "macos"}}
{"text": "Network Usage Logs: Unified logs and system logs include entries for network connections made on the system.", "metadata": {"source": "SANS_FOR518", "title": "Network Usage Logs Description", "category": "dfir", "platform": "macos"}}
{"text": "Network Logs: Search for sender 'IPConfiguration' and where the log message contains 'Lease' or 'network changed'. Use log show --info --predicate 'senderImagePath contains[cd] \"IPConfiguration\" and (eventMessage contains[cd] \"SSID\" or eventMessage contains[cd] \"Lease\" or eventMessage contains[cd] \"network changed\")'", "metadata": {"source": "SANS_FOR518", "title": "Network Logs IPConfiguration", "category": "dfir", "platform": "macos"}}
{"text": "Network Logs: Search logs for 'configd', 'SSID', or 'en0' for a more detailed view of wireless activity.", "metadata": {"source": "SANS_FOR518", "title": "Network Logs Wireless", "category": "dfir", "platform": "macos"}}
{"text": "Network Logs: Search logs for 'country code' to show the country codes associated with wireless access point connections. Default code is 'X0' when one is not available.", "metadata": {"source": "SANS_FOR518", "title": "Network Logs Country Code", "category": "dfir", "platform": "macos"}}
{"text": "Terminal History - Executed Commands: Each user account stores a list of commands run in a zsh shell terminal within a hidden file in their home folder.", "metadata": {"source": "SANS_FOR518", "title": "Terminal History Description", "category": "dfir", "platform": "macos"}}
{"text": "Terminal History Location: ~/.zsh_history, ~/.zsh_sessions/<GUID>.history", "metadata": {"source": "SANS_FOR518", "title": "Terminal History Location", "category": "dfir", "platform": "macos"}}
{"text": "Terminal History: These are Plaintext files containing up to 1000 commands run in order of execution.", "metadata": {"source": "SANS_FOR518", "title": "Terminal History Format", "category": "dfir", "platform": "macos"}}
{"text": "Terminal History: An upgraded macOS system may also store up to the last 500 commands run in a bash shell, in: ~/bash_history, ~/.bash_sessions/<GUID>.history", "metadata": {"source": "SANS_FOR518", "title": "Terminal History Bash", "category": "dfir", "platform": "macos"}}
{"text": "Terminal History: The files are created the first time the Terminal application is run. History files are not updated until the user account logs out. Session files are updated when the Terminal is exited.", "metadata": {"source": "SANS_FOR518", "title": "Terminal History Update Timing", "category": "dfir", "platform": "macos"}}
{"text": "Terminal History: Files can be viewed on a live system using the history command. <GUID>.history files contain commands executed in that session.", "metadata": {"source": "SANS_FOR518", "title": "Terminal History Session Files", "category": "dfir", "platform": "macos"}}
{"text": "Screen Time: This tracks time spent in applications, notifications, and device pickups by the user following a notification.", "metadata": {"source": "SANS_FOR518", "title": "Screen Time Description", "category": "dfir", "platform": "macos"}}
{"text": "Screen Time macOS Location: /var/folders/<darwin_user_dir>/0/com.apple.ScreenTimeAgent/RMAdminStore-*.sqlite", "metadata": {"source": "SANS_FOR518", "title": "Screen Time macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Screen Time iOS Location: /private/var/mobile/Library/Application Support/com.apple.remotemanagementd/RMAdminStore-*.sqlite", "metadata": {"source": "SANS_FOR518", "title": "Screen Time iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Screen Time: Data is organized by hour and category. Data retention is ~three weeks on iOS, and ~five weeks on macOS. Device name and UUID are shown for synced data.", "metadata": {"source": "SANS_FOR518", "title": "Screen Time Data Retention", "category": "dfir", "platform": "macos"}}
{"text": "Application Usage - KnowledgeC: Amongst other things, the KnowledgeC database tracks application usage, including start and end times, and how the application was launched and used.", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC Description", "category": "dfir", "platform": "macos"}}
{"text": "KnowledgeC macOS Location: ~/Library/Application Support/Knowledge/knowledgeC.db, /private/var/db/CoreDuet/Knowledge/knowledgeC.db", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "KnowledgeC iOS Location: /private/var/mobile/Library/CoreDuet/knowledgeC.db", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "KnowledgeC: It stores approximately four weeks of data.", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC Data Retention", "category": "dfir", "platform": "macos"}}
{"text": "KnowledgeC: /app/usage stream keeps track of applications being used and when. Use APOLLO knowledge_app_usage module.", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC app/usage", "category": "dfir", "platform": "macos"}}
{"text": "KnowledgeC: /app/intents stream keeps track of what is happening in applications. Use APOLLO knowledge_app_intents module.", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC app/intents", "category": "dfir", "platform": "macos"}}
{"text": "KnowledgeC: /app/activity stream keeps track of application activities and interactions. Use APOLLO knowledge_app_activity module.", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC app/activity", "category": "dfir", "platform": "macos"}}
{"text": "KnowledgeC: /device/NowPlaying stream keeps track of what is playing and how it is playing. Use APOLLO knowledge_audio_media_nowplaying module.", "metadata": {"source": "SANS_FOR518", "title": "KnowledgeC NowPlaying", "category": "dfir", "platform": "macos"}}
{"text": "Application Usage - Biomes: Many items that were once stored in knowledgeC.db can now be found in Biome files. This data type is scattered across the filesystem and appears to be where more of this data will be stored in the future.", "metadata": {"source": "SANS_FOR518", "title": "Biomes Description", "category": "dfir", "platform": "macos"}}
{"text": "Biomes macOS Location: ~/Library/Biome, /private/var/db/biome/", "metadata": {"source": "SANS_FOR518", "title": "Biomes macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Biomes iOS Location: /private/var/mobile/Library/Biome, /private/var/db/biome/", "metadata": {"source": "SANS_FOR518", "title": "Biomes iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Biomes: Search for App.InFocus streams in Biome data. Each Biome record contains a protobuf file, which contains start and end times, the app bundle ID, and the transition reason.", "metadata": {"source": "SANS_FOR518", "title": "Biomes App.InFocus", "category": "dfir", "platform": "macos"}}
{"text": "Biomes: Each Biome record is stored in a flat file system, one after another. Biome records have somewhat different formats across devices and/or OS versions.", "metadata": {"source": "SANS_FOR518", "title": "Biomes Format", "category": "dfir", "platform": "macos"}}
{"text": "Biomes: Biome sync.db database keeps track of what devices are syncing across each other.", "metadata": {"source": "SANS_FOR518", "title": "Biomes sync.db", "category": "dfir", "platform": "macos"}}
{"text": "Application Usage - CurrentPowerlog: This shows nearly the same data as knowledgeC.db and Biomes. However, it may include additional data such as CarPlay, home screen, lock screen, and Siri usage.", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog Description", "category": "dfir", "platform": "macos"}}
{"text": "CurrentPowerlog macOS Location: /private/var/db/powerlog/Library/BatteryLife/CurrentPowerlog.PLSQL", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "CurrentPowerlog iOS FFS Location: /private/var/Containers/Shared/SystemGroup/<GUID>/Library/BatteryLife/CurrentPowerlog.PLSQL", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog iOS FFS Location", "category": "dfir", "platform": "ios"}}
{"text": "CurrentPowerlog iOS Sysdiagnose Location: /logs/powerlogs/CurrentPowerlog.PLSQL", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog Sysdiagnose Location", "category": "dfir", "platform": "ios"}}
{"text": "CurrentPowerlog: It stores approximately three days of data. Be wary of timestamps in this log - some, but not all, have an offset.", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog Data Retention", "category": "dfir", "platform": "macos"}}
{"text": "CurrentPowerlog: Use APOLLO powerlog_app_usage module to extract the correct application usage times.", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog app_usage", "category": "dfir", "platform": "macos"}}
{"text": "CurrentPowerlog: Use APOLLO powerlog_incallservice module to extract call logs.", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog incallservice", "category": "dfir", "platform": "macos"}}
{"text": "CurrentPowerlog: Use APOLLO powerlog_camera_state module to extract camera state information.", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog camera_state", "category": "dfir", "platform": "macos"}}
{"text": "CurrentPowerlog: Use APOLLO powerlog_app_frontmost module to show which application is the 'frontmost' app.", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog app_frontmost", "category": "dfir", "platform": "macos"}}
{"text": "CurrentPowerlog: Archived databases may also be present in the Archives directory.", "metadata": {"source": "SANS_FOR518", "title": "CurrentPowerlog Archives", "category": "dfir", "platform": "macos"}}
{"text": "Application Data: This determines application information, including name and version.", "metadata": {"source": "SANS_FOR518", "title": "Application Data Description", "category": "dfir", "platform": "macos"}}
{"text": "Application Data macOS Location: /Applications/<Bundle ID>/*, ~/Library/Containers/.../<Bundle ID>/*, ~/Library/Application Support/<Bundle ID>/*, ~/Library/Preferences/*.plist, ~/Library/Caches/*", "metadata": {"source": "SANS_FOR518", "title": "Application Data macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Sandboxed applications macOS: ~/Library/[Group] Containers/<Bundle ID>/Data/Library/Application Support/<App Name>/, ~/Library/[Group] Containers/<Bundle ID>/Data/Library/Preferences - <TLD>.<Company>.<Application>.plist file contains the user's preferences, ~/Library/Caches", "metadata": {"source": "SANS_FOR518", "title": "Sandboxed App macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Non-sandboxed applications (legacy) macOS: ~/Library/Application Support, ~/Library/Preferences - <TLD>.<Company>.<Application>.plist file contains the user's preferences, ~/Library/Caches", "metadata": {"source": "SANS_FOR518", "title": "Non-Sandboxed App macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Application Data iOS FFS Location: /private/var/mobile/Containers/.../<Bundle ID>/*, /private/var/mobile/Containers/Bundle/Application/<GUID>/* - Contains application binary file, /private/var/mobile/Containers/Data/Application/<GUID>/*, /private/var/mobile/Containers/Shared/AppGroup/<GUID>/* - Data shared among apps with the same developer", "metadata": {"source": "SANS_FOR518", "title": "Application Data iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Application Data iOS: /private/var/mobile/Library/Cache/<Bundle ID>/*, /private/var/mobile/Preferences/*.plist", "metadata": {"source": "SANS_FOR518", "title": "Application Data iOS Cache", "category": "dfir", "platform": "ios"}}
{"text": "Application Data: Each container is named in reverse DNS format. Each container directory contains a .com.apple.containermanagerd.metadata.plist file with application information.", "metadata": {"source": "SANS_FOR518", "title": "Application Container Format", "category": "dfir", "platform": "macos"}}
{"text": "Application Data: Each container directory contains a Data directory. The most interesting subdirectories are likely those that are not links.", "metadata": {"source": "SANS_FOR518", "title": "Application Data Directory", "category": "dfir", "platform": "macos"}}
{"text": "Application Data: Info.plist file contains app name, bundle ID, and version information. Similar information for iOS apps is stored in iTunesMetadata.plist, including the purchase date and user information.", "metadata": {"source": "SANS_FOR518", "title": "Application Info.plist", "category": "dfir", "platform": "macos"}}
{"text": "Application Data: Cached items rarely get backed up, so typically won't be found in an iOS backup.", "metadata": {"source": "SANS_FOR518", "title": "Application Cache Backup", "category": "dfir", "platform": "ios"}}
{"text": "Keyboard Dictionary: When a user types words into the device's keyboard, certain words are recorded in user dictionary files to help with autocorrection and predictive text features.", "metadata": {"source": "SANS_FOR518", "title": "Keyboard Dictionary Description", "category": "dfir", "platform": "macos"}}
{"text": "Keyboard Dictionary: These files should not contain anything typed into sensitive fields such as passwords, although may include sensitive data the user may have typed into non-secure areas such as notes. These files may or may not be included in iOS backups.", "metadata": {"source": "SANS_FOR518", "title": "Keyboard Dictionary Contents", "category": "dfir", "platform": "macos"}}
{"text": "Keyboard Dictionary macOS Location: ~/Library/Spelling/*dynamic-*.dat", "metadata": {"source": "SANS_FOR518", "title": "Keyboard Dictionary macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Keyboard Dictionary iOS Location: /private/var/mobile/Library/Keyboard/*dynamic-*.dat", "metadata": {"source": "SANS_FOR518", "title": "Keyboard Dictionary iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Keyboard Dictionary: English dictionaries are dynamic-*.dat. Other languages have their own files and will be preceded by their language abbreviation (e.g., ar for Arabic).", "metadata": {"source": "SANS_FOR518", "title": "Keyboard Dictionary Languages", "category": "dfir", "platform": "macos"}}
{"text": "iOS Application Snapshots: When an application is minimized to the background, a screenshot of the current screen is saved to the filesystem, to be used as a preview.", "metadata": {"source": "SANS_FOR518", "title": "Application Snapshots Description", "category": "dfir", "platform": "ios"}}
{"text": "Application Snapshots: App developers can choose to replace the screenshot with another image. This is commonly done for security reasons, such as in banking applications.", "metadata": {"source": "SANS_FOR518", "title": "Application Snapshots Security", "category": "dfir", "platform": "ios"}}
{"text": "Application Snapshots Location: <Application directory>/Library/Splashboard/Snapshots/<Bundle ID>/*", "metadata": {"source": "SANS_FOR518", "title": "Application Snapshots Location", "category": "dfir", "platform": "ios"}}
{"text": "Application Snapshots: Snapshots are PNG files. They are usually only available on FFS acquisitions. Previous versions of iOS generated snapshots as KTX files.", "metadata": {"source": "SANS_FOR518", "title": "Application Snapshots Format", "category": "dfir", "platform": "ios"}}
{"text": "Autorun Applications: Autorun applications are those that automatically run when a user logs in.", "metadata": {"source": "SANS_FOR518", "title": "Autorun Applications Description", "category": "dfir", "platform": "macos"}}
{"text": "Autorun macOS Location: /System/Library/LaunchAgents/*.plist, /Library/LaunchAgents/*.plist, ~/Library/LaunchAgents/*.plist, /System/Library/LaunchDaemons/, /Library/LaunchDaemons/", "metadata": {"source": "SANS_FOR518", "title": "Autorun macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Autorun macOS 14 Location: /private/var/db/com.apple.backgroundtaskmanagement/BackgroundItems-v9.btm", "metadata": {"source": "SANS_FOR518", "title": "Autorun macOS 14 Location", "category": "dfir", "platform": "macos"}}
{"text": "Autorun macOS 13 Location: ~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm", "metadata": {"source": "SANS_FOR518", "title": "Autorun macOS 13 Location", "category": "dfir", "platform": "macos"}}
{"text": "Autorun iOS Location: /Library/LaunchAgents/*.plist, /System/Library/LaunchDaemons/, /System/Library/NanoLaunchDaemons/, /Library/LaunchDaemons/ - Requires jailbroken device to acquire", "metadata": {"source": "SANS_FOR518", "title": "Autorun iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Autorun: Login items can be hidden from view of the user. Launch Daemons are background system processes. Launch Agents are background user processes.", "metadata": {"source": "SANS_FOR518", "title": "Autorun Launch Types", "category": "dfir", "platform": "macos"}}
{"text": "Autorun: plist files are named in reverse DNS format. BackgroundItems-v9.btm / backgrounditems.btm is an NSKeyedArchiver plist file.", "metadata": {"source": "SANS_FOR518", "title": "Autorun File Format", "category": "dfir", "platform": "macos"}}
{"text": "Saved Application State: Application State information is stored, to allow it to be returned to its previous state after a reboot, if the user selects 'reopen windows when logging back in' on shutdown.", "metadata": {"source": "SANS_FOR518", "title": "Saved Application State Description", "category": "dfir", "platform": "macos"}}
{"text": "Saved Application State macOS legacy apps: ~/Library/Saved Application State/<bundle_id>.savedState/", "metadata": {"source": "SANS_FOR518", "title": "Saved State macOS Legacy Location", "category": "dfir", "platform": "macos"}}
{"text": "Saved Application State macOS sandboxed apps: ~/Library/Containers/<Bundle ID>/Data/Library/Application Support/<App Name>/Saved Application State/<bundle_id>.savedState/", "metadata": {"source": "SANS_FOR518", "title": "Saved State macOS Sandboxed Location", "category": "dfir", "platform": "macos"}}
{"text": "Saved Application State iOS: <Application directory>/Library/Saved Application State/<bundle_id>.savedState/", "metadata": {"source": "SANS_FOR518", "title": "Saved State iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Saved Application State: The existence of these directories indicates the user has used these applications. Each *.savedState directory contains at least two files: [macOS] windows.plist and data.data, [iOS] restorationinfo.plist and data.data", "metadata": {"source": "SANS_FOR518", "title": "Saved State Contents", "category": "dfir", "platform": "macos"}}
{"text": "Application Notifications: Notifications for applications are stored by the Graphical User Interface for the system. For macOS, this is called Finder; for iOS, it is SpringBoard.", "metadata": {"source": "SANS_FOR518", "title": "Application Notifications Description", "category": "dfir", "platform": "macos"}}
{"text": "Application Notifications macOS Location: /private/var/folders/<DARWIN_USER_DIR>/com.apple.notificationcenter/db2/db", "metadata": {"source": "SANS_FOR518", "title": "Application Notifications macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Application Notifications iOS Location: /private/var/mobile/Library/UserNotifications/<app GUID>/*.plist", "metadata": {"source": "SANS_FOR518", "title": "Application Notifications iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Application Notifications macOS: The user's DARWIN_USER_DIR path will be different for each user on the system. Attachments to notifications will be found in the /attachments directory.", "metadata": {"source": "SANS_FOR518", "title": "Notifications macOS DARWIN_USER_DIR", "category": "dfir", "platform": "macos"}}
{"text": "Application Notifications macOS: Database tracks notification delivery date, app bundle IDs, presentation, and style. NOTIFICATION DATA is a BLOB that contains a binary plist.", "metadata": {"source": "SANS_FOR518", "title": "Notifications macOS Database", "category": "dfir", "platform": "macos"}}
{"text": "Application Notifications iOS: plist files are in NSKeyedArchiver format. Notifications cleared by the user are removed from plist files.", "metadata": {"source": "SANS_FOR518", "title": "Notifications iOS Format", "category": "dfir", "platform": "ios"}}
{"text": "Application Notifications iOS: Other files in the same folder contain interface-specific items such as background pictures, icon layouts, and widgets.", "metadata": {"source": "SANS_FOR518", "title": "Notifications iOS Other Files", "category": "dfir", "platform": "ios"}}
{"text": "Application Notifications iOS: Pair app GUIDs with their associated bundle IDs by looking in [/private/var]/mobile/Library/UserNotificationsServer/Library.plist. This file is not included in iOS backups.", "metadata": {"source": "SANS_FOR518", "title": "Notifications iOS GUID Mapping", "category": "dfir", "platform": "ios"}}
{"text": "Software Installation and Updates: This determines installed applications and updates, including timestamps, package names, and software used to install an application.", "metadata": {"source": "SANS_FOR518", "title": "Software Installation Description", "category": "dfir", "platform": "macos"}}
{"text": "Software Installation macOS Location: ~/Library/Caches/com.apple.appstoreagent/storeSystem.db, /Library/Receipts/InstallHistory.plist", "metadata": {"source": "SANS_FOR518", "title": "Software Installation macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Software Installation macOS: /Library/Preferences/com.apple.SoftwareUpdate.plist - When system last checked for updates, how many updates were available, recommended updates.", "metadata": {"source": "SANS_FOR518", "title": "Software Update Preferences", "category": "dfir", "platform": "macos"}}
{"text": "Software Installation macOS: /var/log/install.log - Search the file for 'Installed' to find app names and versions.", "metadata": {"source": "SANS_FOR518", "title": "Software Installation install.log", "category": "dfir", "platform": "macos"}}
{"text": "Software Installation macOS: /var/db/receipts/ - Each software package install has a .bom and a .plist file. plist file contains install timestamp, package name, and installer process. bom file contains list of files and metadata for application.", "metadata": {"source": "SANS_FOR518", "title": "Software Installation receipts", "category": "dfir", "platform": "macos"}}
{"text": "Software Installation iOS Location: /private/var/installd/Library/Logs/MobileInstallation/mobile_installation.log.# - Search for 'Installing' to find app names and versions, for approximately one month of app installs.", "metadata": {"source": "SANS_FOR518", "title": "Software Installation iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Software Installation iOS: Search for 'Make container live' for app installs. Search for 'Destroying container' for app uninstalls. Search app bundle IDs for specific app activity.", "metadata": {"source": "SANS_FOR518", "title": "Software Installation iOS Search Terms", "category": "dfir", "platform": "ios"}}
{"text": "Software Installation iOS: /private/var/mobile/Library/FrontBoard/applicationState.db - It contains an embedded plist.", "metadata": {"source": "SANS_FOR518", "title": "Software Installation applicationState.db", "category": "dfir", "platform": "ios"}}
{"text": "InstallHistory.plist processName: macOS Installer = System OS installer/updater, softwareupdated or 'Software Update' = System/security updates, storedownloadd = App Store install, Installer = External installer.", "metadata": {"source": "SANS_FOR518", "title": "InstallHistory processName Values", "category": "dfir", "platform": "macos"}}
{"text": "Software Installation: bom file can be viewed using lsbom <bom file> command. install.log file will not include software installed via a drag and drop method.", "metadata": {"source": "SANS_FOR518", "title": "Software Installation bom Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Application Permissions - TCC: Applications on macOS and iOS ask users which permissions they may have for different capabilities on the system. This is recorded in Transparency, Consent, Control (TCC) databases.", "metadata": {"source": "SANS_FOR518", "title": "TCC Description", "category": "dfir", "platform": "macos"}}
{"text": "TCC macOS Location: ~/Library/Application Support/com.apple.TCC/TCC.db, /Library/Application Support/com.apple.TCC/TCC.db", "metadata": {"source": "SANS_FOR518", "title": "TCC macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "TCC iOS Location: /private/var/mobile/Library/TCC/TCC.db", "metadata": {"source": "SANS_FOR518", "title": "TCC iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "TCC: Apps may have access to permissions such as: Location, Contacts, Calendars, Photos, Bluetooth, Microphone, Camera, and Health.", "metadata": {"source": "SANS_FOR518", "title": "TCC Permission Types", "category": "dfir", "platform": "macos"}}
{"text": "TCC: last_modified = when this permission for this app was last updated in TCC. auth_value = 0 (not allowed), 2 (allowed).", "metadata": {"source": "SANS_FOR518", "title": "TCC Database Fields", "category": "dfir", "platform": "macos"}}
{"text": "TCC: kTCCServiceUbiquity permission is associated with iCloud. kTCCServiceEndpointSecurityClient permission is associated with Endpoint Security. kTCCServiceSystemPolicyAllFiles permission is associated with Full Disk Access.", "metadata": {"source": "SANS_FOR518", "title": "TCC Service Types", "category": "dfir", "platform": "macos"}}
{"text": "TCC: Not all permissions are shown to the user in the user interface. iOS TCC database is available in backup, physical and sysdiagnose acquisitions.", "metadata": {"source": "SANS_FOR518", "title": "TCC Hidden Permissions", "category": "dfir", "platform": "macos"}}
{"text": "Third-Party Kernel Extensions: Kernel modules are often used as device drivers, network filters, or support for filesystems, and can be used maliciously.", "metadata": {"source": "SANS_FOR518", "title": "Kernel Extensions Description", "category": "dfir", "platform": "macos"}}
{"text": "Kernel Extensions Location: /private/var/db/loadedkextmt.plist, /Library/Apple/System/Library/Extensions/, /System/Library/Extensions/, /Library/Extensions/, /Library/StagedExtensions/, /Library/SystemExtensions/, /Library/<Filesystems/macfuse.fs/Contents>/Extensions/", "metadata": {"source": "SANS_FOR518", "title": "Kernel Extensions Location", "category": "dfir", "platform": "macos"}}
{"text": "Kernel Extensions: On a live system, use systemextensionsctl list command to list loaded system extensions and kmutil showloaded command to list loaded kernel extensions.", "metadata": {"source": "SANS_FOR518", "title": "Kernel Extensions Live Commands", "category": "dfir", "platform": "macos"}}
{"text": "Kernel Extensions: Each extension is a bundle containing an Info.plist file.", "metadata": {"source": "SANS_FOR518", "title": "Kernel Extensions Bundle Format", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes macOS: A few extended attributes can reveal file sharing, including the sender, recipient, and application used.", "metadata": {"source": "SANS_FOR518", "title": "Extended Attributes File Sharing", "category": "dfir", "platform": "macos"}}
{"text": "AirDrop: AirDrop allows users to 'drop' files to another user's device if that device is close by and using WiFi or Bluetooth. Extended attributes for a received file will show the name of the device the file was sent from using AirDrop.", "metadata": {"source": "SANS_FOR518", "title": "AirDrop Description", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes: View extended attribute names for files using ls -l@. com.apple.quarantine contains the service of sharingd. com.apple.assetsd attributes contain AirDrop data such as file metadata and whether it was trashed or hidden.", "metadata": {"source": "SANS_FOR518", "title": "Extended Attributes View Commands", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes: com.apple.metadata:* contains Spotlight metadata. com.apple.metadata:kMDItemWhereFroms provides the time and application, (e.g., 'Received via Messages file transfer'). For files shared via AirDrop, this attribute provides the name of the device the item was sent from.", "metadata": {"source": "SANS_FOR518", "title": "Extended Attributes Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes: View extended attributes for a file using xattr -xl <file>.", "metadata": {"source": "SANS_FOR518", "title": "Extended Attributes xattr Command", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes: It shows files shared using AirDrop, email, Messages, and other applications. Spotlight database can be searched for these attributes to look for evidence of file sharing. Be aware that a device name can be changed by the user.", "metadata": {"source": "SANS_FOR518", "title": "Extended Attributes Analysis", "category": "dfir", "platform": "macos"}}
{"text": "AirDrop ID and Discoverability: AirDrop uses a StreamID to identify itself to other devices. The last StreamID used can be found in these plist files.", "metadata": {"source": "SANS_FOR518", "title": "AirDrop ID Description", "category": "dfir", "platform": "macos"}}
{"text": "AirDrop ID macOS Location: ~/Library/Preferences/[ByHost]/com.apple.sharingd.<HWUUID>.plist, ~/Library/Preferences/com.apple.sharingd.plist", "metadata": {"source": "SANS_FOR518", "title": "AirDrop ID macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "AirDrop ID iOS Location: /private/var/mobile/Library/Preferences/com.apple.sharingd.plist", "metadata": {"source": "SANS_FOR518", "title": "AirDrop ID iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "AirDrop ID: StreamID stores the device identifier. If an Apple Watch is being used to unlock a macOS device, this information can also be found in here.", "metadata": {"source": "SANS_FOR518", "title": "AirDrop StreamID", "category": "dfir", "platform": "macos"}}
{"text": "AirDrop Activity - Unified Logs: Files sent and received via AirDrop are tracked in Unified Logs. This includes a unique identifier for the transaction (AirDrop ID), the type of file being sent, whether the connection was accepted, and potentially where the received file ended up.", "metadata": {"source": "SANS_FOR518", "title": "AirDrop Unified Logs", "category": "dfir", "platform": "macos"}}
{"text": "AirDrop Logs: If you can analyze both the sending and receiving devices, you can tie the activity together using the AirDrop ID (ReceiverID). If only one device is available, attribution is much more difficult.", "metadata": {"source": "SANS_FOR518", "title": "AirDrop Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "AirDrop Logs: Be aware that device hostnames can easily be changed. Log shows whether the connection was 'Accepted' or 'Declined'.", "metadata": {"source": "SANS_FOR518", "title": "AirDrop Log Notes", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight: Spotlight indexes the system to allow the user to search for files quickly. Indexing includes metadata that indicates file sharing.", "metadata": {"source": "SANS_FOR518", "title": "Spotlight Description", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight Location: ~/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts.v3, /.Spotlight-V100/Store-V2/<GUID>, ~/Library/Metadata/CoreSpotlight/index.spotlightV3", "metadata": {"source": "SANS_FOR518", "title": "Spotlight Location", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight: Presence of the kMDItemOriginMessageID attribute shows files received via Apple Mail. kMDItemUserShare* keys can show sender and recipient metadata for Messages or AirDrop file transfers. kMDItemOriginApplicationIdentifier shows the application used.", "metadata": {"source": "SANS_FOR518", "title": "Spotlight File Sharing Attributes", "category": "dfir", "platform": "macos"}}
{"text": "Shared Folders macOS: Information and metadata for shared folders on the system.", "metadata": {"source": "SANS_FOR518", "title": "Shared Folders Description", "category": "dfir", "platform": "macos"}}
{"text": "Shared Folders Location: /private/var/db/com.apple.xpc.launchd/disabled*.plist, /Library/Preferences/com.apple.RemoteManagement.plist, /private/var/db/dslocal/nodes/Default/sharepoints/*.plist - List of shared folders and their metadata.", "metadata": {"source": "SANS_FOR518", "title": "Shared Folders Location", "category": "dfir", "platform": "macos"}}
{"text": "Shared Folders disabled.plist: By default, none of these settings are enabled. Look for com.apple.smbd and/or com.apple.AppleFileServer as the bundle IDs for shared folders.", "metadata": {"source": "SANS_FOR518", "title": "Shared Folders disabled.plist", "category": "dfir", "platform": "macos"}}
{"text": "Shared Folders sharepoints/*.plist: Each shared folder has its own plist file.", "metadata": {"source": "SANS_FOR518", "title": "Shared Folders sharepoints", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Documents: iCloud stores local copies of documents shared using various applications.", "metadata": {"source": "SANS_FOR518", "title": "iCloud Documents Description", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Documents macOS Location: ~/Library/Mobile Documents/", "metadata": {"source": "SANS_FOR518", "title": "iCloud Documents macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Documents iOS Location: /private/var/mobile/Library/Mobile Documents/", "metadata": {"source": "SANS_FOR518", "title": "iCloud Documents iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "iCloud Documents: Each subdirectory corresponds to an application and is named in reverse DNS format but using tildes (~).", "metadata": {"source": "SANS_FOR518", "title": "iCloud Documents Format", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Documents: Extended attributes for these documents include the iCloud Person ID in com.apple.ubd.prsid.", "metadata": {"source": "SANS_FOR518", "title": "iCloud Documents Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Documents: Hidden *.icloud files correspond to files that have not been downloaded to this device. These are binary plist files that contain the file's name and size.", "metadata": {"source": "SANS_FOR518", "title": "iCloud Documents Hidden Files", "category": "dfir", "platform": "macos"}}
{"text": "com.apple.loginwindow.plist: Last logged-in user, current logged-in user (on live system), auto-login user (if configured), and other settings are recorded in a plist file.", "metadata": {"source": "SANS_FOR518", "title": "loginwindow.plist Description", "category": "dfir", "platform": "macos"}}
{"text": "com.apple.loginwindow.plist Location: /Library/Preferences/com.apple.loginwindow.plist", "metadata": {"source": "SANS_FOR518", "title": "loginwindow.plist Location", "category": "dfir", "platform": "macos"}}
{"text": "loginwindow.plist: A user may choose 'Automatic login' in preferences. Their (XOR'd) password is then stored in /etc/kcpassword. Decode using script from https://gist.github.com/opshope/32f65875d45215c3677d", "metadata": {"source": "SANS_FOR518", "title": "loginwindow.plist Auto Login", "category": "dfir", "platform": "macos"}}
{"text": "loginwindow.plist: Automatic login is not available for user FileVault or iCloud credential logins.", "metadata": {"source": "SANS_FOR518", "title": "loginwindow.plist FileVault Note", "category": "dfir", "platform": "macos"}}
{"text": "macOS User Logins: These are successful and failed user account login and logout events.", "metadata": {"source": "SANS_FOR518", "title": "User Logins Description", "category": "dfir", "platform": "macos"}}
{"text": "User Logins Location: System log, Unified logs, ASL", "metadata": {"source": "SANS_FOR518", "title": "User Logins Location", "category": "dfir", "platform": "macos"}}
{"text": "User Logins: Login events are marked with USER_PROCESS and the process ID. Logoff events are marked with DEAD_PROCESS and the process ID.", "metadata": {"source": "SANS_FOR518", "title": "User Logins Event Types", "category": "dfir", "platform": "macos"}}
{"text": "User Logins: Login type is identified by: loginwindow = login via the GUI, login = login via the Terminal, sshd = login via SSH, screensharingd = Screen Sharing.", "metadata": {"source": "SANS_FOR518", "title": "User Login Types", "category": "dfir", "platform": "macos"}}
{"text": "macOS su Logins: These are successful and failed su logins.", "metadata": {"source": "SANS_FOR518", "title": "su Logins Description", "category": "dfir", "platform": "macos"}}
{"text": "su Logins Location: Audit logs, Unified logs", "metadata": {"source": "SANS_FOR518", "title": "su Logins Location", "category": "dfir", "platform": "macos"}}
{"text": "su Logins: View su logins in Audit logs: praudit -xn /var/audit/* - su. View attempts to use sudo in Unified Logs: log show --predicate '(process == \"su\" or process == \"sudo\") and eventMessage contains \"tty\"'", "metadata": {"source": "SANS_FOR518", "title": "su Logins Commands", "category": "dfir", "platform": "macos"}}
{"text": "macOS Account Creation: Entries in the audit log are added when a user account is created.", "metadata": {"source": "SANS_FOR518", "title": "Account Creation Description", "category": "dfir", "platform": "macos"}}
{"text": "Account Creation Location: Audit logs", "metadata": {"source": "SANS_FOR518", "title": "Account Creation Location", "category": "dfir", "platform": "macos"}}
{"text": "Account Creation: create user event includes the name of the new user and the UID of the user who created.", "metadata": {"source": "SANS_FOR518", "title": "Account Creation Event", "category": "dfir", "platform": "macos"}}
{"text": "macOS Screen Lock/Unlock: Events are recorded when the screen is locked or unlocked.", "metadata": {"source": "SANS_FOR518", "title": "Screen Lock Description", "category": "dfir", "platform": "macos"}}
{"text": "Screen Lock/Unlock Location: Unified logs", "metadata": {"source": "SANS_FOR518", "title": "Screen Lock Location", "category": "dfir", "platform": "macos"}}
{"text": "Screen Lock/Unlock: Screen lock events contain com.apple.sessionagent.screenIsLocked. Screen unlock events contain com.apple.sessionagent.screenIsUnlocked. This includes unlock actions using a regular password, TouchID, or Apple Watch.", "metadata": {"source": "SANS_FOR518", "title": "Screen Lock Events", "category": "dfir", "platform": "macos"}}
{"text": "macOS Known SSH Hosts: These are Hostnames, IP addresses, and public keys for hosts that this system has connected to via SSH, for which the user decided to save the key.", "metadata": {"source": "SANS_FOR518", "title": "Known SSH Hosts Description", "category": "dfir", "platform": "macos"}}
{"text": "Known SSH Hosts Location: ~/.ssh/known_hosts, ~/.ssh/authorized_hosts", "metadata": {"source": "SANS_FOR518", "title": "Known SSH Hosts Location", "category": "dfir", "platform": "macos"}}
{"text": "Known SSH Hosts: By default, hostnames and IP addresses will be readable. This data will be hashed if HashKnownHosts is set to yes in the /etc/ssh/ssh_config file.", "metadata": {"source": "SANS_FOR518", "title": "Known SSH Hosts Format", "category": "dfir", "platform": "macos"}}
{"text": "macOS su Privilege Escalation: Users with su privileges are recorded, as well as a log of commands that have been run as root.", "metadata": {"source": "SANS_FOR518", "title": "su Privilege Escalation Description", "category": "dfir", "platform": "macos"}}
{"text": "su Privilege Escalation: Users with root-level privileges: /etc/sudoers. Look for the sudo or su process in Unified logs.", "metadata": {"source": "SANS_FOR518", "title": "su Privilege Escalation Location", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes - DMG File Opened: Double-clicking a DMG file produces two additional extended attributes for that file that are specific to this action and this file type. These extended attributes show that the DMG was opened at least once.", "metadata": {"source": "SANS_FOR518", "title": "DMG Extended Attributes Description", "category": "dfir", "platform": "macos"}}
{"text": "DMG Extended Attributes: com.apple.diskimages.fsck provides file system check information. com.apple.diskimages.recentcksum provides checksum info and download date (Unix Epoch).", "metadata": {"source": "SANS_FOR518", "title": "DMG Extended Attributes Fields", "category": "dfir", "platform": "macos"}}
{"text": "DMG Extended Attributes: The first open timestamp from this process is recorded in ~/Library/Logs/fsck_hfs.log", "metadata": {"source": "SANS_FOR518", "title": "DMG First Open Timestamp", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes - File Last Used: BEWARE: This attribute may not show when the user last viewed a file as it's not always updated. For example: using the Finder QuickLook function will not update this timestamp.", "metadata": {"source": "SANS_FOR518", "title": "File Last Used Warning", "category": "dfir", "platform": "macos"}}
{"text": "File Last Used: This extended attribute shows when a file was last viewed either using Finder or the 'open' command in the Terminal.", "metadata": {"source": "SANS_FOR518", "title": "File Last Used Description", "category": "dfir", "platform": "macos"}}
{"text": "File Last Used: com.apple.lastuseddate#PS stores Unix Epoch timestamp of when file was last used, as it pertains to the file system. Not all file types have this attribute.", "metadata": {"source": "SANS_FOR518", "title": "File Last Used Attribute", "category": "dfir", "platform": "macos"}}
{"text": ".DS_Store - Folder Access: Hidden DS_Store files can exist all over macOS systems, and are created when the Finder application is used to access a directory.", "metadata": {"source": "SANS_FOR518", "title": "DS_Store Description", "category": "dfir", "platform": "macos"}}
{"text": ".DS_Store: These files implement a B-tree format. For trashed files, .DS_Store contains the original filename and original file path.", "metadata": {"source": "SANS_FOR518", "title": "DS_Store Format", "category": "dfir", "platform": "macos"}}
{"text": "Most Recently Used (MRU): A number of artifacts store information about recently accessed folders, applications, documents, hosts, and volumes on the system.", "metadata": {"source": "SANS_FOR518", "title": "MRU Description", "category": "dfir", "platform": "macos"}}
{"text": "MRU Location: ~/Library/Preferences/com.apple.finder.plist - FXRecentFolders key lists recently accessed folders in order, with the most recent under Item 0. file-bookmark BLOB contains the full folder path, Volume Name, and Volume GUID.", "metadata": {"source": "SANS_FOR518", "title": "MRU finder.plist", "category": "dfir", "platform": "macos"}}
{"text": "MRU Location: ~/Library/Application Support/com.apple.LSSharedFileList.*.sfl[2 or 3] - Recent items per application, volume, or host.", "metadata": {"source": "SANS_FOR518", "title": "MRU LSSharedFileList", "category": "dfir", "platform": "macos"}}
{"text": "MRU Microsoft Office 365: ~/Library/Containers/com.microsoft.<app>/Data/Library/Preferences/com.microsoft.<app>.securebookmarks.plist - Each key includes the last-used timestamp in kLastUsedDateKey. kBookmarkDataKey contains a bookmark data BLOB that includes the file path, volume name, and volume GUID.", "metadata": {"source": "SANS_FOR518", "title": "MRU Microsoft Office", "category": "dfir", "platform": "macos"}}
{"text": "MRU: SFL files are binary plists that use the NSKeyedArchiver format. Most native MRU lists keep the last 10 items by default. Microsoft Office keeps more.", "metadata": {"source": "SANS_FOR518", "title": "MRU SFL Format", "category": "dfir", "platform": "macos"}}
{"text": "Recent Folders: These are folders recently accessed by the user account.", "metadata": {"source": "SANS_FOR518", "title": "Recent Folders Description", "category": "dfir", "platform": "macos"}}
{"text": "Recent Folders Location: ~/Library/Preferences/com.apple.finder.plist - FXRecentFolders contains a bookmark data BLOB in file-bookmark. Item 0 is the most recent and item 9 is the least.", "metadata": {"source": "SANS_FOR518", "title": "Recent Folders Location", "category": "dfir", "platform": "macos"}}
{"text": "Recent Items: These are items recently accessed by the user account, per application.", "metadata": {"source": "SANS_FOR518", "title": "Recent Items Description", "category": "dfir", "platform": "macos"}}
{"text": "Recent Items Location: ~/Library/Application Support/com.apple.LSSharedFileList.*.sfl[2 or 3]. The list contains both native and third-party applications. Files are named in reverse DNS format.", "metadata": {"source": "SANS_FOR518", "title": "Recent Items Location", "category": "dfir", "platform": "macos"}}
{"text": "Finder - Mounted Volumes: The Finder application on macOS stores a list of volumes that have been mounted on the Desktop within a plist file. It includes the volume name with X and Y coordinates of volumes when mounted on the Desktop.", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Description", "category": "dfir", "platform": "macos"}}
{"text": "Mounted Volumes Location: ~/Library/Preferences/com.apple.finder.plist - FXDesktopVolumesPositions key", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Location", "category": "dfir", "platform": "macos"}}
{"text": "Mounted Volumes: Note: Some volumes may have an appended number. The key will not exist if the user does not have Finder preferences configured to show items on the Desktop. It includes host volumes, USB drives, and mounted DMG files.", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Notes", "category": "dfir", "platform": "macos"}}
{"text": "Logs - Mounted Volumes: Logs record what volumes were mounted on the system and can include the device file the volume is using, volume size, name, and mount point.", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Logs Description", "category": "dfir", "platform": "macos"}}
{"text": "Mounted Volumes Logs Location: /var/log/daily.out, System log, Unified logs", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Logs Location", "category": "dfir", "platform": "macos"}}
{"text": "Mounted Volumes Logs: Search for '/Volumes/' to find any volumes mounted under the default mount point. You can also search system.log and unified logs for apfs, hfs, mounted, unmounted, or disk#s#.", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Log Search", "category": "dfir", "platform": "macos"}}
{"text": "Mounted Volumes Logs: Find connections to network shares by searching for afp://, or on older systems: afpfs://, smbfs://, or smb://", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Network Shares", "category": "dfir", "platform": "macos"}}
{"text": "Mounted Volumes Logs: Searching on the volume name can find activity relating to that volume. Daily logs record what volumes were mounted on the system when the daily maintenance script was run.", "metadata": {"source": "SANS_FOR518", "title": "Mounted Volumes Daily Logs", "category": "dfir", "platform": "macos"}}
{"text": "Favorite Volumes: These are a list of favorite volumes, including the volume name and properties.", "metadata": {"source": "SANS_FOR518", "title": "Favorite Volumes Description", "category": "dfir", "platform": "macos"}}
{"text": "Favorite Volumes Location: ~/Library/Application Support/com.apple.sharedfilelist/com.apple.LSSharedFileList.FavoriteVolumes.sfl[2 or 3]. NSKeyedArchiver plist file containing Bookmark BLOBs.", "metadata": {"source": "SANS_FOR518", "title": "Favorite Volumes Location", "category": "dfir", "platform": "macos"}}
{"text": "Search Logs for Connected USB Devices: The USB Mass Storage Class (USBMSC) Identifier can be used to find USBMSC device connections in the System log and in Unified logs, including the device serial number, vendor, and product information.", "metadata": {"source": "SANS_FOR518", "title": "USB Device Logs Description", "category": "dfir", "platform": "macos"}}
{"text": "USB Device Logs: Search for USBMSC. Typical structure of these records: USBMSC Identifier (non-unique): <serial number> <VID> <PID> <version>. Be aware that not all USBMSC entries are user-initiated.", "metadata": {"source": "SANS_FOR518", "title": "USB Device Log Search", "category": "dfir", "platform": "macos"}}
{"text": "USB Device Logs: You can also find network share connections by filtering Unified Logs: process = NetAuthSysAgent AND sender = loginsupport", "metadata": {"source": "SANS_FOR518", "title": "USB Device Network Shares", "category": "dfir", "platform": "macos"}}
{"text": "Safari Browser Session Restore: Automatic Crash Recovery features are built into the browser.", "metadata": {"source": "SANS_FOR518", "title": "Safari Session Restore Description", "category": "dfir", "platform": "macos"}}
{"text": "Safari Session Restore macOS Location: ~/Library/Containers/com.apple.Safari/Data/Library/Caches/com.apple.Safari/TabSnapshots/*, ~/Library/Containers/com.apple.Safari/Data/Library/Caches/com.apple.Safari/TabSnapshots/Metadata.db - Connects URL to the filename (UUID) in the TabSnapshots folder.", "metadata": {"source": "SANS_FOR518", "title": "Safari Session Restore macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Safari Session Restore iOS Location: /private/var/mobile/Library/Safari/BrowserState.db, /private/var/mobile/Containers/Data/Application/<GUID>/Library/Safari/Thumbnails/*.png", "metadata": {"source": "SANS_FOR518", "title": "Safari Session Restore iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Safari BrowserState.db: Visit timestamps are stored in Mac Epoch format. order_index shows the tab order. private_browsing shows 0 (regular) or 1 (private browsing) mode being used. session_data contains a BLOB.", "metadata": {"source": "SANS_FOR518", "title": "Safari BrowserState.db Fields", "category": "dfir", "platform": "ios"}}
{"text": "Safari Thumbnail KTX files: Each screenshot is a preview of a tab, including those in private browsing mode. Files only present for tabs open when Safari was last backgrounded.", "metadata": {"source": "SANS_FOR518", "title": "Safari Thumbnails", "category": "dfir", "platform": "ios"}}
{"text": "Safari Browser History: This is the history of websites a user has visited. Some may be synced from iCloud, if this setting has been enabled, with devices and synced URLs listed in the Cloud Tabs database.", "metadata": {"source": "SANS_FOR518", "title": "Safari History Description", "category": "dfir", "platform": "macos"}}
{"text": "Safari History macOS Location: ~/Library/Safari/History.db, ~/Library/Containers/com.apple.Safari/Data/Library/Safari/SafariTabs.db, ~/Library/Containers/com.apple.Safari/Data/Library/Safari/CloudTabs.db", "metadata": {"source": "SANS_FOR518", "title": "Safari History macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Safari History iOS Location: /private/var/mobile/Library/Safari/History.db, /private/var/mobile/Library/Safari/SafariTabs.db, /private/var/mobile/Library/Safari/CloudTabs.db", "metadata": {"source": "SANS_FOR518", "title": "Safari History iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Safari History.db: On iOS, this data is retained for ~one month, on macOS, it's retained for ~one year by default (but can be re-configured). history_items contains URLs, domains, and visit counts. history_visits contains Mac Epoch timestamps of visits, and webpage titles.", "metadata": {"source": "SANS_FOR518", "title": "Safari History.db Fields", "category": "dfir", "platform": "macos"}}
{"text": "Safari History.db: Origin = 0 (visit occurred on this device), 1 (synced from another system via iCloud).", "metadata": {"source": "SANS_FOR518", "title": "Safari History Origin Field", "category": "dfir", "platform": "macos"}}
{"text": "Safari: SafariTabs.db stores browser session data and currently open tabs, and Tab Groups (think Bookmarks). CloudTabs.db lists synced iCloud tabs and devices that are syncing the user's Safari web history.", "metadata": {"source": "SANS_FOR518", "title": "Safari SafariTabs and CloudTabs", "category": "dfir", "platform": "macos"}}
{"text": "Safari macOS: RecentlyClosedTabs.plist also keeps track of recently closed tabs.", "metadata": {"source": "SANS_FOR518", "title": "Safari RecentlyClosedTabs", "category": "dfir", "platform": "macos"}}
{"text": "Safari Downloads: Safari download history is stored in a configuration file and can indicate websites visited and items downloaded.", "metadata": {"source": "SANS_FOR518", "title": "Safari Downloads Description", "category": "dfir", "platform": "macos"}}
{"text": "Safari Downloads Location: ~/Library/Safari/Downloads.plist", "metadata": {"source": "SANS_FOR518", "title": "Safari Downloads Location", "category": "dfir", "platform": "macos"}}
{"text": "Safari Downloads: By default, items are removed from this list after one day. This can be changed by the user to 'When Safari Quits', 'Upon Successful Download', or 'Manually'.", "metadata": {"source": "SANS_FOR518", "title": "Safari Downloads Retention", "category": "dfir", "platform": "macos"}}
{"text": "Safari Downloads: DownloadEntryURL (macOS) and sourceURL (iOS) show where the download originated. DownloadEntryPath (macOS) is the file path to show where the item was downloaded to.", "metadata": {"source": "SANS_FOR518", "title": "Safari Downloads Fields Part 1", "category": "dfir", "platform": "macos"}}
{"text": "Safari Downloads: DownloadEntryDateAddedKey (macOS) and DateAdded (iOS) indicate when the download started. DownloadEntryDateFinishedKey (macOS) and DateFinished (iOS) indicate when the download finished.", "metadata": {"source": "SANS_FOR518", "title": "Safari Downloads Fields Part 2", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes - File Download: Apple uses extended attributes to store metadata about downloaded files, including the download date and where the file was downloaded from.", "metadata": {"source": "SANS_FOR518", "title": "Download Extended Attributes Description", "category": "dfir", "platform": "macos"}}
{"text": "Download Extended Attributes: com.apple.quarantine provides quarantine data for downloaded files, including download time (Unix Epoch hex) and application used to download the file.", "metadata": {"source": "SANS_FOR518", "title": "Download quarantine Attribute", "category": "dfir", "platform": "macos"}}
{"text": "Download Extended Attributes: com.apple.metadata:kMDItemDownloadedDate provides the download date in NSDate format (8-byte BE). com.apple.metadata:kMDItemWhereFroms provides the URL the item was downloaded from, and referring URL.", "metadata": {"source": "SANS_FOR518", "title": "Download Metadata Attributes", "category": "dfir", "platform": "macos"}}
{"text": "Download Extended Attributes: Not all applications will create all of the above extended attributes; attributes produced depend on the app developer. kMDItemDownloadedDate is not stored by Chrome. kMDItemWhereFroms is not stored for Safari 'Safe Files'.", "metadata": {"source": "SANS_FOR518", "title": "Download Attributes Notes", "category": "dfir", "platform": "macos"}}
{"text": "Extended Attributes - Email Attachment Download: A few extended attributes are created when an email attachment is downloaded. com.apple.quarantine provides the download time and application (e.g., Mail).", "metadata": {"source": "SANS_FOR518", "title": "Email Attachment Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "Safari Cookies: Cookies provide insight into which websites have been visited and what activities might have taken place there.", "metadata": {"source": "SANS_FOR518", "title": "Safari Cookies Description", "category": "dfir", "platform": "macos"}}
{"text": "Safari Cookies macOS Location: ~/Library/Safari/Cookies.binarycookies, ~/Library/Containers/com.apple.Safari/Cookies.binarycookies", "metadata": {"source": "SANS_FOR518", "title": "Safari Cookies macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Safari Cookies iOS Location: /private/var/mobile/Library/Safari/Cookies.binarycookies, /private/var/mobile/Containers/Data/Application/<UUID>/Library/Safari/Cookies.binarycookies", "metadata": {"source": "SANS_FOR518", "title": "Safari Cookies iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Safari Cookies: Safari also uses the Cookie file com.apple.Safari.SafeBrowsing.binarycookie. Other applications that have internal browsers may have their own WebKit cache and cookies.", "metadata": {"source": "SANS_FOR518", "title": "Safari Cookies Notes", "category": "dfir", "platform": "macos"}}
{"text": "Safari Browser Cache: Files may be cached by the browser when the user visits a webpage. Full reconstruction of a website using only cached items is unlikely.", "metadata": {"source": "SANS_FOR518", "title": "Safari Cache Description", "category": "dfir", "platform": "macos"}}
{"text": "Safari Cache macOS Location: ~/Library/Containers/com.apple.Safari/Data/Library/Safari/com.apple.Safari/WebKitCache/Version ##/*", "metadata": {"source": "SANS_FOR518", "title": "Safari Cache macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Safari Cache iOS Location: /private/var/mobile/Containers/Data/Application/<UUID>/Library/Caches/WebKit/Version ##/*", "metadata": {"source": "SANS_FOR518", "title": "Safari Cache iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Safari Cache: Records/SubResources folder contains a list of cached items per website visit and embedded SHA1 hashes for each file. Records/Resources folder contains cached data and metadata, including SHA1 of filename for related file in the Blobs folder.", "metadata": {"source": "SANS_FOR518", "title": "Safari Cache Structure", "category": "dfir", "platform": "macos"}}
{"text": "Safari Cache: Additional cached data may exist in the Blobs folder. Cached data may be stored in multiple separate files if it's too large to fit into a single file. This is often seen with media.", "metadata": {"source": "SANS_FOR518", "title": "Safari Cache Blobs", "category": "dfir", "platform": "macos"}}
{"text": "Search - Spotlight: Spotlight indexes the system to allow the user to search for files quickly. Indexing includes file metadata, extended attributes, and content of some file types.", "metadata": {"source": "SANS_FOR518", "title": "Spotlight Search Description", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight User shortcuts Location: ~/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts.v3, ~/Library/Group Containers/group.com.apple.spotlight/com.apple.spotlight.Shortcuts.v3", "metadata": {"source": "SANS_FOR518", "title": "Spotlight Shortcuts Location", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight Main indexing databases Location: /.Spotlight-V100/Store-V2/<GUID> - VolumeConfiguration.plist contains indexing exclusions and other configuration data. Cache directory contains subdirectories of text-based versions of original documents, each named for the file's inode. [.]store.db are the index databases.", "metadata": {"source": "SANS_FOR518", "title": "Spotlight Index Location", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight User database Location: ~/Library/Metadata/CoreSpotlight/index.spotlightV3", "metadata": {"source": "SANS_FOR518", "title": "Spotlight User Database", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight: A volume can explicitly be marked to disable indexing by placing a hidden, empty file named .metadata_never_index in the root of the volume.", "metadata": {"source": "SANS_FOR518", "title": "Spotlight Disable Indexing", "category": "dfir", "platform": "macos"}}
{"text": "Spotlight: Some locations are not indexed by default, including DMG files, CDs, DVDs, hidden files and system directories. User shortcut files provide words actually typed in by the user.", "metadata": {"source": "SANS_FOR518", "title": "Spotlight Exclusions", "category": "dfir", "platform": "macos"}}
{"text": "Files Quarantined by XProtect AV: Some applications implement file tagging, so XProtect can automatically quarantine downloaded files that are deemed to be potentially malicious. Files that are quarantined are recorded in a database.", "metadata": {"source": "SANS_FOR518", "title": "XProtect Description", "category": "dfir", "platform": "macos"}}
{"text": "XProtect Location: ~/Library/Preferences/com.apple.LaunchServices.QuarantineEvents.V2", "metadata": {"source": "SANS_FOR518", "title": "XProtect Database Location", "category": "dfir", "platform": "macos"}}
{"text": "XProtect signature file Location: /Library/Apple/System/Library/CoreServices/XProtect.bundle/Contents/Resources/Xprotect.plist - Xprotect.meta.plist in the same folder contains the date the signature file was last updated.", "metadata": {"source": "SANS_FOR518", "title": "XProtect Signatures Location", "category": "dfir", "platform": "macos"}}
{"text": "XProtect: If an application is implementing this feature, it will have the LSFileQuarantineEnabled key set to True in its Info.plist file. Files copied off a USB or downloaded using an app that does not implement this feature will not be checked by XProtect.", "metadata": {"source": "SANS_FOR518", "title": "XProtect Implementation", "category": "dfir", "platform": "macos"}}
{"text": "XProtect QuarantineEvents fields: LSQuarantineTimeStamp = Timestamp when file was quarantined (Mac Absolute/WebKit time). LSQuarantineAgentBundleIdentifier = Application bundle ID that downloaded the file. LSQuarantineAgentName = Application that downloaded the file.", "metadata": {"source": "SANS_FOR518", "title": "XProtect Database Fields Part 1", "category": "dfir", "platform": "macos"}}
{"text": "XProtect QuarantineEvents fields: LSQuarantineDataURLString = URL the file was downloaded from. LSQuarantineTypeNumber = 0 (web browsers), 1 (XCode), 2 (Apple Mail), 3 (iChat), 6 (AirDrop), and 7 means another app.", "metadata": {"source": "SANS_FOR518", "title": "XProtect Database Fields Part 2", "category": "dfir", "platform": "macos"}}
{"text": "XProtect: XProtect is only updated when Apple decides to update it and signatures are limited. The com.apple.quarantine extended attribute for a downloaded file may also contain useful information.", "metadata": {"source": "SANS_FOR518", "title": "XProtect Limitations", "category": "dfir", "platform": "macos"}}
{"text": "macOS Trash: Any files or folders deleted by the user are saved into a hidden Trash folder in the root of that user's home directory.", "metadata": {"source": "SANS_FOR518", "title": "Trash Description", "category": "dfir", "platform": "macos"}}
{"text": "Trash Location: ~/.Trash", "metadata": {"source": "SANS_FOR518", "title": "Trash Location", "category": "dfir", "platform": "macos"}}
{"text": "Trash: Some trashed files can be restored using the 'Put Back' option. If the file has this option, the data can be found in the .DS_Store file in Trash.", "metadata": {"source": "SANS_FOR518", "title": "Trash Put Back", "category": "dfir", "platform": "macos"}}
{"text": "Trash: Safari 'Safe' files are sent directly to Trash as they are auto-unzipped on download. Option available in com.apple.finder.plist to remove files from Trash after 30 days. iCloud may have its own Trash in the Mobile Documents directory.", "metadata": {"source": "SANS_FOR518", "title": "Trash Notes", "category": "dfir", "platform": "macos"}}
{"text": "File System Events Store Database: Each volume connected to a Mac system will have a File System Events Store Database that is responsible for storing file system changes on the volume.", "metadata": {"source": "SANS_FOR518", "title": "FSEvents Description", "category": "dfir", "platform": "macos"}}
{"text": "FSEvents: It includes events such as file/folder creation and renaming, unzipping of files, item deletion, Trash being emptied, and volumes being mounted and unmounted.", "metadata": {"source": "SANS_FOR518", "title": "FSEvents Event Types", "category": "dfir", "platform": "macos"}}
{"text": "FSEvents Location: /.fseventsd/", "metadata": {"source": "SANS_FOR518", "title": "FSEvents Location", "category": "dfir", "platform": "macos"}}
{"text": "FSEvents: Directory contains gzipped files that require root privileges to unzip and view. It can be wiped during a system crash or a hard power off. Events do not have associated timestamps. Approximate times can sometimes be estimated using filenames and paths.", "metadata": {"source": "SANS_FOR518", "title": "FSEvents Format", "category": "dfir", "platform": "macos"}}
{"text": "FSEvents: Parse using FSEvents Parser https://github.com/mac4n6/FSEventsParser (Updated fork of original script by Nicole Ibrahim)", "metadata": {"source": "SANS_FOR518", "title": "FSEvents Parser Tool", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions: Document Versions (or Revisions) allows macOS to automatically back up certain types of documents or restore documents after a system crash.", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Description", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions: Versions are created when a document is saved, opened, every hour a document is open, and when it is frequently being edited. This feature is only supported by certain applications.", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Creation", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions macOS Location: /System/Volume/Data/.DocumentRevisions-V100", "metadata": {"source": "SANS_FOR518", "title": "Document Versions macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions iOS FFS Location: /private/var/.DocumentRevisions-V100", "metadata": {"source": "SANS_FOR518", "title": "Document Versions iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Document Versions: /db-V1/db.sqlite - Contains metadata for document versions. /.cs/ChunkStorage/* - contains file versions. Microsoft Office does not implement Document Versions; this has its own autosave feature.", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Structure", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions: Users can access document versions within an application via File - Revert To - Browse All Versions...", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Access", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions: Hidden .DocumentRevisions-V100 directory contains a folder named PerUID or AllUIDs. Subdirectories are named <UID>, which are unique across all UIDs on system volumes.", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Directory Structure", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions: <UID> subdirectories contain further subdirectories named in reverse DNS format: com.apple.documentVersions contains versions for documents saved on the local volume. com.apple.ubiquity contains versions for documents saved on the local volume and iCloud. com.apple.thumbnails contains versions for QuickLook thumbnails.", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Subdirectories", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions extended attributes: com.apple.genstore.info contains an embedded binary plist that may include the hostname of the system on which the version was created. com.apple.genstore.origdisplayname or com.apple.genstore.posixname stores the filename for this generation.", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "Document Versions: Note that file versions may be shown as zero bytes in size. Some tracked files may not be stored using ChunkStorage, but instead stored inline in the APFS file system.", "metadata": {"source": "SANS_FOR518", "title": "Document Versions Notes", "category": "dfir", "platform": "macos"}}
{"text": "macOS vs Windows Artifacts: plist files = Registry, fsevents = USNJrnl, DS_Store = Shellbags, Trash = Recycle Bin, Spotlight = Windows Search, Extended attributes = ADS", "metadata": {"source": "SANS_FOR518", "title": "macOS vs Windows Artifacts Part 1", "category": "dfir", "platform": "macos"}}
{"text": "macOS vs Windows Artifacts: LoginItems and Launch Agents/Daemons = Autoruns, MRU = MRU, Spotlight = Prefetch, knowledgeC.db = SRUM. Note: These are not exact like-for-like comparable artifacts, but do contain similar types of data.", "metadata": {"source": "SANS_FOR518", "title": "macOS vs Windows Artifacts Part 2", "category": "dfir", "platform": "macos"}}
{"text": "macOS Artifacts on Non-Mac Systems: Copying data from a macOS system to a non-Mac system does not always copy everything.", "metadata": {"source": "SANS_FOR518", "title": "Cross-Platform Artifact Note", "category": "dfir", "platform": "macos"}}
{"text": "HFS+/APFS to FAT/exFAT: Document Versions (HFS+/APFS yes, FAT/exFAT no), Spotlight (yes/yes), Trash (yes/yes), File System Events (yes/no - empty dir), Extended Attributes (yes/yes as separate AppleDouble file), .DS_store files (yes/yes)", "metadata": {"source": "SANS_FOR518", "title": "Cross-Platform Artifact Comparison", "category": "dfir", "platform": "macos"}}
{"text": "Apple System Log (ASL) Location: /private/var/log/asl/ - YYYY.MM.DD.[UID].[GID].asl. Login records (utmp, wtmp, lastlog): BB.YYYY.MM.DD.[UID].[GID].asl. Additional syslog data directories: AUX.YYYY.MM.DD", "metadata": {"source": "SANS_FOR518", "title": "ASL Location", "category": "dfir", "platform": "macos"}}
{"text": "Apple System Log (ASL): View using Console.app or syslog command. Messages logged by syslog: TTL is seven days. Messages logged by utmp, wtmp, and lastlog: TTL is 366 days. Timestamps are stored in UTC.", "metadata": {"source": "SANS_FOR518", "title": "ASL Interpretation", "category": "dfir", "platform": "macos"}}
{"text": "ASL: Collate logs: syslog -F raw -T utc -d /private/var/log/asl/ > asl.log. Open in Console: open -a Console asl.log", "metadata": {"source": "SANS_FOR518", "title": "ASL Commands", "category": "dfir", "platform": "macos"}}
{"text": "macOS 13- Audit Logs Location: /private/var/audit/<start_time YYYYMMDDHHMMSS>.<end_time YYYYMMDDHHMMSS>. Audit log configuration files: /etc/security/audit_*", "metadata": {"source": "SANS_FOR518", "title": "Audit Logs Location", "category": "dfir", "platform": "macos"}}
{"text": "Audit Logs: Deprecated on macOS 11, disabled in macOS 14. Timestamps are stored in UTC. praudit command may output timestamps in local time. Use TZ=UTC command to temporarily change terminal timezone to UTC.", "metadata": {"source": "SANS_FOR518", "title": "Audit Logs Interpretation", "category": "dfir", "platform": "macos"}}
{"text": "Audit Logs: Collate logs: praudit -xn /private/var/audit/*.* > audit.log. Open collected log in Console: open -a Console audit.log", "metadata": {"source": "SANS_FOR518", "title": "Audit Logs Commands", "category": "dfir", "platform": "macos"}}
{"text": "System.log Location: /private/var/log/system.log. Timestamps are stored in localtime.", "metadata": {"source": "SANS_FOR518", "title": "System.log Location", "category": "dfir", "platform": "macos"}}
{"text": "System.log: Concatenate system logs into one file using the command: gzcat system.log.{6..0}.gz > system_all.log", "metadata": {"source": "SANS_FOR518", "title": "System.log Concatenate", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Location: /private/var/db/diagnostics/*.tracev3, /private/var/db/uuidtext/*. Messages associated with SessionAgentNotificationCenter show user-initiated actions relating to system shutdown events.", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Location", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs: Timestamps are stored in UTC.", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Timestamps", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs: Create logarchive bundle for offline analysis: Create logarchive folder: sudo mkdir logs.logarchive. Copy log files: cp -R /private/var/db/uuidtext/ /private/var/db/diagnostics/ logs.logarchive", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Logarchive Creation", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs: Make logarchive format: /usr/libexec/PlistBuddy -c \"Add :OSArchiveVersion integer 4\" logs.logarchive/Info.plist", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Logarchive Format", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Analysis: Get USBMSC entries: log show logs.logarchive/ --timezone UTC --info --predicate 'eventMessage contains \"USBMSC\"'", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs USBMSC Query", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Analysis: Search for a device's volume name: log show logs.logarchive/ --timezone UTC --info --predicate 'eventMessage contains \"VOL_NAME\"'", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Volume Query", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Analysis: Export unified logs to text file: log show logs.logarchive/ --timezone UTC --info > galaga_logs.txt", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Export", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Analysis: List shutdowns/reboots: log show logs.logarchive/ --timezone UTC --info --predicate 'eventMessage contains \"com.apple.system.loginwindow\" and eventMessage contains \"SessionAgentNotificationCenter\"'", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Shutdown Query", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Analysis: List shutdown cause: log show logs.logarchive/ --timezone UTC --info --predicate 'eventMessage contains[c] \"shutdown cause\"'", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Shutdown Cause", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Analysis: Get backup logs: log show logs.logarchive/ --timezone UTC --info --predicate 'process = \"backupd\" and category = \"general\"'", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Backup Query", "category": "dfir", "platform": "macos"}}
{"text": "Unified Logs Analysis: Get network logs: log show logs.logarchive/ --timezone UTC --info --predicate 'senderImagePath contains[cd] \"IPConfiguration\" and (eventMessage contains[cd] \"SSID\" or eventMessage contains[cd] \"Lease\" or eventMessage contains[cd] \"network changed\")'", "metadata": {"source": "SANS_FOR518", "title": "Unified Logs Network Query", "category": "dfir", "platform": "macos"}}
{"text": "Applications Requesting Location Permissions: The system records a list of applications that have requested location services.", "metadata": {"source": "SANS_FOR518", "title": "Location Permissions Description", "category": "dfir", "platform": "macos"}}
{"text": "Location Permissions macOS Location: ~/Library/Application Support/com.apple.TCC/TCC.db, /Library/Application Support/com.apple.TCC/TCC.db, /private/var/db/locationd/clients.plist", "metadata": {"source": "SANS_FOR518", "title": "Location Permissions macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Location Permissions iOS Location: /private/var/mobile/Library/TCC/TCC.db, /private/var/root/Library/Caches/locationd/clients.plist", "metadata": {"source": "SANS_FOR518", "title": "Location Permissions iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Location TCC.db: It includes last_modified timestamp for each permission for each application. auth_value = 0 (not allowed), 2 (allowed). kTCCServiceLiverpool permission is generally assumed to be part of location services. iOS TCC database is available in backup, physical and sysdiagnose acquisitions.", "metadata": {"source": "SANS_FOR518", "title": "Location TCC.db Fields", "category": "dfir", "platform": "macos"}}
{"text": "Location clients.plist: Authorization = 1 (Never), 2 (While Using), 4 (Always). No Authorization key means 'Ask'. CorrectiveCompensationEnabled = 1 (or no key) means Precise Location is enabled, 2 means disabled.", "metadata": {"source": "SANS_FOR518", "title": "Location clients.plist Fields", "category": "dfir", "platform": "macos"}}
{"text": "iOS Frequent and Significant Locations: When enabled, the Significant Locations setting uses location services to keep track of a device's location and finds routines in their pattern.", "metadata": {"source": "SANS_FOR518", "title": "Significant Locations Description", "category": "dfir", "platform": "ios"}}
{"text": "Significant Locations Location: /private/var/mobile/Library/Caches/com.apple.routined/*.sqlite", "metadata": {"source": "SANS_FOR518", "title": "Significant Locations Location", "category": "dfir", "platform": "ios"}}
{"text": "Significant Locations: Setting can be enabled or disabled in Settings - Privacy - Location Services - System Services - Significant Locations. Algorithm to establish how the device marks a location as 'frequent' is unknown.", "metadata": {"source": "SANS_FOR518", "title": "Significant Locations Settings", "category": "dfir", "platform": "ios"}}
{"text": "Significant Locations: Cloud[-V2].sqlite database shows visits to certain locations. Use APOLLO routined_cloud_visit_entry module to extract location visits.", "metadata": {"source": "SANS_FOR518", "title": "Significant Locations Cloud.sqlite", "category": "dfir", "platform": "ios"}}
{"text": "Significant Locations: Cache.sqlite database contains very granular location data for about one week. Use APOLLO routined_cache_zrtcllocationmo module to extract location visits. Data is also found on macOS, however it is encrypted.", "metadata": {"source": "SANS_FOR518", "title": "Significant Locations Cache.sqlite", "category": "dfir", "platform": "ios"}}
{"text": "Cellular and WiFi Locations: Locations of various cellular and WiFi access are recorded in a few databases.", "metadata": {"source": "SANS_FOR518", "title": "Cellular WiFi Locations Description", "category": "dfir", "platform": "macos"}}
{"text": "Cellular WiFi Locations macOS Location: /private/var/folders/*/<DARWIN_USER_DIR>/cache_encrypted*.db, /private/var/folders/*/<DARWIN_USER_DIR>/lockCache_encrypted*.db", "metadata": {"source": "SANS_FOR518", "title": "Cellular WiFi macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Cellular WiFi Locations iOS FFS Location: /private/var/root/Library/caches/locationd/cache_encrypted*.db, /private/var/root/Library/caches/locationd/lockCache_encrypted*.db", "metadata": {"source": "SANS_FOR518", "title": "Cellular WiFi iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Cellular WiFi Locations: Data is retained for ~one week, but this varies per table. Data in the WifiLocation table is retained for ~four days. Timestamps are stored in Mac Epoch and appear to be accurate. Locations are accurate to within the general area.", "metadata": {"source": "SANS_FOR518", "title": "Cellular WiFi Data Retention", "category": "dfir", "platform": "macos"}}
{"text": "Cellular WiFi Locations: MAC addresses are stored in Base10. <DARWIN_USER_DIR> will be different for each user and is explained in more detail at: http://www.swiftforensics.com/2017/04/themystery-of-varfolders-on-osx.html", "metadata": {"source": "SANS_FOR518", "title": "Cellular WiFi Notes", "category": "dfir", "platform": "macos"}}
{"text": "Cellular WiFi Locations: Use APOLLO locationd_cacheencryptedAB_ltecelllocation module to extract location data.", "metadata": {"source": "SANS_FOR518", "title": "Cellular WiFi APOLLO Module", "category": "dfir", "platform": "macos"}}
{"text": "FindMy - Device Location: The FindMy application tracks a user's iCloud connected devices in a JSON file.", "metadata": {"source": "SANS_FOR518", "title": "FindMy Device Location Description", "category": "dfir", "platform": "ios"}}
{"text": "FindMy Device Location: /private/var/mobile/Library/Caches/com.apple.findmy.fmipcore/Devices.data. This can include devices such as AirPods. Includes last connected timestamp and location.", "metadata": {"source": "SANS_FOR518", "title": "FindMy Device Location Details", "category": "dfir", "platform": "ios"}}
{"text": "Operating System Version and Serial Number: This determines the OS version, build version, and serial number.", "metadata": {"source": "SANS_FOR518", "title": "OS Version Description", "category": "dfir", "platform": "macos"}}
{"text": "OS Version macOS Location: /System/Library/CoreServices/SystemVersion.plist - OS version, build version. /private/var/folders/*/<DARWIN_USER_DIR>/cache_encryptedA.db - Serial number.", "metadata": {"source": "SANS_FOR518", "title": "OS Version macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "OS Version iOS Location: /mobile/Library/Logs/AppleSupport/general.log, /logs/AppleSupport/general.log - Device model, OS version, serial number.", "metadata": {"source": "SANS_FOR518", "title": "OS Version iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "OS Version iOS: /private/var/containers/Data/System/<GUID>/Library/activation_records/activation_record.plist, /private/var/containers/Data/System/<GUID>/Library/activation_records/wildcard_record.plist - Device UDID, IMEI, model, serial number.", "metadata": {"source": "SANS_FOR518", "title": "OS Version iOS Activation Records", "category": "dfir", "platform": "ios"}}
{"text": "OS Version iOS: /private/var/mobile/Library/Preferences/com.apple.springboard.plist - Device locale, OS version, as well as settings such as erase device after 10 failed passcode attempts.", "metadata": {"source": "SANS_FOR518", "title": "OS Version iOS springboard.plist", "category": "dfir", "platform": "ios"}}
{"text": "OS Version iOS: /private/var/mobile/Library/Preferences/com.apple.purplebuddy.plist - Device setup info, including original locale, setup time, and hardware model.", "metadata": {"source": "SANS_FOR518", "title": "OS Version iOS purplebuddy.plist", "category": "dfir", "platform": "ios"}}
{"text": "OS Version iOS: Info.plist - Device hostname, model, UDID, iOS version, serial number.", "metadata": {"source": "SANS_FOR518", "title": "OS Version iOS Info.plist", "category": "dfir", "platform": "ios"}}
{"text": "Operating System Installation Date: This determines the OS installation date and date of updates.", "metadata": {"source": "SANS_FOR518", "title": "OS Installation Date Description", "category": "dfir", "platform": "macos"}}
{"text": "OS Installation Date: /private/var/db/.AppleSetupDone - Date of last OS update: stat -x /private/var/db/.AppleSetupDone (Change date).", "metadata": {"source": "SANS_FOR518", "title": "OS Installation AppleSetupDone", "category": "dfir", "platform": "macos"}}
{"text": "OS Installation Date: /private/var/log/install.log - OS installation date: grep \"Installed\\ \\\"macOS\" install.log", "metadata": {"source": "SANS_FOR518", "title": "OS Installation install.log", "category": "dfir", "platform": "macos"}}
{"text": "OS Installation Date: /private/var/db/softwareupdate/journal.plist - InstallDate keys show OS installation timestamps.", "metadata": {"source": "SANS_FOR518", "title": "OS Installation journal.plist", "category": "dfir", "platform": "macos"}}
{"text": "OS Installation Date: /private/var/mobile/Library/Preferences/com.apple.purplebuddy.plist - Device setup info, original locale, setup time, device model.", "metadata": {"source": "SANS_FOR518", "title": "OS Installation iOS", "category": "dfir", "platform": "ios"}}
{"text": "OS Installation Date: There may be a difference in time zones - original time zone is Cupertino, before user sets their own.", "metadata": {"source": "SANS_FOR518", "title": "OS Installation Timezone Note", "category": "dfir", "platform": "macos"}}
{"text": "User Accounts: Each user and group has their own plist file.", "metadata": {"source": "SANS_FOR518", "title": "User Accounts Description", "category": "dfir", "platform": "macos"}}
{"text": "User Accounts Location: /private/var/db/dslocal/nodes/Default/users/, /private/var/db/dslocal/nodes/Default/groups/", "metadata": {"source": "SANS_FOR518", "title": "User Accounts Location", "category": "dfir", "platform": "macos"}}
{"text": "User Accounts: Files may be binary or XML plist files depending on the OS version. Access to these directories requires root privileges. Each plist file contains the account creation timestamp, last password reset time, username, and potentially the associated email address.", "metadata": {"source": "SANS_FOR518", "title": "User Accounts Contents", "category": "dfir", "platform": "macos"}}
{"text": "User Accounts: Timestamps are stored in Unix Epoch format. failedLoginCount and failedLoginTimestamp values do not appear to be updated.", "metadata": {"source": "SANS_FOR518", "title": "User Accounts Timestamps", "category": "dfir", "platform": "macos"}}
{"text": "macOS User Account Passwords: User account password hashes are stored locally. The format and location of these has changed with different versions of macOS.", "metadata": {"source": "SANS_FOR518", "title": "User Passwords Description", "category": "dfir", "platform": "macos"}}
{"text": "User Passwords Location: /private/var/db/dslocal/nodes/Default/users/* - ShadowHashData key in plist files contains the password hash. Password hash is a salted SHA512 PBKDF2 hash.", "metadata": {"source": "SANS_FOR518", "title": "User Passwords Location", "category": "dfir", "platform": "macos"}}
{"text": "User Passwords: John The Ripper (JTR) and Hashcat include password cracking support for all of these hashes.", "metadata": {"source": "SANS_FOR518", "title": "User Passwords Cracking", "category": "dfir", "platform": "macos"}}
{"text": "Deleted User Accounts: If any user accounts have been deleted on the system, they will be listed in a plist file under the deletedUsers key. This file may not exist if no accounts have been deleted.", "metadata": {"source": "SANS_FOR518", "title": "Deleted Users Description", "category": "dfir", "platform": "macos"}}
{"text": "Deleted User Accounts Location: /Library/Preferences/com.apple.preferences.accounts.plist", "metadata": {"source": "SANS_FOR518", "title": "Deleted Users Location", "category": "dfir", "platform": "macos"}}
{"text": "Deleted User Accounts: When a user account is deleted, the user's plist in the /private/var/db/dslocal/nodes/Default/users/ directory is also removed. Lists user's name, UID, username, and deletion date for each account.", "metadata": {"source": "SANS_FOR518", "title": "Deleted Users Contents", "category": "dfir", "platform": "macos"}}
{"text": "Deleted User Accounts: Three options for the user's data are made available when an account is deleted: Save the home folder to a DMG file, which is saved to /Users/Deleted Users/, Leave the home folder in place, Remove the user's home directory.", "metadata": {"source": "SANS_FOR518", "title": "Deleted Users Data Options", "category": "dfir", "platform": "macos"}}
{"text": "Time Zone: This determines the current time zone of the system.", "metadata": {"source": "SANS_FOR518", "title": "Time Zone Description", "category": "dfir", "platform": "macos"}}
{"text": "Time Zone Location: /etc/localtime, /Library/Preferences/.GlobalPreferences.plist", "metadata": {"source": "SANS_FOR518", "title": "Time Zone Location", "category": "dfir", "platform": "macos"}}
{"text": "Time Zone: The GlobalPreferences.plist file contains the time zone configuration data. It may not be updated when switching between static location and location services.", "metadata": {"source": "SANS_FOR518", "title": "Time Zone GlobalPreferences", "category": "dfir", "platform": "macos"}}
{"text": "Time Zone: /Library/Preferences/com.apple.timezone.auto.plist shows if location services are enabled. Timezone changes are recorded in system.log and Unified Logs.", "metadata": {"source": "SANS_FOR518", "title": "Time Zone Changes", "category": "dfir", "platform": "macos"}}
{"text": "Time Zone: Timestamps stored in localtime in system log and UTC in Unified Logs. Search for 'location' or 'timezoned'. Timestamp jumps may also be visible in /var/log/* as these logs record events in local time.", "metadata": {"source": "SANS_FOR518", "title": "Time Zone Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Time Zone: Last modified timestamp of /etc/localtime symlink is updated when the timezone is changed.", "metadata": {"source": "SANS_FOR518", "title": "Time Zone localtime Symlink", "category": "dfir", "platform": "macos"}}
{"text": "iOS Evidence of Jailbreaking: Some indicators may exist that point to a device being jailbroken. Indicators will differ depending on the device and type of jailbreak used.", "metadata": {"source": "SANS_FOR518", "title": "Jailbreak Evidence Description", "category": "dfir", "platform": "ios"}}
{"text": "Jailbreak Evidence: /private/etc/fstab - Look for System partition mounted as rw.", "metadata": {"source": "SANS_FOR518", "title": "Jailbreak fstab", "category": "dfir", "platform": "ios"}}
{"text": "Jailbreak Evidence: /Applications - Look for unofficial app stores associated with jailbreaks. Common apps: Cydia, Bydia, Zydia, Installer, 25pp, Maiyadi.", "metadata": {"source": "SANS_FOR518", "title": "Jailbreak App Stores", "category": "dfir", "platform": "ios"}}
{"text": "Jailbreak Evidence: /Applications - Look for apps associated with jailbreaks. Common apps: Meridian, LiberiOS, mac_portal, Pangu, unc0v3r, rootlessJB, checkra1n.", "metadata": {"source": "SANS_FOR518", "title": "Jailbreak Apps", "category": "dfir", "platform": "ios"}}
{"text": "Jailbreak Evidence: /Applications - Look for unauthorized apps associated with jailbreaks. Common apps: iFile, SBSettings, or SSH, tethering, and configuration apps.", "metadata": {"source": "SANS_FOR518", "title": "Jailbreak Unauthorized Apps", "category": "dfir", "platform": "ios"}}
{"text": "Jailbreak Evidence: Files or directories associated with any of the above apps, or forensic utilities (e.g., dumpkeys6 is created by Elcomsoft).", "metadata": {"source": "SANS_FOR518", "title": "Jailbreak Files", "category": "dfir", "platform": "ios"}}
{"text": "iCloud-Synced Accounts and Preferences: Each iCloud account synced to the system will be recorded as a file named for the iCloud Person ID in the iCloud Accounts folder.", "metadata": {"source": "SANS_FOR518", "title": "iCloud Accounts Description", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Accounts: This same directory contains links named for each email address associated with an iCloud account that points to the relevant iCloud Person ID for that account. Preferences are also synced across devices into the SyncedPreferences folder.", "metadata": {"source": "SANS_FOR518", "title": "iCloud Accounts Links", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Accounts macOS Location: ~/Library/Application Support/iCloud/Accounts/*, ~/Library/SyncedPreferences/, ~/Library/Containers/<Bundle ID>/Data/Library/SyncedPreferences/", "metadata": {"source": "SANS_FOR518", "title": "iCloud Accounts macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "iCloud Accounts iOS FFS Location: /private/var/mobile/Containers/..., /private/var/mobile/Library/SyncedPreferences/", "metadata": {"source": "SANS_FOR518", "title": "iCloud Accounts iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "iCloud Accounts: Each application syncing with iCloud has its own plist in the SyncedPreferences folder.", "metadata": {"source": "SANS_FOR518", "title": "iCloud Accounts SyncedPreferences", "category": "dfir", "platform": "macos"}}
{"text": "macOS Firewall Configuration: The Application-Level Firewall (ALF) is turned off by default. It is one of two default firewalls on macOS systems. The second is the IP/packet filtering firewall.", "metadata": {"source": "SANS_FOR518", "title": "Firewall Description", "category": "dfir", "platform": "macos"}}
{"text": "Firewall ALF configuration Location: /Library/Preferences/com.apple.alf.plist - globalstate = 1 (firewall enabled), 0 (firewall disabled). allowsignedenabled = 1 (allow signed software to receive incoming connections). allowdownloadsignedenabled = 1 (allow downloaded signed software to receive incoming connections).", "metadata": {"source": "SANS_FOR518", "title": "Firewall ALF Settings Part 1", "category": "dfir", "platform": "macos"}}
{"text": "Firewall ALF: stealthenabled = 1 (stealth mode enabled). applications key lists apps configured in the firewall. state = 0 (incoming connections allowed), 2 (incoming connections blocked).", "metadata": {"source": "SANS_FOR518", "title": "Firewall ALF Settings Part 2", "category": "dfir", "platform": "macos"}}
{"text": "Firewall Packet filter configuration Location: /etc/pf.conf", "metadata": {"source": "SANS_FOR518", "title": "Firewall Packet Filter Location", "category": "dfir", "platform": "macos"}}
{"text": "Managed Device Profiles: Devices can be managed through enterprise Mobile Device Management systems or settings pushed to the device by an organization or carrier.", "metadata": {"source": "SANS_FOR518", "title": "MDM Profiles Description", "category": "dfir", "platform": "macos"}}
{"text": "MDM Profiles: These devices have a configuration profile installed, which outlines allowed actions and limitations. Provisioning profiles allow apps to run without being downloaded from the App Store (sideloading).", "metadata": {"source": "SANS_FOR518", "title": "MDM Profiles Features", "category": "dfir", "platform": "macos"}}
{"text": "MDM Profiles macOS Location: /private/var/db/ConfigurationProfiles/", "metadata": {"source": "SANS_FOR518", "title": "MDM Profiles macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "MDM Profiles iOS Configuration profiles Location: /private/var/mobile/Library/UserConfigurationProfiles/, /private/var/containers/Shared/SystemGroup/systemgroup.com.apple.configurationprofiles", "metadata": {"source": "SANS_FOR518", "title": "MDM iOS Config Profiles Location", "category": "dfir", "platform": "ios"}}
{"text": "MDM Profiles iOS Provisioning profiles Location: /private/var/MobileDevice/ProvisioningProfiles/", "metadata": {"source": "SANS_FOR518", "title": "MDM iOS Provisioning Location", "category": "dfir", "platform": "ios"}}
{"text": "MDM Profiles: Use 'profiles' command to extract detailed configuration. Malware and jailbreaks can use provisioning profiles, as well as legitimate MDM solutions. Look for app names, timestamps, and developer certificates.", "metadata": {"source": "SANS_FOR518", "title": "MDM Profiles Analysis", "category": "dfir", "platform": "macos"}}
{"text": "MDM Provisioning profile plist: CreationDate key is when the app was sideloaded. ExpirationDate will show to expire after seven days for a free developer account or 365 days for a paid account. ProvisioningDevices key shows UDIDs for all devices that also have this application installed.", "metadata": {"source": "SANS_FOR518", "title": "MDM Provisioning plist Fields", "category": "dfir", "platform": "ios"}}
{"text": "iOS Cellular Information: Cellular information is information associated with the device and SIM. It includes the current and historical ICCID, phone number(s), IMSI, and carrier information.", "metadata": {"source": "SANS_FOR518", "title": "Cellular Information Description", "category": "dfir", "platform": "ios"}}
{"text": "Cellular Information Location: /private/var/wireless/Library/Preferences/com.apple.commcenter.data.plist, /private/var/wireless/Library/Databases/CellularUsage.db", "metadata": {"source": "SANS_FOR518", "title": "Cellular Information Location", "category": "dfir", "platform": "ios"}}
{"text": "Cellular Information: Timestamps may not necessarily reflect expected SIM usage. CarrierBundleName can be used to map carrier ID to name. Note the esim key is set to 1 when the device uses an eSIM instead of a physical SIM.", "metadata": {"source": "SANS_FOR518", "title": "Cellular Information Notes", "category": "dfir", "platform": "ios"}}
{"text": "macOS System Boot, Reboot, and Shutdown: When the system boots up and is shut down is recorded within log files.", "metadata": {"source": "SANS_FOR518", "title": "System Boot Description", "category": "dfir", "platform": "macos"}}
{"text": "System Boot Location: System log - Search for 'BOOT_TIME' and 'SHUTDOWN_TIME' - these entries include an associated Unix Epoch timestamp. Unified logs - Messages associated with SessionAgentNotificationCenter show user-initiated actions relating to system shutdown and restart events.", "metadata": {"source": "SANS_FOR518", "title": "System Boot Location", "category": "dfir", "platform": "macos"}}
{"text": "System Boot: Search for 'halt' for shutdown events and 'reboot' for reboot events.", "metadata": {"source": "SANS_FOR518", "title": "System Boot Search Terms", "category": "dfir", "platform": "macos"}}
{"text": "System Boot: The system records the reason for the sleep/shutdown as 'Sleep Cause' or 'Shutdown Cause'. <0 = error, 0 = hibernation (sleep) or battery removal/power plug (shutdown), 3 = hard shutdown (power button held), 5 = normal sleep/shutdown.", "metadata": {"source": "SANS_FOR518", "title": "System Boot Shutdown Causes", "category": "dfir", "platform": "macos"}}
{"text": "Device Lock/Unlock and Plugged In - KnowledgeC: Amongst other things, the KnowledgeC database tracks when the device is locked or unlocked and when it is plugged in or power is disconnected.", "metadata": {"source": "SANS_FOR518", "title": "Device Lock KnowledgeC Description", "category": "dfir", "platform": "macos"}}
{"text": "Device Lock KnowledgeC macOS Location: ~/Library/Application Support/Knowledge/knowledgeC.db", "metadata": {"source": "SANS_FOR518", "title": "Device Lock macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Device Lock KnowledgeC iOS FFS Location: /private/var/mobile/Library/CoreDuet/knowledgeC.db", "metadata": {"source": "SANS_FOR518", "title": "Device Lock iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Device Lock KnowledgeC: Stores approximately four weeks of data. /device/isLocked stream keeps track of when a device is locked and unlocked. Use APOLLO knowledge_device_locked module.", "metadata": {"source": "SANS_FOR518", "title": "Device Lock isLocked Stream", "category": "dfir", "platform": "macos"}}
{"text": "Device Lock KnowledgeC: /device/isPluggedIn stream keeps track of power connection and disconnection events. Use APOLLO knowledge_device_pluggedin module.", "metadata": {"source": "SANS_FOR518", "title": "Device Lock isPluggedIn Stream", "category": "dfir", "platform": "macos"}}
{"text": "Battery Levels - CurrentPowerlog: CurrentPowerlog keeps track of the device's battery status and whether it is charging.", "metadata": {"source": "SANS_FOR518", "title": "Battery Levels Description", "category": "dfir", "platform": "macos"}}
{"text": "Battery Levels macOS Location: /private/var/db/powerlog/Library/BatteryLife/CurrentPowerlog.PLSQL", "metadata": {"source": "SANS_FOR518", "title": "Battery Levels macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Battery Levels iOS FFS Location: /private/var/Containers/Shared/SystemGroup/<GUID>/Library/BatteryLife/CurrentPowerlog.PLSQL", "metadata": {"source": "SANS_FOR518", "title": "Battery Levels iOS FFS Location", "category": "dfir", "platform": "ios"}}
{"text": "Battery Levels iOS Sysdiagnose Location: /logs/powerlogs/CurrentPowerlog.PLSQL", "metadata": {"source": "SANS_FOR518", "title": "Battery Levels Sysdiagnose Location", "category": "dfir", "platform": "ios"}}
{"text": "Battery Levels: It stores approximately three days of data. Be wary of timestamps in this log - some, but not all, have an offset. Archived databases may also be present in the Archives directory. Use APOLLO powerlog_battery_level module to extract battery information.", "metadata": {"source": "SANS_FOR518", "title": "Battery Levels Notes", "category": "dfir", "platform": "macos"}}
{"text": "macOS Installed Printers and Print Jobs: This shows the printers and scanners that are installed on the system and their configurations.", "metadata": {"source": "SANS_FOR518", "title": "Printers Description", "category": "dfir", "platform": "macos"}}
{"text": "Printers Location: /Library/Preferences/org.cups.printers.plist - Each Item key refers to an installed printer. /etc/cups/ppd/*.ppd - One file per printer; contains capabilities such as page size, resolution, and color.", "metadata": {"source": "SANS_FOR518", "title": "Printers Location", "category": "dfir", "platform": "macos"}}
{"text": "Print Jobs: /private/var/spool/cups/c##### - Print job control files containing metadata about a print job with ID corresponding to the filename. Persistent files.", "metadata": {"source": "SANS_FOR518", "title": "Print Jobs Control Files", "category": "dfir", "platform": "macos"}}
{"text": "Print Jobs: /private/var/spool/cups/d#####-### - Print job PDF data files are named in line with corresponding control file. Non-persistent files should be removed immediately after the print job completes, unless job is cancelled or an error occurred.", "metadata": {"source": "SANS_FOR518", "title": "Print Jobs Data Files", "category": "dfir", "platform": "macos"}}
{"text": "Printers: Clues in device-uri such as dnssd or tcp.local indicate a network-connected printer (as opposed to a cable). Print job control files include which printer was used, the originating user account, job name, and application used.", "metadata": {"source": "SANS_FOR518", "title": "Printers Analysis", "category": "dfir", "platform": "macos"}}
{"text": "macOS Screen Sharing and Remote Login Preferences: These are settings for items that can be shared, including screen sharing and remote access to the system.", "metadata": {"source": "SANS_FOR518", "title": "Screen Sharing Description", "category": "dfir", "platform": "macos"}}
{"text": "Screen Sharing Preferences Location: /private/var/db/com.apple.xpc.launchd/disabled*plist, /Library/Preferences/com.apple.RemoteManagement.plist - Created when screen sharing or remote management options are enabled.", "metadata": {"source": "SANS_FOR518", "title": "Screen Sharing Preferences Location", "category": "dfir", "platform": "macos"}}
{"text": "Screen Sharing VNC Password: /Library/Preferences/com.apple.VNCSettings.txt - Contains the XOR'ed password to access the system via VNC.", "metadata": {"source": "SANS_FOR518", "title": "Screen Sharing VNC Password", "category": "dfir", "platform": "macos"}}
{"text": "VNC Password Decode: Use the Perl script created by Ben Low to decode: cat com.apple.VNCSettings.txt | perl -wne 'BEGIN { @k = unpack \"C*\", pack \"H*\", \"1734516E8BA8C5E2FF1C39567390ADCA\"}; chomp; @p = unpack \"C*\", pack \"H*\", $_; foreach (@k) { printf \"%c\", $_ ^ (shift @p || 0) }; print \"\\n\"'", "metadata": {"source": "SANS_FOR518", "title": "VNC Password Decode Script", "category": "dfir", "platform": "macos"}}
{"text": "Screen Sharing events: Search Unified Logs for 'screensharingd'.", "metadata": {"source": "SANS_FOR518", "title": "Screen Sharing Events", "category": "dfir", "platform": "macos"}}
{"text": "Screen Sharing disabled.plist: By default, none of these settings are enabled. com.apple.screensharing = NO (0) - Screen sharing is enabled. com.openssh.sshd = NO (0) - Remote Login is enabled. If the bundle ID for a service does not appear in the list, it was likely never enabled.", "metadata": {"source": "SANS_FOR518", "title": "Screen Sharing disabled.plist", "category": "dfir", "platform": "macos"}}
{"text": "Keychains: The keychains on a system are used to store sensitive data such as usernames, passwords, and encryption keys.", "metadata": {"source": "SANS_FOR518", "title": "Keychains Description", "category": "dfir", "platform": "macos"}}
{"text": "Keychains macOS Location: ~/Library/Keychains/login.keychain-db, iCloud: ~/Library/Keychains/<Hardware UUID>/keychain-2.db, /Library/Keychains/System.keychain", "metadata": {"source": "SANS_FOR518", "title": "Keychains macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Keychains iOS FFS Location: /private/var/Keychains/keychain-2.db", "metadata": {"source": "SANS_FOR518", "title": "Keychains iOS FFS Location", "category": "dfir", "platform": "ios"}}
{"text": "Keychains iOS encrypted backup Location: Keychain*/keychain-backup.plist", "metadata": {"source": "SANS_FOR518", "title": "Keychains iOS Backup Location", "category": "dfir", "platform": "ios"}}
{"text": "Keychains: login.keychain-db may contain user passwords for access points, Time Machine, applications, and websites. Default login.keychain-db password is the user's account password.", "metadata": {"source": "SANS_FOR518", "title": "Keychains login.keychain", "category": "dfir", "platform": "macos"}}
{"text": "Keychains: System.keychain contains passwords for VPNs, access points, Time Machine, and applications. iCloud keychain-2.db may contain information from other iDevices.", "metadata": {"source": "SANS_FOR518", "title": "Keychains System.keychain", "category": "dfir", "platform": "macos"}}
{"text": "Keychains: On iOS backups, the keychain may be stored in a Keychains or KeychainDomain folder, depending on the acquisition tool used. iCloud keychain items are not specifically backed up in this plist file.", "metadata": {"source": "SANS_FOR518", "title": "Keychains iOS Backup Notes", "category": "dfir", "platform": "ios"}}
{"text": "Keychains: View a keychain file using the Keychain Access.app macOS application or using the strings or security commands if the keychain is not encrypted.", "metadata": {"source": "SANS_FOR518", "title": "Keychains Viewing", "category": "dfir", "platform": "macos"}}
{"text": "Accounts Configured on the System: A user can configure accounts on the system, such as email, calendar, and iCloud.", "metadata": {"source": "SANS_FOR518", "title": "Configured Accounts Description", "category": "dfir", "platform": "macos"}}
{"text": "Configured Accounts macOS Location: ~/Library/Accounts/Accounts4.sqlite, /Library/Preferences/SystemConfiguration/com.apple.accounts.exists.plist", "metadata": {"source": "SANS_FOR518", "title": "Configured Accounts macOS Location", "category": "dfir", "platform": "macos"}}
{"text": "Configured Accounts iOS Location: /private/var/mobile/Library/Accounts/Accounts3.sqlite, /private/var/Preferences/SystemConfiguration/com.apple.accounts.exists.plist", "metadata": {"source": "SANS_FOR518", "title": "Configured Accounts iOS Location", "category": "dfir", "platform": "ios"}}
{"text": "Configured Accounts: ZACCOUNT table in the sqlite databases contains account information. ZUSERNAME is the account username. ZACCOUNTTYPEDESCRIPTION is the account type description. ZDATE is the account setup date in Mac Epoch format.", "metadata": {"source": "SANS_FOR518", "title": "Configured Accounts Database Fields Part 1", "category": "dfir", "platform": "macos"}}
{"text": "Configured Accounts: ZKEY is the configuration key name. ZVALUE is the configuration value, as a BLOB that contains a binary plist.", "metadata": {"source": "SANS_FOR518", "title": "Configured Accounts Database Fields Part 2", "category": "dfir", "platform": "macos"}}
{"text": "Configured Accounts: com.apple.accounts.exists.plist file has two associated keys per account: Exists shows if the account is in use. Count shows how many of this account type there are.", "metadata": {"source": "SANS_FOR518", "title": "Configured Accounts exists.plist", "category": "dfir", "platform": "macos"}}
{"text": "iOS Apple Watch Data: If an Apple Watch is paired with an iPhone (it cannot be paired with any other iOS devices), some data will be synced with that iPhone.", "metadata": {"source": "SANS_FOR518", "title": "Apple Watch Description", "category": "dfir", "platform": "ios"}}
{"text": "Apple Watch Location: /private/var/mobile/Library/DeviceRegistry/<GUID>/*, /private/var/mobile/Library/DeviceRegistry.state/<GUID>/*", "metadata": {"source": "SANS_FOR518", "title": "Apple Watch Location", "category": "dfir", "platform": "ios"}}
{"text": "Apple Watch: historySecureProperties.plist includes device serial number, IMEI, Bluetooth MAC address, and WiFi MAC address of the device.", "metadata": {"source": "SANS_FOR518", "title": "Apple Watch historySecureProperties", "category": "dfir", "platform": "ios"}}
{"text": "Mounting APFS E01 Image (With or Without FileVault): Create mount point directories: sudo mkdir /Volumes/apfs_image/ && sudo mkdir /Volumes/apfs_mounted/", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS E01 Step 1", "category": "dfir", "platform": "macos"}}
{"text": "Mounting APFS E01: Create DMG file from E01 image: sudo xmount --in ewf apfs.E01 --out dmg /Volumes/apfs_image/", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS E01 Step 2", "category": "dfir", "platform": "macos"}}
{"text": "Mounting APFS E01: Attach the image: hdiutil attach -nomount /Volumes/apfs_image/apfs.dmg", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS E01 Step 3", "category": "dfir", "platform": "macos"}}
{"text": "Mounting APFS E01: List the disks to find the correct volume to mount: (non-FileVault disk) diskutil ap list, (FileVault disk) diskutil ap unlockVolume <Disk GUID> -nomount", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS E01 Step 4", "category": "dfir", "platform": "macos"}}
{"text": "Mounting APFS E01: Mount volume: sudo mount_apfs -o rdonly,noexec,noowners /dev/disk# /Volumes/apfs_mounted/", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS E01 Step 5", "category": "dfir", "platform": "macos"}}
{"text": "Mounting APFS Snapshot: View APFS Snapshots available for system: diskutil ap listsnapshots /System/Volumes/Data", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS Snapshot List", "category": "dfir", "platform": "macos"}}
{"text": "Mounting APFS Snapshot: Create mount point directory: sudo mkdir /Volumes/snapshot_image/. Mount snapshot: sudo mount_apfs -s snapshot.local /System/Volumes/Data /Volumes/snapshot_mounted/", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS Snapshot Mount", "category": "dfir", "platform": "macos"}}
{"text": "Mounting APFS DMG Image: Mount image: hdiutil mount apfs.dmg -shadow. Using the -shadow option redirects writes to a file instead of modifying the original image.", "metadata": {"source": "SANS_FOR518", "title": "Mount APFS DMG", "category": "dfir", "platform": "macos"}}
{"text": "Unmounting a Mounted Image: View mounted disks: diskutil list. Eject mounted disk: diskutil eject /dev/disk#. Find disk to unmount: sudo mount. Unmount disk: sudo umount /Volumes/disk_image/", "metadata": {"source": "SANS_FOR518", "title": "Unmount Image", "category": "dfir", "platform": "macos"}}
{"text": "Acquiring an Image of a Live System Using Apple System Restore (ASR): Create a DMG as large as the disk is allocated: hdiutil create -fs apfs -size <##GB> asrdisk.dmg", "metadata": {"source": "SANS_FOR518", "title": "ASR Acquisition Step 1", "category": "dfir", "platform": "macos"}}
{"text": "ASR Acquisition: Make the new DMG available to the system: sudo hdiutil attach -nomount asrdisk.dmg", "metadata": {"source": "SANS_FOR518", "title": "ASR Acquisition Step 2", "category": "dfir", "platform": "macos"}}
{"text": "ASR Acquisition: Restore the source disk to the target DMG: sudo asr restore --source /dev/disk# --target /dev/disk# --debug --erase --verbose", "metadata": {"source": "SANS_FOR518", "title": "ASR Acquisition Step 3", "category": "dfir", "platform": "macos"}}
{"text": "Parse NSKeyedArchiver plists using Deserializer: https://github.com/ydkhatri/MacForensics/blob/master/Deserializer/deserializer.py", "metadata": {"source": "SANS_FOR518", "title": "NSKeyedArchiver Deserializer Tool", "category": "dfir", "platform": "macos"}}
{"text": "APOLLO Tool: https://github.com/mac4n6/APOLLO - Used for parsing various macOS and iOS forensic artifacts including KnowledgeC, PowerLog, Health, Routined, and Bluetooth data.", "metadata": {"source": "SANS_FOR518", "title": "APOLLO Tool Reference", "category": "dfir", "platform": "macos"}}
{"text": "apple_cloud_notes_parser: https://github.com/threeplanetssoftware/apple_cloud_notes_parser - Tool for parsing Apple Notes database.", "metadata": {"source": "SANS_FOR518", "title": "Apple Notes Parser Tool", "category": "dfir", "platform": "macos"}}
{"text": "Mac Epoch: Mac Absolute Time or Cocoa Core Data timestamp. Seconds since January 1, 2001 00:00:00 UTC. Also known as WebKit time.", "metadata": {"source": "SANS_FOR518", "title": "Mac Epoch Definition", "category": "dfir", "platform": "macos"}}
{"text": "Unix Epoch: Seconds since January 1, 1970 00:00:00 UTC.", "metadata": {"source": "SANS_FOR518", "title": "Unix Epoch Definition", "category": "dfir", "platform": "macos"}}
{"text": "Poster created by Kathryn Hedley and Sarah Edwards based on many years of research and macOS and iOS knowledge by Sarah Edwards. SANS Institute 2024.", "metadata": {"source": "SANS_FOR518", "title": "Poster Attribution", "category": "dfir", "platform": "macos"}}
