{"text": "General Approach to Document Analysis: 1. Examine the document for anomalies, such as risky tags, scripts, and embedded artifacts. 2. Locate embedded code, such as shellcode, macros, JavaScript, or other suspicious objects. 3. Extract suspicious code or objects from the file. 4. If relevant, deobfuscate and examine macros, JavaScript, or other embedded code. 5. If relevant, emulate, disassemble and/or debug shellcode that you extracted from the document. 6. Understand the next steps in the infection chain.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Analyzing Malicious Documents", "category": "dfir", "platform": "windows"}}
{"text": "Binary Microsoft Office document files (.doc, .xls, etc.) use the OLE2 (a.k.a. Structured Storage) format.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Microsoft Office Format Notes", "category": "dfir", "platform": "windows"}}
{"text": "SRP streams in OLE2 documents sometimes store a cached version of earlier VBA macro code.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Microsoft Office Format Notes", "category": "dfir", "platform": "windows"}}
{"text": "OOXML document files (.docx, .xlsm, etc.) supported by Microsoft Office are compressed zip archives.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Microsoft Office Format Notes", "category": "dfir", "platform": "windows"}}
{"text": "VBA macros in OOXML documents are stored inside an OLE2 binary file, which is within the zip archive.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Microsoft Office Format Notes", "category": "dfir", "platform": "windows"}}
{"text": "Excel supports XLM macros that are embedded as formulas in sheets without the OLE2 binary file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Microsoft Office Format Notes", "category": "dfir", "platform": "windows"}}
{"text": "RTF documents don't support macros but can contain malicious embedded files and objects.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Microsoft Office Format Notes", "category": "dfir", "platform": "windows"}}
{"text": "zipdump.py file.pptx - Examine contents of OOXML file file.pptx.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "zipdump.py file.pptx -s 3 -d - Extract file with index 3 from file.pptx to STDOUT.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "olevba.py file.xlsm - Locate and extract macros from file.xlsm.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "oledump.py file.xls -s 3 -v - Extract VBA source code from stream 3 in file.xls.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "xmldump.py pretty - Format XML file supplied via STDIN for easier analysis.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "oledump.py file.xls -p plugin_http_heuristics - Find obfuscated URLs in file.xls macros.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "vmonkey file.doc - Emulate the execution of macros in file.doc to analyze them.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "evilclippy -uu file.ppt - Remove the password prompt from macros in file.ppt.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "msoffcrypto-tool infile.docm outfile.docm -p - Decrypt outfile.docm using specified password to create outfile.docm.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "pcodedmp file.doc - Disassemble VBA-stomped p-code macro from file.doc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "pcode2code file.doc - Decompile VBA-stomped p-code macro from file.doc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "rtfobj.py file.rtf - Extract objects embedded into RTF file.rtf.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "rtfdump.py file.rtf - List groups and structure of RTF file file.rtf.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "rtfdump.py file.rtf -O - Examine objects in RTF file file.rtf.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "xlmdeobfuscator --file file.xlsm - Deobfuscate XLM (Excel 4) macros in file.xlsm.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful MS Office File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "Risky PDF Keywords: /OpenAction and /AA specify the script or action to run automatically.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Risky PDF Keywords", "category": "dfir", "platform": "windows"}}
{"text": "Risky PDF Keywords: /JavaScript, /JS, /AcroForm, and /XFA can specify JavaScript to run.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Risky PDF Keywords", "category": "dfir", "platform": "windows"}}
{"text": "Risky PDF Keywords: /URI accesses a URL, perhaps for phishing.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Risky PDF Keywords", "category": "dfir", "platform": "windows"}}
{"text": "Risky PDF Keywords: /SubmitForm and /GoToR can send data to URL.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Risky PDF Keywords", "category": "dfir", "platform": "windows"}}
{"text": "Risky PDF Keywords: /ObjStm can hide objects inside an object stream.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Risky PDF Keywords", "category": "dfir", "platform": "windows"}}
{"text": "Risky PDF Keywords: /XObject can embed an image for phishing.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Risky PDF Keywords", "category": "dfir", "platform": "windows"}}
{"text": "Be mindful of obfuscation with hex codes, such as /JavaScript vs. /J#61vaScript.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Risky PDF Keywords", "category": "dfir", "platform": "windows"}}
{"text": "pdfid.py file.pdf -n - Display risky keywords present in file file.pdf.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful PDF File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "pdf-parser.py file.pdf -a - Show stats about keywords. Add \"-O\" to include object streams.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful PDF File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "pdf-parser.py file.pdf -o id - Display contents of object id. Add \"-d\" to dump object's stream.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful PDF File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "pdf-parser.py file.pdf -r id - Display objects that reference object id.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful PDF File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "qpdf --password=pass --decrypt infile.pdf outfile.pdf - Decrypt infile.pdf using password pass to create outfile.pdf.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Useful PDF File Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "xorsearch -W -d 3 file.bin - Locate shellcode patterns inside the binary file file.bin.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Shellcode and Other Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "scdbg /f file.bin - Emulate execution of shellcode in file.bin. Use \"/off\" to specify offset.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Shellcode and Other Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "runsc32 -f file.bin -n - Execute shellcode in file file.bin to observe behavior in an isolated lab.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Shellcode and Other Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "base64dump.py file.txt - List Base64-encoded strings present in file file.txt.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Shellcode and Other Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "numbers-to-string.py file - Convert numbers that represent characters in file to a string.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Shellcode and Other Analysis Commands", "category": "dfir", "platform": "windows"}}
{"text": "SpiderMonkey, cscript, and box-js help deobfuscate JavaScript that you extract from document files.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Document Analysis Tools", "category": "dfir", "platform": "windows"}}
{"text": "Use the debugger built into Microsoft Office to deobfuscate macros in an isolated lab.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Document Analysis Tools", "category": "dfir", "platform": "windows"}}
{"text": "Use AMSIScriptContentRetrieval.ps1 to observe Microsoft Office execute macros in an isolated lab.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Document Analysis Tools", "category": "dfir", "platform": "windows"}}
{"text": "Some automated analysis sandboxes can analyze aspects of malicious document files.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Document Analysis Tools", "category": "dfir", "platform": "windows"}}
{"text": "REMnux distro includes many of the free document analysis tools mentioned above.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Document Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Getting Started with REMnux: 1. Get REMnux as a virtual appliance, install the distro on a dedicated system, or add it to an existing one. 2. Review REMnux documentation at docs.remnux.org. 3. Keep your system up to date by periodically running \"remnux upgrade\" and \"remnux update\". 4. Become familiar with REMnux malware analysis tools available as Docker images. 5. Know default logon credentials: remnux/malware", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Usage Tips", "category": "dfir", "platform": "linux"}}
{"text": "shutdown - Shut down the system", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "reboot - Reboot the system", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "sudo -s - Switch to a root shell", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "renew-dhcp - Renew DHCP lease", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "myip - See current IP address", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "code file - Edit a text file", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "feh file - View an image file", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "httpd start - Start web server", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "sshd start - Start SSH server", "metadata": {"source": "SANS_DFIR_Booklet", "title": "General Commands on REMnux", "category": "dfir", "platform": "linux"}}
{"text": "Analyze Windows Executables - Static Properties: manalyze, peframe, pefile, exiftool, clamscan, pescan, portex, bearcommander, pecheck", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Analyze Windows Executables - Strings and Deobfuscation: pestr, bbcrack, brxor.py, base64dump, xorsearch, flarestrings, floss, cyberchef", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Analyze Windows Executables - Code Emulation: binee, capa, vivbin", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Analyze Windows Executables - Disassemble/Decompile: ghidra, cutter, objdump, r2", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Analyze Windows Executables - Unpacking: bytehist, de4dot, upx", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Reverse-Engineer Linux Binaries - Static Properties: trid, exiftool, pyew, readelf.py", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Reverse-Engineer Linux Binaries - Disassemble/Decompile: ghidra, cutter, objdump, r2", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Reverse-Engineer Linux Binaries - Debugging: edb, gdb", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Reverse-Engineer Linux Binaries - Behavior Analysis: ltrace, strace, frida, sysdig, unhide", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - Android: apktool, droidlysis, androgui.py, baksmali, dex2jar", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - Java: cfr, procyon, jad, jd-gui, idx_parser.py", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - Python: pyinstxtractor.py, pycdc", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - JavaScript: js, js-file, objects.js, box-js", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - Shellcode: shellcode2exe.bat, scdbg, xorsearch", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - PowerShell: pwsh, base64dump", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - Flash: swfdump, flare, flasm, swf_mastah.py, xxxswf", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Examine Suspicious Documents - Microsoft Office Files: vmonkey, pcodedmp, olevba, xlmdeobfuscator, oledump.py, msoffice-crypt, ssview", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Examine Suspicious Documents - RTF Files: rtfobj, rtfdump", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Examine Suspicious Documents - Email Messages: emldump, msgconvert", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Examine Suspicious Documents - PDF Files: pdfid, pdfparser, pdfextract, pdfdecrypt, peepdf, pdftk, pdfresurrect, qpdf, pdfobjflow", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Examine Suspicious Documents - General: base64dump, tesseract, exiftool", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Explore Network Interactions - Monitoring: burpsuite, networkminer, polarproxy, mitmproxy, wireshark, tshark, ngrep, tcpxtract", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Explore Network Interactions - Connecting: thug, nc, tor, wget, curl, irc, ssh, unfurl", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Explore Network Interactions - Services: fakedns, fakemail, accept-all-ips, nc, httpd, inetsim, fakenet, sshd, myip", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Gather and Analyze Data - Network: Automater.py, shodan, ipwhois_cli.py, pdnstool", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Gather and Analyze Data - Hashes: malwoverview.py, nsrllookup, Automater.py, vt, virustotal-search.py", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Gather and Analyze Data - Files: yara, scalpel, bulk_extractor, ioc_writer", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Gather and Analyze Data - Other: dexray, viper, time-decode.py", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Other Analysis Tasks - Memory Forensics: vol.py, vol3, linux_mem_diff.py, aeskeyfind, rsakeyfind, bulk_extractor", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Other Analysis Tasks - File Editing: wxHexEditor, scite, code, xpdf, convert", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Other Analysis Tasks - File Extraction: 7z, unzip, unrar, cabextract", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Malware Analysis Tools", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Thug Honeyclient: remnux/thug", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - JSDetox JavaScript Analysis: remnux/jsdetox", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Rekall Memory Forensics: remnux/recall", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - RetDec Decompiler: remnux/retdec", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Radare2 Reversing Framework: remnux/radare2", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Ciphey Automatic Decrypter: remnux/ciphey", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Viper Binary Analysis Framework: remnux/viper", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - REMnux in a Container: remnux/remnux-distro", "metadata": {"source": "SANS_DFIR_Booklet", "title": "REMnux Docker Containers", "category": "dfir", "platform": "linux"}}
{"text": "docker images - List local images", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Interact with Docker Images", "category": "dfir", "platform": "linux"}}
{"text": "docker pull image - Update local image", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Interact with Docker Images", "category": "dfir", "platform": "linux"}}
{"text": "docker rmi imageid - Delete local image", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Interact with Docker Images", "category": "dfir", "platform": "linux"}}
{"text": "docker system prune - Delete unused resources", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Interact with Docker Images", "category": "dfir", "platform": "linux"}}
{"text": "docker run --rm -it image bash - Open a shell inside a transient container", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Interact with Docker Images", "category": "dfir", "platform": "linux"}}
{"text": "docker run --rm -it -p 80:80 image bash - Map a local TCP port 80 to container's port 80", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Interact with Docker Images", "category": "dfir", "platform": "linux"}}
{"text": "docker run --rm -it -v .:dir image bash - Map your current directory into container", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Interact with Docker Images", "category": "dfir", "platform": "linux"}}
{"text": "Overview of the Code Analysis Process: 1. Examine static properties of the Windows executable for initial assessment and triage. 2. Identify strings and API calls that highlight the program's suspicious or malicious capabilities. 3. Perform automated and manual behavioral analysis to gather additional details. 4. Emulate code execution to identify characteristics and areas for further analysis. 5. Use a disassembler and decompiler to statically examine code related to risky strings and APIs. 6. Use a debugger for dynamic analysis to examine how risky strings and API calls are used. 7. If appropriate, unpack the code and its artifacts. 8. As your understanding of the code increases, add comments, labels; rename functions, variables. 9. Progress to examine the code that references or depends upon the code you've already analyzed. 10. Repeat steps 5-9 above as necessary (the order may vary) until analysis objectives are met.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Tips for Reverse-Engineering Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "EAX - Addition, multiplication, function results", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common 32-Bit Registers and Uses", "category": "dfir", "platform": "windows"}}
{"text": "ECX - Counter; used by LOOP and others", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common 32-Bit Registers and Uses", "category": "dfir", "platform": "windows"}}
{"text": "EBP - Baseline/frame pointer for referencing function arguments (EBP+value) and local variables (EBP-value)", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common 32-Bit Registers and Uses", "category": "dfir", "platform": "windows"}}
{"text": "ESP - Points to the current \"top\" of the stack; changes via PUSH, POP, and others", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common 32-Bit Registers and Uses", "category": "dfir", "platform": "windows"}}
{"text": "EIP - Instruction pointer; points to the next instruction; shellcode gets it via call/pop", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common 32-Bit Registers and Uses", "category": "dfir", "platform": "windows"}}
{"text": "EFLAGS - Contains flags that store outcomes of computations (e.g., Zero and Carry flags)", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common 32-Bit Registers and Uses", "category": "dfir", "platform": "windows"}}
{"text": "FS - F segment register; FS[0] points to SEH chain, FS[0x30] points to the PEB.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common 32-Bit Registers and Uses", "category": "dfir", "platform": "windows"}}
{"text": "mov EAX,0xB8 - Put the value 0xB8 in EAX.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "push EAX - Put EAX contents on the stack.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "pop EAX - Remove contents from top of the stack and put them in EAX.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "lea EAX, [EBP-4] - Put the address of variable EBP-4 in EAX.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "call EAX - Call the function whose address resides in the EAX register.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "add esp,8 - Increase ESP by 8 to shrink the stack by two 4-byte arguments.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "sub esp,0x54 - Shift ESP by 0x54 to make room on the stack for local variable(s).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "xor EAX,EAX - Set EAX contents to zero.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "test EAX,EAX - Check whether EAX contains zero, set the appropriate EFLAGS bits.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "cmp EAX,0xB8 - Compare EAX to 0xB8, set the appropriate EFLAGS bits.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Common x86 Assembly Instructions", "category": "dfir", "platform": "windows"}}
{"text": "Understanding 64-Bit Registers: EAX->RAX, ECX->RCX, EBX->RBX, ESP->RSP, EIP->RIP. Additional 64-bit registers are R8-R15. RSP is often used to access stack arguments and local variables, instead of EBP.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Understanding 64-Bit Registers", "category": "dfir", "platform": "windows"}}
{"text": "Passing Parameters to Functions: arg0 [EBP+8] on 32-bit, RCX on 64-bit. arg1 [EBP+0xC] on 32-bit, RDX on 64-bit. arg2 [EBP+0x10] on 32-bit, R8 on 64-bit. arg3 [EBP+0x14] on 32-bit, R9 on 64-bit.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Passing Parameters to Functions", "category": "dfir", "platform": "windows"}}
{"text": "JA / JG - Jump if above/jump if greater.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Decoding Conditional Jumps", "category": "dfir", "platform": "windows"}}
{"text": "JB / JL - Jump if below/jump if less.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Decoding Conditional Jumps", "category": "dfir", "platform": "windows"}}
{"text": "JE / JZ - Jump if equal; same as jump if zero.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Decoding Conditional Jumps", "category": "dfir", "platform": "windows"}}
{"text": "JNE / JNZ - Jump if not equal; same as jump if not zero.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Decoding Conditional Jumps", "category": "dfir", "platform": "windows"}}
{"text": "JGE / JNL - Jump if greater or equal; same as jump if not less.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Decoding Conditional Jumps", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Code injection: CreateRemoteThread, OpenProcess, VirtualAllocEx, WriteProcessMemory, EnumProcesses", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Dynamic DLL loading: LoadLibrary, GetProcAddress", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Memory scraping: CreateToolhelp32Snapshot, OpenProcess, ReadProcessMemory, EnumProcesses", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Data stealing: GetClipboardData, GetWindowText", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Keylogging: GetAsyncKeyState, SetWindowsHookEx", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Embedded resources: FindResource, LockResource", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Unpacking/self-injection: VirtualAlloc, VirtualProtect", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Query artifacts: CreateMutex, CreateFile, FindWindow, GetModuleHandle, RegOpenKeyEx", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Execute a program: WinExec, ShellExecute, CreateProcess", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Risky Windows API Calls - Web interactions: InternetOpen, HttpOpenRequest, HttpSendRequest, InternetReadFile", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Some Risky Windows API Calls", "category": "dfir", "platform": "windows"}}
{"text": "Be patient but persistent; focus on small, manageable code areas and expand from there.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Code Analysis Tips", "category": "dfir", "platform": "windows"}}
{"text": "Use dynamic code analysis (debugging) for code that's too difficult to understand statically.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Code Analysis Tips", "category": "dfir", "platform": "windows"}}
{"text": "Look at jumps and calls to assess how the specimen flows from \"interesting\" code block to the other.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Code Analysis Tips", "category": "dfir", "platform": "windows"}}
{"text": "If code analysis is taking too long, consider whether behavioral or memory analysis will achieve the goals.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Code Analysis Tips", "category": "dfir", "platform": "windows"}}
{"text": "When looking for API calls, know the official API names and the associated native APIs (Nt, Zw, Rtl).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Additional Code Analysis Tips", "category": "dfir", "platform": "windows"}}
{"text": "Overview of the Malware Analysis Process: 1. Use automated analysis sandbox tools for an initial assessment of the suspicious file. 2. Set up a controlled, isolated laboratory in which to examine the malware specimen. 3. Examine static properties and meta-data of the specimen for triage and early theories. 4. Emulate code execution to identify malicious capabilities and contemplate next steps. 5. Perform behavioral analysis to examine the specimen's interactions with its environment. 6. Analyze relevant aspects of the code statically with a disassembler and decompiler. 7. Perform dynamic code analysis to understand the more difficult aspects of the code. 8. If necessary, unpack the specimen. 9. Repeat steps 4-8 above as necessary (the order may vary) until analysis objectives are met. 10. Augment your analysis using other methods, such as memory forensics and threat intel. 11. Document findings, save analysis artifacts and clean up the laboratory for future analysis.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Malware Analysis Process Overview", "category": "dfir", "platform": "windows"}}
{"text": "Be ready to revert to good state via virtualization snapshots, Clonezilla, dd, FOG, PXE booting, etc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Behavioral Analysis", "category": "dfir", "platform": "windows"}}
{"text": "Monitor local interactions (Process Explorer, Process Monitor, ProcDOT, Noriben).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Behavioral Analysis", "category": "dfir", "platform": "windows"}}
{"text": "Detect major local changes (RegShot, Autoruns).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Behavioral Analysis", "category": "dfir", "platform": "windows"}}
{"text": "Monitor network interactions (Wireshark, Fiddler).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Behavioral Analysis", "category": "dfir", "platform": "windows"}}
{"text": "Redirect network traffic (fakedns, accept-all-ips).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Behavioral Analysis", "category": "dfir", "platform": "windows"}}
{"text": "Activate services (INetSim or actual services) requested by malware and reinfect the system.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Behavioral Analysis", "category": "dfir", "platform": "windows"}}
{"text": "Adjust the runtime environment for the specimen as it requests additional local or network resources.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Behavioral Analysis", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - g: Go to specific destination", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - Ctrl+Shift+f: Show references to instruction", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - ;: Insert a comment", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - Enter: Follow jump or call", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - Alt+Left: Return to previous location", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - Alt+Right: Go to next location", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - Ctrl+z: Undo", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - t: Define data type", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - Ctrl+d: Add a bookmark", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - Ctrl+Shift+e: Text search", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - l: Add or edit a label", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis - d: Disassemble values", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Ghidra Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - F9: Run the code", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - F7/F8: Step into/over instruction", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - F4: Execute until selected instruction", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Ctrl+F9: Execute until the next return", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - -/+: Show previous/next executed instruction", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - *: Return to previous view", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Ctrl+g: Go to specific expression", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - ;/:: Insert comment/label", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - g: Show current function as a graph", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Ctrl+b: Find specific pattern", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Select instruction then F2: Set software breakpoint on specific instruction", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Go to Command prompt then SetBPX API Name: Set software breakpoint on API", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - h then Click on keyword in disassembler: Highlight all occurrences of the keyword", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Select instruction then Spacebar: Assemble instruction in place of selected one", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Select data or instruction then Ctrl+e: Edit data in memory or instruction opcode", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis - Right-click in disassembler, Search for, Current module, Intermodular calls: Extract API call references", "metadata": {"source": "SANS_DFIR_Booklet", "title": "x64dbg Keyboard Shortcuts", "category": "dfir", "platform": "windows"}}
{"text": "Determine whether the specimen is packed by using Detect It Easy, Exeinfo PE, Bytehist, peframe, etc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "To try unpacking the specimen quickly, infect the lab system and dump from memory using Scylla.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "For more precision, find the Original Entry Point (OEP) in a debugger and dump with OllyDumpEx.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "To find the OEP, anticipate the condition close to the end of the unpacker and set the breakpoint.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "Try setting a memory breakpoint on the stack in the unpacker's beginning to catch it during cleanup.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "To get closer to the OEP, set breakpoints on APIs such as LoadLibrary, VirtualAlloc, etc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "To intercept process injection set breakpoints on VirtualAllocEx, WriteProcessMemory, etc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "If cannot dump cleanly, examine the packed specimen via dynamic code analysis while it runs.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "Rebuild imports and other aspects of the dumped file using Scylla, Imports Fixer, and pe_unmapper.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Unpacking Malicious Code", "category": "dfir", "platform": "windows"}}
{"text": "Decode obfuscated strings statically using FLOSS, xorsearch, Balbuzard, etc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Bypassing Other Analysis Defenses", "category": "dfir", "platform": "windows"}}
{"text": "Decode data in a debugger by setting a breakpoint after the decoding function and examining results.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Bypassing Other Analysis Defenses", "category": "dfir", "platform": "windows"}}
{"text": "Conceal x64dbg/x32dbg via the ScyllaHide plugin.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Bypassing Other Analysis Defenses", "category": "dfir", "platform": "windows"}}
{"text": "To disable anti-analysis functionality, locate and patch the defensive code using a debugger.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Bypassing Other Analysis Defenses", "category": "dfir", "platform": "windows"}}
{"text": "Look out for tricky jumps via TLS, SEH, RET, CALL, etc. when stepping through the code in a debugger.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Bypassing Other Analysis Defenses", "category": "dfir", "platform": "windows"}}
{"text": "If analyzing shellcode, use scdbg and runsc.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Bypassing Other Analysis Defenses", "category": "dfir", "platform": "windows"}}
{"text": "Disable ASLR via setdllcharacteristics, CFF Explorer.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Bypassing Other Analysis Defenses", "category": "dfir", "platform": "windows"}}
{"text": "APFS is Little Endian & 64-bit.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "Apple File System APFS Reference Sheet", "category": "dfir", "platform": "macos"}}
{"text": "Object Header (obj_phys_t): Offset 0, Size 8 bytes, Field o_cksum - Fletcher 64 Checksum.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Header", "category": "dfir", "platform": "macos"}}
{"text": "Object Header (obj_phys_t): Offset 8, Size 8 bytes, Field o_oid - Object ID.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Header", "category": "dfir", "platform": "macos"}}
{"text": "Object Header (obj_phys_t): Offset 16, Size 8 bytes, Field o_xid - Transaction ID.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Header", "category": "dfir", "platform": "macos"}}
{"text": "Object Header (obj_phys_t): Offset 24, Size 2 bytes, Field o_type.type - Object Type.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Header", "category": "dfir", "platform": "macos"}}
{"text": "Object Header (obj_phys_t): Offset 26, Size 2 bytes, Field o_type.flags - Object Flags.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Header", "category": "dfir", "platform": "macos"}}
{"text": "Object Header (obj_phys_t): Offset 28, Size 4 bytes, Field o_subtype - Object Subtype.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Header", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0000 (0) = None.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0100 (1) = Container Super Block.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0200 (2) = B-Tree.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0300 (3) = B-Tree Node.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0500 (5) = Spaceman.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0B00 (11) = Object Map (OMAP).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0D00 (13) = File System (Volume Super Block).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Object Type 0x0E00 (14) = File System Tree.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Object Types", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block magic \"NXSB\" = 0x4E585342.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block: Offset 36, Size 4 bytes, Field nx_block_size - Block Size (ie: 4096).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block: Offset 40, Size 8 bytes, Field nx_block_count - Block Count (Block Count*Block Size = Container Size in Bytes).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block: Offset 72, Size 16 bytes, Field nx_uuid - Container UUID (diskutil info /dev/disk#).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block: Offset 152, Size 8 bytes, Field nx_spaceman_oid - Space Manager Object ID (OID).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block: Offset 160, Size 8 bytes, Field nx_omap_oid - Container Object Map Object ID (OID).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block: Offset 180, Size 4 bytes, Field nx_max_file_systems - Maximum Number of Volumes in this Container.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Container Super Block: Offset 184, Size 8 bytes, Field nx_fs_oid[0] - Array of OIDs for Volumes in this Container.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Container Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block magic \"APSB\" = 0x41505342.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 64, Size 8 bytes, Field apfs_unmount_time - Timestamp when volume was last unmounted.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 136, Size 8 bytes, Field apfs_root_tree_oid - Virtual Object ID (OID) of Root File System Tree.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 176, Size 8 bytes, Field apfs_next_obj_id - Next Object ID (OID).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 184, Size 8 bytes, Field apfs_num_files - Number of Regular Files.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 192, Size 8 bytes, Field apfs_num_directories - Number of Directories.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 200, Size 8 bytes, Field apfs_num_symlinks - Number of Symbolic Links.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 216, Size 8 bytes, Field apfs_num_snapshots - Number of Snapshots.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 240, Size 16 bytes, Field apfs_vol_uuid - Volume UUID (diskutil info /dev/disk#s# [Volume]).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 256, Size 8 bytes, Field apfs_last_mod_time - Last Modified Timestamp.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 704, Size 256 bytes, Field apfs_volname - APFS Volume Name.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "Volume Super Block: Offset 964, Size 2 bytes, Field apfs_role - APFS Role (None, System, Data, Preboot, VM, Recovery).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Volume Super Block", "category": "dfir", "platform": "macos"}}
{"text": "B-Tree Node (btree_node_phys_t): Offset 32, Size 2 bytes, Field btn_flags - Flags (Leaf Node).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS B-Tree Node", "category": "dfir", "platform": "macos"}}
{"text": "B-Tree Node (btree_node_phys_t): Offset 34, Size 2 bytes, Field btn_level - Number of Child Levels below this Node.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS B-Tree Node", "category": "dfir", "platform": "macos"}}
{"text": "B-Tree Node (btree_node_phys_t): Offset 36, Size 4 bytes, Field btn_nkeys - Number of Keys.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS B-Tree Node", "category": "dfir", "platform": "macos"}}
{"text": "B-Tree Node File System Key: Entry Kind 0x30 = Inode.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS B-Tree Node File System Key", "category": "dfir", "platform": "macos"}}
{"text": "B-Tree Node File System Key: Entry Kind 0x60 = Data Stream.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS B-Tree Node File System Key", "category": "dfir", "platform": "macos"}}
{"text": "B-Tree Node File System Key: Entry Kind 0x40 = Xattr (2 byte Name Length + Variable Xattr Name).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS B-Tree Node File System Key", "category": "dfir", "platform": "macos"}}
{"text": "B-Tree Node File System Key: Entry Kind 0x60 = File Extent (8 byte Logical Address).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS B-Tree Node File System Key", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 0, Size 8 bytes, Field parent_id - Parent Inode Number.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 8, Size 8 bytes, Field private_id - Inode Number.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 16, Size 8 bytes, Field create_time - Create Timestamp.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 24, Size 8 bytes, Field mod_time - Modification Timestamp.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 32, Size 8 bytes, Field change_time - Change Timestamp.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 40, Size 8 bytes, Field access_time - Access Timestamp.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 72, Size 4 bytes, Field owner - Owner.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 76, Size 4 bytes, Field group - Group.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Metadata: Offset 80, Size 2 bytes, Field mode - File Mode.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Metadata", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Extent: Offset 0, Size 8 bytes - File Size.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Extent", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Extent: Offset 8, Size 8 bytes - Physical Block Location.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Extent", "category": "dfir", "platform": "macos"}}
{"text": "Value - Inode File Extent: Offset 16, Size 8 bytes - Crypto ID.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Inode File Extent", "category": "dfir", "platform": "macos"}}
{"text": "cd .. - Change Directory up one directory (../.. - two directories up).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "cd /var/log - Change Directory to /var/log.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "cd ~ - Change Directory to your home directory.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "cd / - Change Directory to the root directory.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "ls - List Directory (Short Listing).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "ls -l - List Directory (Long Listing).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "ls -a - List Directory items including hidden items (files beginning with \".\").", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "ls -lh - List Directory items with human readable sizes.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "ls -R - List Directory items recursively.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "open . - Open Current Directory.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "pwd - Print Working Directory.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "mkdir - Create a Directory.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "rmdir - Remove a Directory.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "rm -r - Remove a Directory (and its contents).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Directory Commands", "category": "dfir", "platform": "macos"}}
{"text": "pico <filename> - Open a file in a simple text editor (q- to quit editor).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "xxd <filename> - Open a file in a hex editor.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "open <filename> - Opens a file in the default program.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "open -a <programname> <filename> - Opens a file in a specified program.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "cat <filename> - Concatenate a file to the terminal screen.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "<command> | more - Pipe command output to more to show contents screen by screen.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "<command> | less - Pipe command output to less to show contents screen by screen (and be able to go back and forth).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "rm <filename> - Remove File.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "cp <filename> <newfilename> - Copy File.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "mv <filename> <newfilename> - Move File.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "<command> > <filename> - Redirect command output to a file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "<command> >> <filename> - Append command output to a file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "touch <filename> - Create an empty file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "head <filename> - Show first 10 lines of a file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "tail <filename> - Show last 10 lines of a file (-f to watch appended input).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "strings <filename> - Show the strings of a file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "exiftool <filename> - Show the exif/metadata of the file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "plutil -p <propertylist> - Print the contents of a property list.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "file <filename> - Show a file signature type.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "grep -i <searchterm> <filename> - Search for term within a file (case-insensitive).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "python <file>.py - Execute a Python program.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS File Commands", "category": "dfir", "platform": "macos"}}
{"text": "sudo <command> - Execute program as another user (default is root user).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Miscellaneous Commands", "category": "dfir", "platform": "macos"}}
{"text": "sudo -s - Open a privileged shell.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Miscellaneous Commands", "category": "dfir", "platform": "macos"}}
{"text": "su - - Substitute User to root.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Miscellaneous Commands", "category": "dfir", "platform": "macos"}}
{"text": "whoami / id - Display Effective User ID / Show UID/GID Info.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Miscellaneous Commands", "category": "dfir", "platform": "macos"}}
{"text": "history - Command History.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Miscellaneous Commands", "category": "dfir", "platform": "macos"}}
{"text": "man <command> - Command Manual (q- to exit manual).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Miscellaneous Commands", "category": "dfir", "platform": "macos"}}
{"text": "Generic Tool Compilation: tar -xvf <archive>.tar.gz && ./configure && make && sudo make install.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Generic Tool Compilation", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Control + A - Jump to beginning of line.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Control + E - Jump to end of line.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Tab - Tab Completion.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Control + C - Kill Current Command.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Command + K or Control + L - Clear Screen (or clear command).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Command + T - New Terminal Tab.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Command + W - Close Terminal Tab.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Command +/- - Increase or Decrease Terminal Font Size.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Option + Left/Right Arrow - Move back/forth by word.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Terminal Shortcut: Option + Click in Command Line - Put command line cursor where mouse cursor is.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Terminal Shortcuts", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: date - Local System Time (-u for UTC).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: hostname - System Hostname.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: uname -a - OS & Architecture Information.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: sw_vers - macOS Version & Build.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: netstat -anf inet or netstat -an - Active Network Connections.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: lsof -i - Active Network Connections (by process).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: netstat -rn - Routing Table.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: arp -an | ndp -an - ARP Table (IPv4 | IPv6).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: ifconfig - Network Interface Configuration.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: lsof - List Open Files.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: who -a, w - List Logged On Users.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: last - List user logins.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: ps aux - List Processes.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "Live Response: system_profiler -xml -detaillevel full > file.spx - System Profiler (XML, Full Detail Level), open with System Information.app.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Live Response", "category": "dfir", "platform": "macos"}}
{"text": "/dev/ - Device Directory.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "diskutil list - List Connected Disks.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "diskutil info <disk> - Disk Information (use Disks /dev/disk#, disk#, or partitions /dev/disk#s#).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "diskutil cs|ap list - List partitions using CoreStorage (cs) or APFS Containers (ap).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "gpt -r show [-l] - List partitions using GUID Partition Table Format (-l to show label rather than GUID) - 10.13+ SIP must be disabled.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "csrutil disable|enable - Disable/Enable SIP, must reboot into Recovery Mode (Reboot, Cmd+Option+R).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "mmls <diskimage> - Display partitions using The Sleuth Kit.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "hdiutil imageinfo *.dmg - Disk Image Information including Partition Data.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk & Partitions", "category": "dfir", "platform": "macos"}}
{"text": "xattr -xl <file> - Show Extended Attributes of a file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "xattr -p <attribute name> <file> | xxd -r -p > output_file.plist - Extract embedded binary property list from extended attribute.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "istat /dev/disk# <CNID> - Use The Sleuth Kit to view file information including extended attributes.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "icat /dev/disk# <CNID>-<TSK Attribute Number> - View a specific extended attribute using The Sleuth Kit.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Extended Attributes", "category": "dfir", "platform": "macos"}}
{"text": "tmutil uniquesize <machinedirectory_path>/* - Show the unique sizes of each snapshot.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Time Machine", "category": "dfir", "platform": "macos"}}
{"text": "tmutil calculatedrift <machinedirectory_path> - Show the size changes (added/removed/changed) between each snapshot.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Time Machine", "category": "dfir", "platform": "macos"}}
{"text": "tmutil compare <snapshotdirectory1> <snapshotdirectory2> - Compare the file changes (added/removed/changed) between two snapshots.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Time Machine", "category": "dfir", "platform": "macos"}}
{"text": "Log Analysis: bzcat system.log.1.bz2 system.log.0.bz2 >> system_all.log && cat system.log >> system_all.log - Create an all-in-one system.log file. Can also be used with gzcat for Gzip compressed log files.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Log Analysis: syslog -f <file> | -d <directory> - View ASL File or Directory of ASL files.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Log Analysis: syslog -T utc -F raw -d /var/log/asl - Output ASL files the /var/log/asl directory and output in raw format with UTC timestamps.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Log Analysis: praudit -xn /var/audit/* - View audit logs in XML format without user/group resolution.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Log Analysis: sudo log collect - Create a logarchive bundle on live system, root required.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Log Analysis: log show - View logs in logarchive bundle (use with --predicate to filter).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "Log Analysis: log stream - View live logs (use with --predicate to filter).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Log Analysis", "category": "dfir", "platform": "macos"}}
{"text": "security list-keychains - List Keychains on a system for a logged in user.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Keychains", "category": "dfir", "platform": "macos"}}
{"text": "security dump-keychains -d <keychain> - Dump contents of a Keychain.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Keychains", "category": "dfir", "platform": "macos"}}
{"text": "mdls <file> - List the Spotlight metadata for a file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Spotlight", "category": "dfir", "platform": "macos"}}
{"text": "mdfind \"<attribute_name> == *\" - Find files based on a specific metadata query.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Spotlight", "category": "dfir", "platform": "macos"}}
{"text": "mdfind -onlyin /Volumes/mounted_disk - Find files only in a certain directory or mounted image.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Spotlight", "category": "dfir", "platform": "macos"}}
{"text": "mdimport -X | -A - Print a list of attributes that can be queried.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Spotlight", "category": "dfir", "platform": "macos"}}
{"text": "vol.py --profile=<profile> -f <memory image> <plugin> - Volatility Usage.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Memory Analysis", "category": "dfir", "platform": "macos"}}
{"text": "hdiutil attach -readonly -nomount -stdinpass filevault2image.dmg - Mount a FileVault volume using a password.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Memory Analysis & Encrypted Containers", "category": "dfir", "platform": "macos"}}
{"text": "security unlock-keychain FileVaultMaster.keychain && diskutil corestorage unlockvolume <UUID> -recoverykeychain FileVaultMaster.keychain - Access and mount a FileVault volume using a master password.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Memory Analysis & Encrypted Containers", "category": "dfir", "platform": "macos"}}
{"text": "diskutil corestorage unlockvolume <UUID> -passphrase <recovery key> - Mount a FileVault volume using the Recovery Key.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Memory Analysis & Encrypted Containers", "category": "dfir", "platform": "macos"}}
{"text": "hdiutil attach -readonly -nomount -stdinpass sekretstuff_USB.dmg - Mount an Encrypted DMG File.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Memory Analysis & Encrypted Containers", "category": "dfir", "platform": "macos"}}
{"text": "strings <MemoryImage> | sort -u > dictionary.txt - Create a dictionary file.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Memory Analysis & Encrypted Containers", "category": "dfir", "platform": "macos"}}
{"text": "Disk Arbitration: sudo launchctl load /System/Library/LaunchDaemons/com.apple.diskarbitrationd.plist - Load disk arbitration daemon.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk Arbitration", "category": "dfir", "platform": "macos"}}
{"text": "Disk Arbitration: sudo launchctl unload /System/Library/LaunchDaemons/com.apple.diskarbitrationd.plist - Unload disk arbitration daemon.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk Arbitration", "category": "dfir", "platform": "macos"}}
{"text": "Disk Arbitration: ps auxw | grep diskarbitrationd - Check disk arbitration daemon status.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Disk Arbitration", "category": "dfir", "platform": "macos"}}
{"text": "APFS with xmount: sudo mkdir /Volumes/galaga_image/ && sudo mkdir /Volumes/galaga_mounted/ && sudo xmount --in ewf ~/FOR518/galaga.E01 --out dmg /Volumes/galaga_image/ && hdiutil attach -nomount /Volumes/galaga_image/galaga.dmg && sudo mount_apfs -o rdonly,noexec,noowners /dev/disk# /Volumes/galaga_mounted/.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Image Mount & Eject", "category": "dfir", "platform": "macos"}}
{"text": "HFS+ with xmount: mkdir /Volumes/dademurphy_image/ && mkdir /Volumes/dademurphy_mounted/ && sudo xmount --in ewf ~/FOR518/dademurphy.E01 --out dmg /Volumes/dademurphy_image/ && hdiutil attach -nomount /Volumes/dademurphy_image/dademurphy.dmg && mount_hfs -j -o rdonly,noexec,noowners /dev/disk# /Volumes/dademurphy_mounted/.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Image Mount & Eject", "category": "dfir", "platform": "macos"}}
{"text": "Eject Disk: diskutil list && diskutil eject /dev/disk# && mount && sudo umount /Volumes/galaga_image/.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Image Mount & Eject", "category": "dfir", "platform": "macos"}}
{"text": "APFS Timestamp: 64-bit - Number of Seconds from 1/1/1970 00:00:00 UTC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Timestamp Formats", "category": "dfir", "platform": "macos"}}
{"text": "HFS+/MacOS Timestamp: 32-bit - Number of seconds from 1/1/1904 00:00:00 UTC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Timestamp Formats", "category": "dfir", "platform": "macos"}}
{"text": "UNIX Epoch Timestamp: 32-bit - Number of seconds from 1/1/1970 00:00:00 UTC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Timestamp Formats", "category": "dfir", "platform": "macos"}}
{"text": "Mac Epoch/Mac Absolute/Cocoa/WebKit Timestamp: 32-bit - Number of seconds from 1/1/2001 00:00:00 UTC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Timestamp Formats", "category": "dfir", "platform": "macos"}}
{"text": "Property List Dates in Xcode: Local Host System Time.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS Timestamp Formats", "category": "dfir", "platform": "macos"}}
{"text": "GPT Header: Offset 0, Size 8 bytes - Signature (EFI PART).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Header", "category": "dfir", "platform": "macos"}}
{"text": "GPT Header: Offset 56, Size 16 bytes - Disk GUID.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Header", "category": "dfir", "platform": "macos"}}
{"text": "GPT Header: Offset 72, Size 8 bytes - Starting LBA of GUID Partition Table (Little Endian).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Header", "category": "dfir", "platform": "macos"}}
{"text": "GPT Header: Offset 80, Size 4 bytes - Number of Partition Entries Available (Little Endian).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Header", "category": "dfir", "platform": "macos"}}
{"text": "GPT Table Entry: Offset 0, Size 16 bytes - Partition Type GUID.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Table Entry", "category": "dfir", "platform": "macos"}}
{"text": "GPT Table Entry: Offset 16, Size 16 bytes - Unique Partition GUID.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Table Entry", "category": "dfir", "platform": "macos"}}
{"text": "GPT Table Entry: Offset 32, Size 8 bytes - Starting LBA (Little Endian).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Table Entry", "category": "dfir", "platform": "macos"}}
{"text": "GPT Table Entry: Offset 40, Size 8 bytes - Ending LBA (Little Endian).", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Table Entry", "category": "dfir", "platform": "macos"}}
{"text": "GPT Table Entry: Offset 56, Size 72 bytes - Partition Name.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Table Entry", "category": "dfir", "platform": "macos"}}
{"text": "GPT Partition GUID: EFI System Partition = C12A7328-F81F-11D2-BA4B-00A0C93EC93B.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Partition GUIDs", "category": "dfir", "platform": "macos"}}
{"text": "GPT Partition GUID: HFS+ Partition = 48465300-0000-11AA-AA11-00306543ECAC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Partition GUIDs", "category": "dfir", "platform": "macos"}}
{"text": "GPT Partition GUID: Apple Boot Partition = 426F6F74-0000-11AA-AA11-00306543ECAC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Partition GUIDs", "category": "dfir", "platform": "macos"}}
{"text": "GPT Partition GUID: Apple CoreStorage (possible FileVault or Fusion Drive) = 53746F72-6167-11AA-AA11-00306543ECAC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Partition GUIDs", "category": "dfir", "platform": "macos"}}
{"text": "GPT Partition GUID: APFS Partition = 7C3457EF-0000-11AA-AA11-00306543ECAC.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Partition GUIDs", "category": "dfir", "platform": "macos"}}
{"text": "GPT Partition GUID: Basic Data Partition (Boot Camp) = EBD0A0A2-B9E5-4433-87C0-68B6B72699C7.", "metadata": {"source": "SANS_DFIR_Booklet", "title": "APFS GPT Partition GUIDs", "category": "dfir", "platform": "macos"}}
