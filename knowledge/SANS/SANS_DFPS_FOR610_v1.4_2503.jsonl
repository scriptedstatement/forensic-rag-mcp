{"text": "Uncovering the capabilities of malicious software allows security professionals to respond to incidents, fortify defenses, and derive threat intelligence.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Tips and Tricks", "category": "malware", "platform": "windows"}}
{"text": "The malware analysis tips and tricks outlined in this poster act as a starting point and a reminder for the individuals looking to reverse-engineer and otherwise examine suspicious files such as compiled executables and potentially malicious documents.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Tips and Tricks", "category": "malware", "platform": "windows"}}
{"text": "What threat does the malicious or suspicious artifact pose? What do its mechanics reveal about the adversary's goals and capabilities? How effective are the company's security controls against such infections? What security measures can strengthen the infrastructure from future attacks of this nature?", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Questions", "category": "malware", "platform": "windows"}}
{"text": "Summary of the analysis: Key takeaways the reader should get from the report regarding the specimen's nature, origin, capabilities, and other relevant characteristics", "metadata": {"source": "SANS_FOR610", "title": "Malware Report Template - Summary", "category": "malware", "platform": "windows"}}
{"text": "Identification: The type of the file, its name, size, hashes (such as SHA256 and imphash), malware names (if known), current anti-virus detection capabilities", "metadata": {"source": "SANS_FOR610", "title": "Malware Report Template - Identification", "category": "malware", "platform": "windows"}}
{"text": "Characteristics: The specimen's capabilities for infecting files, self-preservation, spreading, leaking data, interacting with the attacker, and so on; for a good reference of what characteristics you may need, take a look at the MAEC Malware Capabilities project or the alternative effort Malware Behavior Catalog (MBC)", "metadata": {"source": "SANS_FOR610", "title": "Malware Report Template - Characteristics", "category": "malware", "platform": "windows"}}
{"text": "Dependencies: Files and network resources related to the specimen's functionality, such as supported OS versions and required initialization files, custom DLLs, executables, URLs, and scripts", "metadata": {"source": "SANS_FOR610", "title": "Malware Report Template - Dependencies", "category": "malware", "platform": "windows"}}
{"text": "Behavioral and code analysis findings: Overview of the analyst's behavioral, as well as static and dynamic code analysis observations", "metadata": {"source": "SANS_FOR610", "title": "Malware Report Template - Findings", "category": "malware", "platform": "windows"}}
{"text": "Supporting figures: Logs, screenshots, string excerpts, function listings, and other exhibits that support the investigators analysis", "metadata": {"source": "SANS_FOR610", "title": "Malware Report Template - Supporting Figures", "category": "malware", "platform": "windows"}}
{"text": "Incident recommendations: Indicators for detecting the specimen on other systems and networks (a.k.a. indicators of compromise or IOCs), and possible for eradication steps", "metadata": {"source": "SANS_FOR610", "title": "Malware Report Template - Recommendations", "category": "malware", "platform": "windows"}}
{"text": "Manual Code Reversing: Reverse-engineering the code that comprises the specimen can add valuable insights to the findings available after completing interactive behavior analysis. Some characteristics of the specimen are simply impractical to examine without examining the code. Code-level analysis often involves unpacking the specimen, deciding any data the malware author may have concealed, understanding the capabilities that didn't exhibit themselves during behavior analysis.", "metadata": {"source": "SANS_FOR610", "title": "Stages of Malware Analysis - Manual Code Reversing", "category": "malware", "platform": "windows"}}
{"text": "Interactive Behavior Analysis: Interactive behavior analysis involves examining how sample runs in the lab that's under the analyst's full control to go beyond what a fully automated approach might produce. This stage involves examining registry, filesystem, process, network, and memory activities. It is especially fruitful when the researcher interacts with the malicious program, rather than passively observing the specimen.", "metadata": {"source": "SANS_FOR610", "title": "Stages of Malware Analysis - Interactive Behavior Analysis", "category": "malware", "platform": "windows"}}
{"text": "Static Properties Analysis: Analysts might proceed with examining the malware specimen by looking at its static properties, which are sometimes called metadata. This process entails examining the strings embedded into the file, its overall structure, and header data, without actually running the malicious program. This stage helps the analyst decide what aspects of the specimen, if any, are worth examining more closely.", "metadata": {"source": "SANS_FOR610", "title": "Stages of Malware Analysis - Static Properties Analysis", "category": "malware", "platform": "windows"}}
{"text": "Fully Automated Analysis: The easiest way to begin learning about a malware specimen is to examine it using fully automated tools. Sometimes called analysis sandboxes, these they're designed to assess what the specimen might do if it ran on a system. They might not provide as much insight as a human analyst would. However, they can handle vast amounts of malware, allowing the analyst to focus on the specimens that truly require her attention.", "metadata": {"source": "SANS_FOR610", "title": "Stages of Malware Analysis - Fully Automated Analysis", "category": "malware", "platform": "windows"}}
{"text": "Use automated analysis sandbox tools for an initial assessment of the suspicious file.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 1", "category": "malware", "platform": "windows"}}
{"text": "Set up a controlled, isolated laboratory in which to examine the malware specimen.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 2", "category": "malware", "platform": "windows"}}
{"text": "Examine static properties and meta-data of the specimen for triage and early theories.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 3", "category": "malware", "platform": "windows"}}
{"text": "Emulate code execution to identify malicious capabilities and contemplate next steps.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 4", "category": "malware", "platform": "windows"}}
{"text": "Perform behavioral analysis to examine the specimen's interactions with its environment.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 5", "category": "malware", "platform": "windows"}}
{"text": "Analyze relevant aspects of the code statically with a disassembler and decompiler.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 6", "category": "malware", "platform": "windows"}}
{"text": "Perform dynamic code analysis to understand the more difficult aspects of the code.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 7", "category": "malware", "platform": "windows"}}
{"text": "If necessary, unpack the specimen.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 8", "category": "malware", "platform": "windows"}}
{"text": "Repeat steps 4-8 above as necessary (the order may vary) until analysis objectives are met.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 9", "category": "malware", "platform": "windows"}}
{"text": "Augment your analysis using other methods, such as memory forensics and threat intel.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 10", "category": "malware", "platform": "windows"}}
{"text": "Document findings, save analysis artifacts and clean up the laboratory for future analysis.", "metadata": {"source": "SANS_FOR610", "title": "Malware Analysis Process Step 11", "category": "malware", "platform": "windows"}}
{"text": "Behavioral Analysis: Be ready to revert to good state via virtualization snapshots, Clonezilla, dd, FOG, PXE booting, etc.", "metadata": {"source": "SANS_FOR610", "title": "Behavioral Analysis - State Management", "category": "malware", "platform": "windows"}}
{"text": "Monitor local interactions (Process Explorer, Process Monitor, ProcDOT, Noriben).", "metadata": {"source": "SANS_FOR610", "title": "Behavioral Analysis - Local Monitoring Tools", "category": "malware", "platform": "windows"}}
{"text": "Detect major local changes (RegShot, Autoruns).", "metadata": {"source": "SANS_FOR610", "title": "Behavioral Analysis - Change Detection Tools", "category": "malware", "platform": "windows"}}
{"text": "Monitor network interactions (Wireshark, Fiddler).", "metadata": {"source": "SANS_FOR610", "title": "Behavioral Analysis - Network Monitoring Tools", "category": "malware", "platform": "windows"}}
{"text": "Redirect network traffic (fakedns, accept-all-ips).", "metadata": {"source": "SANS_FOR610", "title": "Behavioral Analysis - Network Redirection", "category": "malware", "platform": "windows"}}
{"text": "Activate services (INetSim or actual services) requested by malware and reinfect the system.", "metadata": {"source": "SANS_FOR610", "title": "Behavioral Analysis - Service Activation", "category": "malware", "platform": "windows"}}
{"text": "Adjust the runtime environment for the specimen as it requests additional local or network resources.", "metadata": {"source": "SANS_FOR610", "title": "Behavioral Analysis - Environment Adjustment", "category": "malware", "platform": "windows"}}
{"text": "Ghidra for Static Code Analysis: Go to specific destination (g), Show references to instruction (Ctrl+Shift+f), Insert a comment (;), Follow jump or call (Enter), Return to previous location (Alt+Left), Go to next location (Alt+Right), Undo (Ctrl+z), Define data type (t), Add a bookmark (Ctrl+d), Text search (Ctrl+Shift+e), Add or edit a label (l), Disassemble values (d)", "metadata": {"source": "SANS_FOR610", "title": "Ghidra Keyboard Shortcuts", "category": "malware", "platform": "windows"}}
{"text": "x64dbg/x32dbg for Dynamic Code Analysis: Run the code (F9), Step into/over instruction (F7/F8), Execute until selected instruction (F4), Execute until the next return (Ctrl+F9), Show previous/next executed instruction (-/+), Return to previous view (*), Go to specific expression (Ctrl+g), Insert comment/label (;/:), Show current function as a graph (g), Find specific pattern (Ctrl+b)", "metadata": {"source": "SANS_FOR610", "title": "x64dbg/x32dbg Keyboard Shortcuts", "category": "malware", "platform": "windows"}}
{"text": "Set software breakpoint on specific instruction: Select instruction then F2", "metadata": {"source": "SANS_FOR610", "title": "x64dbg Breakpoints", "category": "malware", "platform": "windows"}}
{"text": "Set software breakpoint on API: Go to Command prompt then SetBPX API Name", "metadata": {"source": "SANS_FOR610", "title": "x64dbg API Breakpoints", "category": "malware", "platform": "windows"}}
{"text": "Highlight all occurrences of the keyword: h then Click on keyword in disassembler", "metadata": {"source": "SANS_FOR610", "title": "x64dbg Highlighting", "category": "malware", "platform": "windows"}}
{"text": "Assemble instruction in place of selected one: Select instruction then Spacebar", "metadata": {"source": "SANS_FOR610", "title": "x64dbg Assembly", "category": "malware", "platform": "windows"}}
{"text": "Edit data in memory or instruction opcode: Select data or instruction then Ctrl+e", "metadata": {"source": "SANS_FOR610", "title": "x64dbg Memory Editing", "category": "malware", "platform": "windows"}}
{"text": "Extract API call references: Right-click in disassembler then Search for then Current module then Intermodular calls", "metadata": {"source": "SANS_FOR610", "title": "x64dbg API References", "category": "malware", "platform": "windows"}}
{"text": "Unpacking Malicious Code: Determine whether the specimen is packed by using Detect It Easy, Exeinfo PE, Bytehist, peframe, etc.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - Detection", "category": "malware", "platform": "windows"}}
{"text": "To try unpacking the specimen quickly, infect the lab system and dump from memory using Scylla.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - Quick Method", "category": "malware", "platform": "windows"}}
{"text": "For more precision, find the Original Entry Point (OEP) in a debugger and dump with OllyDumpEx.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - OEP Method", "category": "malware", "platform": "windows"}}
{"text": "To find the OEP, anticipate the condition close to the end of the unpacker and set the breakpoint.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - Finding OEP", "category": "malware", "platform": "windows"}}
{"text": "Try setting a memory breakpoint on the stack in the unpacker's beginning to catch it during cleanup.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - Stack Breakpoint", "category": "malware", "platform": "windows"}}
{"text": "To get closer to the OEP, set breakpoints on APIs such as LoadLibrary, VirtualAlloc, etc.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - API Breakpoints", "category": "malware", "platform": "windows"}}
{"text": "To intercept process injection set breakpoints on VirtualAllocEx, WriteProcessMemory, etc.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - Process Injection Breakpoints", "category": "malware", "platform": "windows"}}
{"text": "If cannot dump cleanly, examine the packed specimen via dynamic code analysis while it runs.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - Dynamic Analysis Alternative", "category": "malware", "platform": "windows"}}
{"text": "Rebuild imports and other aspects of the dumped file using Scylla, Imports Fixer, and pe_unmapper.", "metadata": {"source": "SANS_FOR610", "title": "Unpacking - Import Rebuilding", "category": "malware", "platform": "windows"}}
{"text": "Bypassing Other Analysis Defenses: Decode obfuscated strings statically using FLOSS, xorsearch, Balbuzard, etc.", "metadata": {"source": "SANS_FOR610", "title": "Bypassing Defenses - String Decoding", "category": "malware", "platform": "windows"}}
{"text": "Decode data in a debugger by setting a breakpoint after the decoding function and examining results.", "metadata": {"source": "SANS_FOR610", "title": "Bypassing Defenses - Debugger Decoding", "category": "malware", "platform": "windows"}}
{"text": "Conceal x64dbg/x32dbg via the ScyllaHide plugin.", "metadata": {"source": "SANS_FOR610", "title": "Bypassing Defenses - Debugger Concealment", "category": "malware", "platform": "windows"}}
{"text": "To disable anti-analysis functionality, locate and patch the defensive code using a debugger.", "metadata": {"source": "SANS_FOR610", "title": "Bypassing Defenses - Code Patching", "category": "malware", "platform": "windows"}}
{"text": "Look out for tricky jumps via TLS, SEH, RET, CALL, etc. when stepping through the code in a debugger.", "metadata": {"source": "SANS_FOR610", "title": "Bypassing Defenses - Tricky Jumps", "category": "malware", "platform": "windows"}}
{"text": "If analyzing shellcode, use scdbg and runsc.", "metadata": {"source": "SANS_FOR610", "title": "Bypassing Defenses - Shellcode Analysis", "category": "malware", "platform": "windows"}}
{"text": "Disable ASLR via setdllcharacteristics, CFF Explorer.", "metadata": {"source": "SANS_FOR610", "title": "Bypassing Defenses - Disable ASLR", "category": "malware", "platform": "windows"}}
{"text": "REMnux Usage Tips: Get REMnux as a virtual appliance, install the distro on a dedicated system, or add it to an existing one.", "metadata": {"source": "SANS_FOR610", "title": "REMnux Getting Started Step 1", "category": "malware", "platform": "linux"}}
{"text": "Review REMnux documentation at docs.remnux.org.", "metadata": {"source": "SANS_FOR610", "title": "REMnux Getting Started Step 2", "category": "malware", "platform": "linux"}}
{"text": "Keep your system up to date by periodically running remnux upgrade and remnux update.", "metadata": {"source": "SANS_FOR610", "title": "REMnux Getting Started Step 3", "category": "malware", "platform": "linux"}}
{"text": "Become familiar with REMnux malware analysis tools available as Docker images.", "metadata": {"source": "SANS_FOR610", "title": "REMnux Getting Started Step 4", "category": "malware", "platform": "linux"}}
{"text": "Know default logon credentials: remnux/malware", "metadata": {"source": "SANS_FOR610", "title": "REMnux Default Credentials", "category": "malware", "platform": "linux"}}
{"text": "General Commands on REMnux: shutdown (Shut down the system), reboot (Reboot the system), sudo -s (Switch to a root shell), renew-dhcp (Renew DHCP lease), myip (See current IP address), code file (Edit a text file), feh file (View an image file), httpd start (Start web server), sshd start (Start SSH server)", "metadata": {"source": "SANS_FOR610", "title": "REMnux General Commands", "category": "malware", "platform": "linux"}}
{"text": "Analyze Windows Executables - Static Properties: manalyze, peframe, pefile, exitool, clamscan, pescan, portex, bearcommander, pecheck", "metadata": {"source": "SANS_FOR610", "title": "REMnux Windows PE Static Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Analyze Windows Executables - Strings and Deobfuscation: pestr, bbcrack, brxor.py, base64dump, xorsearch, flarestrings, floss, cyberchef", "metadata": {"source": "SANS_FOR610", "title": "REMnux Windows PE String Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Analyze Windows Executables - Code Emulation: binee, capa, vivbin", "metadata": {"source": "SANS_FOR610", "title": "REMnux Windows PE Emulation Tools", "category": "malware", "platform": "windows"}}
{"text": "Analyze Windows Executables - Disassemble/Decompile: ghidra, cutter, objdump, r2", "metadata": {"source": "SANS_FOR610", "title": "REMnux Windows PE Disassembly Tools", "category": "malware", "platform": "windows"}}
{"text": "Analyze Windows Executables - Unpacking: bytehist, de4dot, upx", "metadata": {"source": "SANS_FOR610", "title": "REMnux Windows PE Unpacking Tools", "category": "malware", "platform": "windows"}}
{"text": "Reverse-Engineer Linux Binaries - Static Properties: trid, exitool, pyew, readelf.py", "metadata": {"source": "SANS_FOR610", "title": "REMnux Linux Binary Static Analysis Tools", "category": "malware", "platform": "linux"}}
{"text": "Reverse-Engineer Linux Binaries - Disassemble/Decompile: ghidra, cutter, objdump, r2", "metadata": {"source": "SANS_FOR610", "title": "REMnux Linux Binary Disassembly Tools", "category": "malware", "platform": "linux"}}
{"text": "Reverse-Engineer Linux Binaries - Debugging: edb, gdb", "metadata": {"source": "SANS_FOR610", "title": "REMnux Linux Binary Debugging Tools", "category": "malware", "platform": "linux"}}
{"text": "Reverse-Engineer Linux Binaries - Behavior Analysis: ltrace, strace, frida, sysdig, unhide", "metadata": {"source": "SANS_FOR610", "title": "REMnux Linux Binary Behavior Analysis Tools", "category": "malware", "platform": "linux"}}
{"text": "Investigate Other Forms of Malicious Code - Android: apktool, droidlysis, androgui.py, baksmali, dex2jar", "metadata": {"source": "SANS_FOR610", "title": "REMnux Android Analysis Tools", "category": "malware", "platform": "android"}}
{"text": "Investigate Other Forms of Malicious Code - Java: cfr, procyon, jad, jd-gui, idx_parser.py", "metadata": {"source": "SANS_FOR610", "title": "REMnux Java Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Investigate Other Forms of Malicious Code - Python: pyinstxtractor.py, pycdc", "metadata": {"source": "SANS_FOR610", "title": "REMnux Python Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Investigate Other Forms of Malicious Code - JavaScript: js, js-file, objects.js, box-js", "metadata": {"source": "SANS_FOR610", "title": "REMnux JavaScript Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Investigate Other Forms of Malicious Code - Shellcode: shellcode2exe.bat, scdbg, xorsearch", "metadata": {"source": "SANS_FOR610", "title": "REMnux Shellcode Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Investigate Other Forms of Malicious Code - PowerShell: pwsh, base64dump", "metadata": {"source": "SANS_FOR610", "title": "REMnux PowerShell Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Investigate Other Forms of Malicious Code - Flash: swfdump, flare, flasm, swf_mastah.py, xxxswf", "metadata": {"source": "SANS_FOR610", "title": "REMnux Flash Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Examine Suspicious Documents - Microsoft Office Files: vmonkey, pcodedmp, olevba, xlmdeobfuscator, oledump.py, msoffice-crypt, ssview", "metadata": {"source": "SANS_FOR610", "title": "REMnux MS Office Document Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Examine Suspicious Documents - RTF Files: rtfobj, rtfdump", "metadata": {"source": "SANS_FOR610", "title": "REMnux RTF Document Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Examine Suspicious Documents - Email Messages: emldump, msgconvert", "metadata": {"source": "SANS_FOR610", "title": "REMnux Email Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Examine Suspicious Documents - PDF Files: pdfid, pdfparser, pdfextract, pdfdecrypt, peepdf, pdtk, pdfresurrect, qpdf, pdfobjflow", "metadata": {"source": "SANS_FOR610", "title": "REMnux PDF Document Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Examine Suspicious Documents - General: base64dump, tesseract, exitool", "metadata": {"source": "SANS_FOR610", "title": "REMnux General Document Analysis Tools", "category": "malware", "platform": "windows"}}
{"text": "Explore Network Interactions - Monitoring: burpsuite, networkminer, polarproxy, mitmproxy, wireshark, tshark, ngrep, tcpxtract", "metadata": {"source": "SANS_FOR610", "title": "REMnux Network Monitoring Tools", "category": "malware", "platform": "linux"}}
{"text": "Explore Network Interactions - Connecting: thug, nc, tor, wget, curl, irc, ssh, unfurl", "metadata": {"source": "SANS_FOR610", "title": "REMnux Network Connecting Tools", "category": "malware", "platform": "linux"}}
{"text": "Explore Network Interactions - Services: fakedns, fakemail, accept-all-ips, nc, httpd, inetsim, fakenet, sshd, myip", "metadata": {"source": "SANS_FOR610", "title": "REMnux Network Services Tools", "category": "malware", "platform": "linux"}}
{"text": "Gather and Analyze Data - Network: Automater.py, shodan, ipwhois_cli.py, pdnstool", "metadata": {"source": "SANS_FOR610", "title": "REMnux Network Intelligence Tools", "category": "malware", "platform": "linux"}}
{"text": "Gather and Analyze Data - Hashes: malwoverview.py, nsrllookup, Automater.py, vt, virustotal-search.py", "metadata": {"source": "SANS_FOR610", "title": "REMnux Hash Lookup Tools", "category": "malware", "platform": "linux"}}
{"text": "Gather and Analyze Data - Files: yara, scalpel, bulk_extractor, ioc_writer", "metadata": {"source": "SANS_FOR610", "title": "REMnux File Analysis Tools", "category": "malware", "platform": "linux"}}
{"text": "Gather and Analyze Data - Other: dexray, viper, time-decode.py", "metadata": {"source": "SANS_FOR610", "title": "REMnux Other Analysis Tools", "category": "malware", "platform": "linux"}}
{"text": "Other Analysis Tasks - Memory Forensics: vol.py, vol3, linux_mem_diff.py, aeskeyfindr, rsakeyfindr, bulk_extractor", "metadata": {"source": "SANS_FOR610", "title": "REMnux Memory Forensics Tools", "category": "malware", "platform": "linux"}}
{"text": "Other Analysis Tasks - File Editing: wxHexEditor, scite, code, xpdf, convert", "metadata": {"source": "SANS_FOR610", "title": "REMnux File Editing Tools", "category": "malware", "platform": "linux"}}
{"text": "Other Analysis Tasks - File Extraction: 7z, unzip, unrar, cabextract", "metadata": {"source": "SANS_FOR610", "title": "REMnux File Extraction Tools", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Thug Honeyclient: remnux/thug", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - Thug", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - JSDetox JavaScript Analysis: remnux/jsdetox", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - JSDetox", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Rekall Memory Forensics: remnux/rekall", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - Rekall", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - RetDec Decompiler: remnux/retdec", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - RetDec", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Radare2 Reversing Framework: remnux/radare2", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - Radare2", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Ciphey Automatic Decrypter: remnux/ciphey", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - Ciphey", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - Viper Binary Analysis Framework: remnux/viper", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - Viper", "category": "malware", "platform": "linux"}}
{"text": "Use Docker Containers for Analysis - REMnux in a Container: remnux/remnux-distro", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker - Full Distro", "category": "malware", "platform": "linux"}}
{"text": "Interact with Docker Images: docker images (List local images), docker pull image (Update local image), docker rmi imageid (Delete local image), docker system prune (Delete unused resources)", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker Commands", "category": "malware", "platform": "linux"}}
{"text": "Open a shell inside a transient container: docker run --rm -it image bash", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker Shell", "category": "malware", "platform": "linux"}}
{"text": "Map a local TCP port 80 to container's port 80: docker run --rm -it -p 80:80 image bash", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker Port Mapping", "category": "malware", "platform": "linux"}}
{"text": "Map your current directory into container: docker run --rm -it -v .:dir image bash", "metadata": {"source": "SANS_FOR610", "title": "REMnux Docker Volume Mapping", "category": "malware", "platform": "linux"}}
{"text": "Examine static properties of the Windows executable for initial assessment and triage.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 1", "category": "malware", "platform": "windows"}}
{"text": "Identify strings and API calls that highlight the program's suspicious or malicious capabilities.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 2", "category": "malware", "platform": "windows"}}
{"text": "Perform automated and manual behavioral analysis to gather additional details.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 3", "category": "malware", "platform": "windows"}}
{"text": "Emulate code execution to identify characteristics and areas for further analysis.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 4", "category": "malware", "platform": "windows"}}
{"text": "Use a disassembler and decompiler to statically examine code related to risky strings and APIs.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 5", "category": "malware", "platform": "windows"}}
{"text": "Use a debugger for dynamic analysis to examine how risky strings and API calls are used.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 6", "category": "malware", "platform": "windows"}}
{"text": "If appropriate, unpack the code and its artifacts.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 7", "category": "malware", "platform": "windows"}}
{"text": "As your understanding of the code increases, add comments, labels; rename functions, variables.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 8", "category": "malware", "platform": "windows"}}
{"text": "Progress to examine the code that references or depends upon the code you've already analyzed.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 9", "category": "malware", "platform": "windows"}}
{"text": "Repeat steps 5-9 above as necessary (the order may vary) until analysis objectives are met.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Process Step 10", "category": "malware", "platform": "windows"}}
{"text": "Common 32-Bit Registers and Uses: EAX (Addition, multiplication, function results), ECX (Counter; used by LOOP and others), EBP (Baseline/frame pointer for referencing function arguments EBP+value and local variables EBP-value), ESP (Points to the current top of the stack; changes via PUSH, POP, and others), EIP (Instruction pointer; points to the next instruction; shellcode gets it via call/pop), EFLAGS (Contains flags that store outcomes of computations e.g., Zero and Carry flags), FS (F segment register; FS[0] points to SEH chain, FS[0x30] points to the PEB)", "metadata": {"source": "SANS_FOR610", "title": "x86 32-Bit Registers", "category": "malware", "platform": "windows"}}
{"text": "Common x86 Assembly Instructions: mov EAX,0xB8 (Put the value 0xB8 in EAX), push EAX (Put EAX contents on the stack), pop EAX (Remove contents from top of the stack and put them in EAX), lea EAX,[EBP-4] (Put the address of variable EBP-4 in EAX), call EAX (Call the function whose address resides in the EAX register)", "metadata": {"source": "SANS_FOR610", "title": "x86 Assembly Instructions - Basic", "category": "malware", "platform": "windows"}}
{"text": "Common x86 Assembly Instructions: add esp,8 (Increase ESP by 8 to shrink the stack by two 4-byte arguments), sub esp,0x54 (Shift ESP by 0x54 to make room on the stack for local variables), xor EAX,EAX (Set EAX contents to zero), test EAX,EAX (Check whether EAX contains zero, set the appropriate EFLAGS bits), cmp EAX,0xB8 (Compare EAX to 0xB8, set the appropriate EFLAGS bits)", "metadata": {"source": "SANS_FOR610", "title": "x86 Assembly Instructions - Stack and Comparison", "category": "malware", "platform": "windows"}}
{"text": "Understanding 64-Bit Registers: EAX becomes RAX, ECX becomes RCX, EBX becomes RBX, ESP becomes RSP, EIP becomes RIP. Additional 64-bit registers are R8-R15. RSP is often used to access stack arguments and local variables, instead of EBP.", "metadata": {"source": "SANS_FOR610", "title": "x64 64-Bit Registers", "category": "malware", "platform": "windows"}}
{"text": "64-bit register breakdown: R8 (64 bits full register), R8D (32 bits lower half), R8W (16 bits lower word), R8B (8 bits lowest byte)", "metadata": {"source": "SANS_FOR610", "title": "x64 Register Breakdown", "category": "malware", "platform": "windows"}}
{"text": "Passing Parameters to Functions: arg0 is [EBP+8] on 32-bit or RCX on 64-bit, arg1 is [EBP+0xC] on 32-bit or RDX on 64-bit, arg2 is [EBP+0x10] on 32-bit or R8 on 64-bit, arg3 is [EBP+0x14] on 32-bit or R9 on 64-bit", "metadata": {"source": "SANS_FOR610", "title": "Function Parameter Passing Conventions", "category": "malware", "platform": "windows"}}
{"text": "Decoding Conditional Jumps: JA/JG (Jump if above/jump if greater), JB/JL (Jump if below/jump if less), JE/JZ (Jump if equal; same as jump if zero), JNE/JNZ (Jump if not equal; same as jump if not zero), JGE/JNL (Jump if greater or equal; same as jump if not less)", "metadata": {"source": "SANS_FOR610", "title": "x86 Conditional Jump Instructions", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Code injection: CreateRemoteThread, OpenProcess, VirtualAllocEx, WriteProcessMemory, EnumProcesses", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Code Injection", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Dynamic DLL loading: LoadLibrary, GetProcAddress", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Dynamic Loading", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Memory scraping: CreateToolhelp32Snapshot, OpenProcess, ReadProcessMemory, EnumProcesses", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Memory Scraping", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Data stealing: GetClipboardData, GetWindowText", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Data Stealing", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Keylogging: GetAsyncKeyState, SetWindowsHookEx", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Keylogging", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Embedded resources: FindResource, LockResource", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Embedded Resources", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Unpacking/self-injection: VirtualAlloc, VirtualProtect", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Unpacking", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Query artifacts: CreateMutex, CreateFile, FindWindow, GetModuleHandle, RegOpenKeyEx", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Query Artifacts", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Execute a program: WinExec, ShellExecute, CreateProcess", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Execute Program", "category": "malware", "platform": "windows"}}
{"text": "Some Risky Windows API Calls - Web interactions: InternetOpen, HttpOpenRequest, HttpSendRequest, InternetReadFile", "metadata": {"source": "SANS_FOR610", "title": "Risky Windows APIs - Web Interactions", "category": "malware", "platform": "windows"}}
{"text": "Additional Code Analysis Tips: Be patient but persistent; focus on small, manageable code areas and expand from there.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Tips - Patience", "category": "malware", "platform": "windows"}}
{"text": "Use dynamic code analysis (debugging) for code that's too difficult to understand statically.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Tips - Dynamic Analysis", "category": "malware", "platform": "windows"}}
{"text": "Look at jumps and calls to assess how the specimen flows from interesting code block to the other.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Tips - Control Flow", "category": "malware", "platform": "windows"}}
{"text": "If code analysis is taking too long, consider whether behavioral or memory analysis will achieve the goals.", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Tips - Alternative Methods", "category": "malware", "platform": "windows"}}
{"text": "When looking for API calls, know the official API names and the associated native APIs (Nt, Zw, Rtl).", "metadata": {"source": "SANS_FOR610", "title": "Code Analysis Tips - Native APIs", "category": "malware", "platform": "windows"}}
{"text": "General Approach to Document Analysis: Examine the document for anomalies, such as risky tags, scripts, and embedded artifacts.", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Step 1", "category": "malware", "platform": "windows"}}
{"text": "General Approach to Document Analysis: Locate embedded code, such as shellcode, macros, JavaScript, or other suspicious objects.", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Step 2", "category": "malware", "platform": "windows"}}
{"text": "General Approach to Document Analysis: Extract suspicious code or objects from the file.", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Step 3", "category": "malware", "platform": "windows"}}
{"text": "General Approach to Document Analysis: If relevant, deobfuscate and examine macros, JavaScript, or other embedded code.", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Step 4", "category": "malware", "platform": "windows"}}
{"text": "General Approach to Document Analysis: If relevant, emulate, disassemble and/or debug shellcode that you extracted from the document.", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Step 5", "category": "malware", "platform": "windows"}}
{"text": "General Approach to Document Analysis: Understand the next steps in the infection chain.", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Step 6", "category": "malware", "platform": "windows"}}
{"text": "Microsoft Office Format Notes: Binary Microsoft Office document files (.doc, .xls, etc.) use the OLE2 (a.k.a. Structured Storage) format.", "metadata": {"source": "SANS_FOR610", "title": "MS Office Format - OLE2", "category": "malware", "platform": "windows"}}
{"text": "Microsoft Office Format Notes: SRP streams in OLE2 documents sometimes store a cached version of earlier VBA macro code.", "metadata": {"source": "SANS_FOR610", "title": "MS Office Format - SRP Streams", "category": "malware", "platform": "windows"}}
{"text": "Microsoft Office Format Notes: OOXML document files (.docx, .xlsm, etc.) supported by Microsoft Office are compressed zip archives.", "metadata": {"source": "SANS_FOR610", "title": "MS Office Format - OOXML", "category": "malware", "platform": "windows"}}
{"text": "Microsoft Office Format Notes: VBA macros in OOXML documents are stored inside an OLE2 binary file, which is within the zip archive.", "metadata": {"source": "SANS_FOR610", "title": "MS Office Format - VBA in OOXML", "category": "malware", "platform": "windows"}}
{"text": "Microsoft Office Format Notes: Excel supports XLM macros that are embedded as formulas in sheets without the OLE2 binary file.", "metadata": {"source": "SANS_FOR610", "title": "MS Office Format - XLM Macros", "category": "malware", "platform": "windows"}}
{"text": "Microsoft Office Format Notes: RTF documents don't support macros but can contain malicious embedded files and objects.", "metadata": {"source": "SANS_FOR610", "title": "MS Office Format - RTF", "category": "malware", "platform": "windows"}}
{"text": "zipdump.py file.pptx - Examine contents of OOXML file file.pptx", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - zipdump", "category": "malware", "platform": "windows"}}
{"text": "zipdump.py file.pptx -s 3 -d - Extract file with index 3 from file.pptx to STDOUT", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - zipdump extract", "category": "malware", "platform": "windows"}}
{"text": "olevba.py file.xlsm - Locate and extract macros from file.xlsm", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - olevba", "category": "malware", "platform": "windows"}}
{"text": "oledump.py file.xls -s 3 -v - Extract VBA source code from stream 3 in file.xls", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - oledump", "category": "malware", "platform": "windows"}}
{"text": "xmldump.py pretty - Format XML file supplied via STDIN for easier analysis", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - xmldump", "category": "malware", "platform": "windows"}}
{"text": "oledump.py file.xls -p plugin_http_heuristics - Find obfuscated URLs in file.xls macros", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - oledump plugin", "category": "malware", "platform": "windows"}}
{"text": "vmonkey file.doc - Emulate the execution of macros in file.doc to analyze them", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - vmonkey", "category": "malware", "platform": "windows"}}
{"text": "evilclippy -uu file.ppt - Remove the password prompt from macros in file.ppt", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - evilclippy", "category": "malware", "platform": "windows"}}
{"text": "msoffcrypto-tool infile.docm outfile.docm -p password - Decrypt outfile.docm using specified password to create outfile.docm", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - msoffcrypto-tool", "category": "malware", "platform": "windows"}}
{"text": "pcodedmp file.doc - Disassemble VBA-stomped p-code macro from file.doc", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - pcodedmp", "category": "malware", "platform": "windows"}}
{"text": "pcode2code file.doc - Decompile VBA-stomped p-code macro from file.doc", "metadata": {"source": "SANS_FOR610", "title": "MS Office Analysis Command - pcode2code", "category": "malware", "platform": "windows"}}
{"text": "rtfobj.py file.rtf - Extract objects embedded into RTF file.rtf", "metadata": {"source": "SANS_FOR610", "title": "RTF Analysis Command - rtfobj", "category": "malware", "platform": "windows"}}
{"text": "rtfdump.py file.rtf - List groups and structure of RTF file file.rtf", "metadata": {"source": "SANS_FOR610", "title": "RTF Analysis Command - rtfdump list", "category": "malware", "platform": "windows"}}
{"text": "rtfdump.py file.rtf -O - Examine objects in RTF file file.rtf", "metadata": {"source": "SANS_FOR610", "title": "RTF Analysis Command - rtfdump objects", "category": "malware", "platform": "windows"}}
{"text": "rtfdump.py file.rtf -f hex - Extract hex contents from group in RTF file file.rtf", "metadata": {"source": "SANS_FOR610", "title": "RTF Analysis Command - rtfdump hex", "category": "malware", "platform": "windows"}}
{"text": "xlmdeobfuscator --file file.xlsm - Deobfuscate XLM (Excel 4) macros in file.xlsm", "metadata": {"source": "SANS_FOR610", "title": "Excel XLM Analysis Command - xlmdeobfuscator", "category": "malware", "platform": "windows"}}
{"text": "Risky PDF Keywords: /OpenAction and /AA specify the script or action to run automatically", "metadata": {"source": "SANS_FOR610", "title": "PDF Risky Keywords - OpenAction", "category": "malware", "platform": "windows"}}
{"text": "Risky PDF Keywords: /JavaScript, /JS, /AcroForm, and /XFA can specify JavaScript to run", "metadata": {"source": "SANS_FOR610", "title": "PDF Risky Keywords - JavaScript", "category": "malware", "platform": "windows"}}
{"text": "Risky PDF Keywords: /URI accesses a URL, perhaps for phishing", "metadata": {"source": "SANS_FOR610", "title": "PDF Risky Keywords - URI", "category": "malware", "platform": "windows"}}
{"text": "Risky PDF Keywords: /SubmitForm and /GoToR can send data to URL", "metadata": {"source": "SANS_FOR610", "title": "PDF Risky Keywords - SubmitForm", "category": "malware", "platform": "windows"}}
{"text": "Risky PDF Keywords: /ObjStm can hide objects inside an object stream", "metadata": {"source": "SANS_FOR610", "title": "PDF Risky Keywords - ObjStm", "category": "malware", "platform": "windows"}}
{"text": "Risky PDF Keywords: /XObject can embed an image for phishing", "metadata": {"source": "SANS_FOR610", "title": "PDF Risky Keywords - XObject", "category": "malware", "platform": "windows"}}
{"text": "Be mindful of obfuscation with hex codes, such as /JavaScript vs. /J#61vaScript", "metadata": {"source": "SANS_FOR610", "title": "PDF Keyword Obfuscation", "category": "malware", "platform": "windows"}}
{"text": "pdfid.py file.pdf -n - Display risky keywords present in file file.pdf", "metadata": {"source": "SANS_FOR610", "title": "PDF Analysis Command - pdfid", "category": "malware", "platform": "windows"}}
{"text": "pdf-parser.py file.pdf -a - Show stats about keywords. Add -O to include object streams", "metadata": {"source": "SANS_FOR610", "title": "PDF Analysis Command - pdf-parser stats", "category": "malware", "platform": "windows"}}
{"text": "pdf-parser.py file.pdf -o id - Display contents of object id. Add -d to dump object's stream", "metadata": {"source": "SANS_FOR610", "title": "PDF Analysis Command - pdf-parser object", "category": "malware", "platform": "windows"}}
{"text": "pdf-parser.py file.pdf -r id - Display objects that reference object id", "metadata": {"source": "SANS_FOR610", "title": "PDF Analysis Command - pdf-parser references", "category": "malware", "platform": "windows"}}
{"text": "qpdf --password=pass --decrypt infile.pdf outfile.pdf - Decrypt infile.pdf using password pass to create outfile.pdf", "metadata": {"source": "SANS_FOR610", "title": "PDF Analysis Command - qpdf decrypt", "category": "malware", "platform": "windows"}}
{"text": "xorsearch -W -d 3 file.bin - Locate shellcode patterns inside the binary file file.bin", "metadata": {"source": "SANS_FOR610", "title": "Shellcode Analysis Command - xorsearch", "category": "malware", "platform": "windows"}}
{"text": "scdbg /f file.bin - Emulate execution of shellcode in file.bin. Use /off to specify offset", "metadata": {"source": "SANS_FOR610", "title": "Shellcode Analysis Command - scdbg", "category": "malware", "platform": "windows"}}
{"text": "runsc32 -f file.bin -n - Execute shellcode in file file.bin to observe behavior in an isolated lab", "metadata": {"source": "SANS_FOR610", "title": "Shellcode Analysis Command - runsc32", "category": "malware", "platform": "windows"}}
{"text": "base64dump.py file.txt - List Base64-encoded strings present in file file.txt", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Command - base64dump", "category": "malware", "platform": "windows"}}
{"text": "numbers-to-string.py file - Convert numbers that represent characters in file to a string", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Command - numbers-to-string", "category": "malware", "platform": "windows"}}
{"text": "Additional Document Analysis Tools: SpiderMonkey, cscript, and box-js help deobfuscate JavaScript that you extract from document files", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Tools - JavaScript", "category": "malware", "platform": "windows"}}
{"text": "Use the debugger built into Microsoft Office to deobfuscate macros in an isolated lab", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Tools - Office Debugger", "category": "malware", "platform": "windows"}}
{"text": "Use AMSIScriptContentRetrieval.ps1 to observe Microsoft Office execute macros in an isolated lab", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Tools - AMSI", "category": "malware", "platform": "windows"}}
{"text": "Some automated analysis sandboxes can analyze aspects of malicious document files", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Tools - Sandboxes", "category": "malware", "platform": "windows"}}
{"text": "REMnux distro includes many of the free document analysis tools mentioned above", "metadata": {"source": "SANS_FOR610", "title": "Document Analysis Tools - REMnux", "category": "malware", "platform": "linux"}}
