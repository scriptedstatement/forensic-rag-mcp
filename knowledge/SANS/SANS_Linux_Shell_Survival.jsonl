{"text": "Linux Shell Survival Guide v2.3 - POCKET REFERENCE GUIDE", "metadata": {"source": "SANS_Linux_Shell", "title": "Document Title", "category": "reference", "platform": "linux"}}
{"text": "SANS Institute http://computer-forensics.sans.org", "metadata": {"source": "SANS_Linux_Shell", "title": "Publisher", "category": "reference", "platform": "linux"}}
{"text": "by Phil Hagen http://lewestech.com", "metadata": {"source": "SANS_Linux_Shell", "title": "Author", "category": "reference", "platform": "linux"}}
{"text": "This guide is a supplement to SANS FOR572: Advanced Network Forensics and Analysis. It covers some of what we consider the more useful Linux shell primitives and core utilities. These can be exceedingly helpful when automating analysis processes, generating output that can be copied and pasted into a report or spreadsheet document, or supporting quick-turn responses when a full tool kit is not available.", "metadata": {"source": "SANS_Linux_Shell", "title": "Purpose", "category": "reference", "platform": "linux"}}
{"text": "Remember: If you can make it happen in a shell over a lag-ridden SSH connection, there is a better chance of being the lethal forensicator when it really matters!", "metadata": {"source": "SANS_Linux_Shell", "title": "Purpose Note", "category": "reference", "platform": "linux"}}
{"text": "Linux has been around since 1991, and its *NIX parents since 1969. This handout cannot begin to scratch the surface of the great and powerful things you can do with nothing more than a shell prompt and some moxie. Use this document as a \"memory jog\" for some of the capabilities of the more commonly used tools in this course and in the forensic workflow in general.", "metadata": {"source": "SANS_Linux_Shell", "title": "How To Use This Document", "category": "reference", "platform": "linux"}}
{"text": "Dig into the details of each tool's features through its manual pages (aka \"man pages\") and other online and offline references. We think you will find the shell to be as powerful as the GUI, and in some cases a far superior alternative - especially for scalability and automation.", "metadata": {"source": "SANS_Linux_Shell", "title": "How To Use This Document", "category": "reference", "platform": "linux"}}
{"text": "BASH provides many functions to improve your accuracy, speed, and efficiency - know and use them!", "metadata": {"source": "SANS_Linux_Shell", "title": "Use the Force", "category": "reference", "platform": "linux"}}
{"text": "Tab Completion: Hit the <TAB> key to expand the first few characters of a command, directory name, filename, or variable name. If there is more than one possible option, it will complete as far as possible. Press <TAB> again to see the possible completion options.", "metadata": {"source": "SANS_Linux_Shell", "title": "Tab Completion", "category": "reference", "platform": "linux"}}
{"text": "~ An alias for the current user's home directory (also available as $HOME)", "metadata": {"source": "SANS_Linux_Shell", "title": "Standard Variables - Home Directory", "category": "reference", "platform": "linux"}}
{"text": "$PATH The command search path", "metadata": {"source": "SANS_Linux_Shell", "title": "Standard Variables - PATH", "category": "reference", "platform": "linux"}}
{"text": "$? The exit value of the previous command", "metadata": {"source": "SANS_Linux_Shell", "title": "Standard Variables - Exit Value", "category": "reference", "platform": "linux"}}
{"text": "$PWD The current working directory", "metadata": {"source": "SANS_Linux_Shell", "title": "Standard Variables - PWD", "category": "reference", "platform": "linux"}}
{"text": "Command History: Cycle through previous commands by pressing the up and down arrows. Use the history command to see a list of the command history buffer. (BASH writes this buffer is ~/.bash_history upon exiting, overwriting any existing contents.) Press Ctrl-R to search through history for commands that match a search string.", "metadata": {"source": "SANS_Linux_Shell", "title": "Command History", "category": "reference", "platform": "linux"}}
{"text": "Linux prefers small, single-purpose functions and utilities. Chain them together with the \"pipe\", which sends the output of one command into the next as input.", "metadata": {"source": "SANS_Linux_Shell", "title": "Working on the Chain Gang", "category": "reference", "platform": "linux"}}
{"text": "$ grep pattern input.txt | sort | uniq -c", "metadata": {"source": "SANS_Linux_Shell", "title": "Pipe Example", "category": "reference", "platform": "linux"}}
{"text": "Iteratively build a series of commands to create output that definitively addresses your requirements.", "metadata": {"source": "SANS_Linux_Shell", "title": "Chain Gang Advice", "category": "reference", "platform": "linux"}}
{"text": "grep Print lines matching a pattern", "metadata": {"source": "SANS_Linux_Shell", "title": "grep Command", "category": "reference", "platform": "linux"}}
{"text": "$ grep pattern input.txt", "metadata": {"source": "SANS_Linux_Shell", "title": "grep Syntax", "category": "reference", "platform": "linux"}}
{"text": "grep -i Case-insensitive pattern matching", "metadata": {"source": "SANS_Linux_Shell", "title": "grep -i Option", "category": "reference", "platform": "linux"}}
{"text": "grep -v Print lines that do not match", "metadata": {"source": "SANS_Linux_Shell", "title": "grep -v Option", "category": "reference", "platform": "linux"}}
{"text": "grep -c Count matching lines instead of printing them", "metadata": {"source": "SANS_Linux_Shell", "title": "grep -c Option", "category": "reference", "platform": "linux"}}
{"text": "grep -l Print filenames containing matching lines", "metadata": {"source": "SANS_Linux_Shell", "title": "grep -l Option", "category": "reference", "platform": "linux"}}
{"text": "grep -h Do not include filenames when searching multiple input files (e.g. output*.txt)", "metadata": {"source": "SANS_Linux_Shell", "title": "grep -h Option", "category": "reference", "platform": "linux"}}
{"text": "sort Sort lines alphabetically or numerically", "metadata": {"source": "SANS_Linux_Shell", "title": "sort Command", "category": "reference", "platform": "linux"}}
{"text": "$ sort input.txt", "metadata": {"source": "SANS_Linux_Shell", "title": "sort Syntax", "category": "reference", "platform": "linux"}}
{"text": "sort -n Sort numerically (5 before 10)", "metadata": {"source": "SANS_Linux_Shell", "title": "sort -n Option", "category": "reference", "platform": "linux"}}
{"text": "sort -r Reverse sort order", "metadata": {"source": "SANS_Linux_Shell", "title": "sort -r Option", "category": "reference", "platform": "linux"}}
{"text": "sort -k Specify an alternate sort field", "metadata": {"source": "SANS_Linux_Shell", "title": "sort -k Option", "category": "reference", "platform": "linux"}}
{"text": "sort -t Specify a field delimiter for -k (default is whitespace)", "metadata": {"source": "SANS_Linux_Shell", "title": "sort -t Option", "category": "reference", "platform": "linux"}}
{"text": "uniq Only print consecutive matching lines once", "metadata": {"source": "SANS_Linux_Shell", "title": "uniq Command", "category": "reference", "platform": "linux"}}
{"text": "$ grep pattern input.txt | uniq", "metadata": {"source": "SANS_Linux_Shell", "title": "uniq Syntax", "category": "reference", "platform": "linux"}}
{"text": "uniq -c Print the count of consecutive lines", "metadata": {"source": "SANS_Linux_Shell", "title": "uniq -c Option", "category": "reference", "platform": "linux"}}
{"text": "Remember: Only finds consecutive matching lines! Most useful with input piped from the sort command.", "metadata": {"source": "SANS_Linux_Shell", "title": "uniq Note", "category": "reference", "platform": "linux"}}
{"text": "$ grep pattern input.txt | sort | uniq", "metadata": {"source": "SANS_Linux_Shell", "title": "uniq with sort Example", "category": "reference", "platform": "linux"}}
{"text": "Redirect output to a file instead of the shell itself with the \"greater than\" character. (Warning: Overwrites existing contents!)", "metadata": {"source": "SANS_Linux_Shell", "title": "Redirect Output", "category": "reference", "platform": "linux"}}
{"text": "$ grep pattern1 input.txt > results.txt", "metadata": {"source": "SANS_Linux_Shell", "title": "Redirect Output Example", "category": "reference", "platform": "linux"}}
{"text": "Append to existing files with \"double greater than\".", "metadata": {"source": "SANS_Linux_Shell", "title": "Append Output", "category": "reference", "platform": "linux"}}
{"text": "$ grep pattern2 input.txt >> results.txt", "metadata": {"source": "SANS_Linux_Shell", "title": "Append Output Example", "category": "reference", "platform": "linux"}}
{"text": "tcpdump Dump network traffic", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump Command", "category": "reference", "platform": "linux"}}
{"text": "$ sudo tcpdump -n -s 0 -i eth0 '<BPF filter>'", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump Live Capture Syntax", "category": "reference", "platform": "linux"}}
{"text": "$ tcpdump -n -r input.pcap -w output.pcap '<BPF filter>'", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump File Processing Syntax", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -n Prevent DNS lookups on IP addresses. Use twice to also prevent port-to-service lookups", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -n Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -r Read from pcap file instead of the network", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -r Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -w Write packet data to a file", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -w Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -D Enumerate network interfaces", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -D Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -i Specify the network interface on which to capture", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -i Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -s Number of bytes per packet to capture", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -s Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -C Number of megabytes to save in a capture file before starting a new file", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -C Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -G Number of seconds to save in each capture file (requires time format in output filename)", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -G Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -W Used with the -C or -G options, limit the number of rotated files (see man page for detailed usage)", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -W Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump -x Display packet contents in hex", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump -x Option", "category": "reference", "platform": "linux"}}
{"text": "tcpdump requires root privileges to capture network traffic promiscuously. User-level permissions are sufficient for manipulating existing capture files.", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump Permissions Note", "category": "reference", "platform": "linux"}}
{"text": "See the pcap-filter man page for information on building BPFs to control captured traffic.", "metadata": {"source": "SANS_Linux_Shell", "title": "tcpdump BPF Reference", "category": "reference", "platform": "linux"}}
{"text": "nfpcapd Generate nfdump-compatible NetFlow records from pcap file", "metadata": {"source": "SANS_Linux_Shell", "title": "nfpcapd Command", "category": "reference", "platform": "linux"}}
{"text": "$ nfpcapd -r in.pcap -l ./netflow/ -S 1 -z", "metadata": {"source": "SANS_Linux_Shell", "title": "nfpcapd Syntax", "category": "reference", "platform": "linux"}}
{"text": "nfpcapd -r pcap file to read", "metadata": {"source": "SANS_Linux_Shell", "title": "nfpcapd -r Option", "category": "reference", "platform": "linux"}}
{"text": "nfpcapd -l Output directory", "metadata": {"source": "SANS_Linux_Shell", "title": "nfpcapd -l Option", "category": "reference", "platform": "linux"}}
{"text": "nfpcapd -S Output directory format (0=flat, 1=yr/mo/day; see nfcapd man page for more)", "metadata": {"source": "SANS_Linux_Shell", "title": "nfpcapd -S Option", "category": "reference", "platform": "linux"}}
{"text": "nfpcapd -z Compress output flows", "metadata": {"source": "SANS_Linux_Shell", "title": "nfpcapd -z Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump Process NetFlow data from files on disk", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Command", "category": "reference", "platform": "linux"}}
{"text": "$ nfdump -R ./ -O tstart -o extended", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Syntax", "category": "reference", "platform": "linux"}}
{"text": "nfdump -R Recursively read data from the specified directory", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -R Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump -r Read data from a single nfcapd file", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -r Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump -a Aggregate by src+dst IP, src+dst port, proto", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -a Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump -A Specify custom aggregation", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -A Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump -t Time window, in \"YYYY/MM/DD.hh:mm:ss\" format (See man page for additional details)", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -t Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump -s Generate \"TopN\" statistics", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -s Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump -O Specify output ordering", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -O Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump -o Specify output format (line, long, extended, or custom). Custom formatting uses \"fmt:<format string>\" syntax, where \"<format string>\" defines values displayed (see man page for full list).", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump -o Option", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %ts Start time, %te End time", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Time", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %td Duration, %pr Protocol", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Duration/Protocol", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %sa Source address, %da Destination address", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Addresses", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %sap Source IP:port, %dap Destination IP:port", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - IP:Port", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %sp Source port, %dp Destination port", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Ports", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %sas Source ASN, %das Destination ASN", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - ASN", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %pkt Packet count, %byt Byte count", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Counts", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %fl Flow count, %flg TCP flags", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Flow/Flags", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %bps Bits per second, %pps Packets per second", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Rates", "category": "reference", "platform": "linux"}}
{"text": "nfdump format: %bpp Bytes per packet", "metadata": {"source": "SANS_Linux_Shell", "title": "nfdump Format - Bytes per Packet", "category": "reference", "platform": "linux"}}
{"text": "passivedns Generate normalized records for all DNS queries and responses", "metadata": {"source": "SANS_Linux_Shell", "title": "passivedns Command", "category": "reference", "platform": "linux"}}
{"text": "$ passivedns -r input.pcap -l pdnslog.txt -L pdns_nxdomain.txt", "metadata": {"source": "SANS_Linux_Shell", "title": "passivedns Syntax", "category": "reference", "platform": "linux"}}
{"text": "passivedns -r Specify pcap file to read", "metadata": {"source": "SANS_Linux_Shell", "title": "passivedns -r Option", "category": "reference", "platform": "linux"}}
{"text": "passivedns -l Log for normal (non-error) queries", "metadata": {"source": "SANS_Linux_Shell", "title": "passivedns -l Option", "category": "reference", "platform": "linux"}}
{"text": "passivedns -L Log for SRC error queries", "metadata": {"source": "SANS_Linux_Shell", "title": "passivedns -L Option", "category": "reference", "platform": "linux"}}
{"text": "passivedns -i Specify interface for live DNS observation", "metadata": {"source": "SANS_Linux_Shell", "title": "passivedns -i Option", "category": "reference", "platform": "linux"}}
{"text": "tshark Dump and analyze network traffic (aka \"Wireshark in the shell\")", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark Command", "category": "reference", "platform": "linux"}}
{"text": "$ tshark -n -r in.pcap -Y '<disp filter>'", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark Syntax", "category": "reference", "platform": "linux"}}
{"text": "tshark -n Prevent DNS and port lookups", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark -n Option", "category": "reference", "platform": "linux"}}
{"text": "tshark -r Read from pcap file instead of the network", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark -r Option", "category": "reference", "platform": "linux"}}
{"text": "tshark -w Write output to a pcap file instead of the terminal", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark -w Option", "category": "reference", "platform": "linux"}}
{"text": "tshark -T Output format (text, fields, etc.)", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark -T Option", "category": "reference", "platform": "linux"}}
{"text": "tshark -e With \"-T fields\", add a field to the output", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark -e Option", "category": "reference", "platform": "linux"}}
{"text": "tshark -Y Protocol-aware display filter to apply", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark -Y Option", "category": "reference", "platform": "linux"}}
{"text": "tshark -z Statistical output modes - see man page", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark -z Option", "category": "reference", "platform": "linux"}}
{"text": "See the wireshark-filter man page for information on building protocol-aware display filters.", "metadata": {"source": "SANS_Linux_Shell", "title": "tshark Filter Reference", "category": "reference", "platform": "linux"}}
{"text": "awk Pattern scanning and processing language - Seriously powerful stuff!", "metadata": {"source": "SANS_Linux_Shell", "title": "awk Command", "category": "reference", "platform": "linux"}}
{"text": "$ awk -F ',' '{ print $1,$6,$3 }' in.txt", "metadata": {"source": "SANS_Linux_Shell", "title": "awk Syntax", "category": "reference", "platform": "linux"}}
{"text": "awk -F Specify input field separator (default is space)", "metadata": {"source": "SANS_Linux_Shell", "title": "awk -F Option", "category": "reference", "platform": "linux"}}
{"text": "Input and output field separators can be specified in the awk script itself with the FS and OFS variables:", "metadata": {"source": "SANS_Linux_Shell", "title": "awk Field Separators", "category": "reference", "platform": "linux"}}
{"text": "$ awk '{ FS = \",\"; OFS = \"\\t\"; print $2,$4 }' in.txt", "metadata": {"source": "SANS_Linux_Shell", "title": "awk FS/OFS Example", "category": "reference", "platform": "linux"}}
{"text": "man Interface to the on-line reference manuals", "metadata": {"source": "SANS_Linux_Shell", "title": "man Command", "category": "reference", "platform": "linux"}}
{"text": "$ man find", "metadata": {"source": "SANS_Linux_Shell", "title": "man Syntax", "category": "reference", "platform": "linux"}}
{"text": "man -k Perform keyword search through all man pages", "metadata": {"source": "SANS_Linux_Shell", "title": "man -k Option", "category": "reference", "platform": "linux"}}
{"text": "Use inline command help where available - many commands provide brief usage statements with the \"--help\" or \"-h\" options", "metadata": {"source": "SANS_Linux_Shell", "title": "Inline Help", "category": "reference", "platform": "linux"}}
{"text": "$ tcpdump --help", "metadata": {"source": "SANS_Linux_Shell", "title": "Help Example", "category": "reference", "platform": "linux"}}
{"text": "The Grymoire - home for UNIX wizards: http://www.grymoire.com/Unix/", "metadata": {"source": "SANS_Linux_Shell", "title": "External Reference", "category": "reference", "platform": "linux"}}
