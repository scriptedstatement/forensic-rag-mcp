{"text": "Git global setup: git config --global user.name \"John Doe\" and git config --global user.email \"johndoe@example.com\"", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Git Global Setup", "category": "defense", "platform": "cloud"}}
{"text": "Clone and Edit a repository: git clone git@git.example.com:repository/project.git, cd project, touch README.md, git add README.md, git commit -m \"docs: add README\", git push -u origin main", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Git Clone and Edit Repository", "category": "defense", "platform": "cloud"}}
{"text": "Convert existing folder to repo and push: cd existing_folder, git init, git remote add origin git@git.example.com:repository/project.git, git add -A, git commit -m \"Initial commit\", git push -u origin main", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Git Convert Folder to Repository", "category": "defense", "platform": "cloud"}}
{"text": "Install Pre-Commit to manage git hooks that can run before or after git commands: pip3 install pre-commit", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Pre-Commit Installation", "category": "defense", "platform": "cloud"}}
{"text": "Prevent storing AWS credentials in git using pre-commit hooks: cd repository, create .pre-commit-config.yaml with repos: - repo: https://github.com/pre-commit/pre-commit-hooks, rev: v4.5.0, hooks: - id: detect-aws-credentials, then run pre-commit install", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Pre-Commit Detect AWS Credentials", "category": "defense", "platform": "cloud"}}
{"text": "Update pre-commit hook to the latest release: pre-commit autoupdate", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Pre-Commit Autoupdate", "category": "defense", "platform": "cloud"}}
{"text": "Docker basic commands: docker pull <image>:<tag>, docker image ls, docker image rm <imageid>, docker container ls -a", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Basic Commands", "category": "defense", "platform": "cloud"}}
{"text": "Run Containers in Detached Mode: docker run -d -p 443:443 nginx", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Run Detached Mode", "category": "defense", "platform": "cloud"}}
{"text": "List all nginx containers: docker ps --filter ancestor=nginx", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Filter Containers", "category": "defense", "platform": "cloud"}}
{"text": "Stop and delete the running container: latest_container_id=$(docker ps -n 1 --format \"{{.ID}}\"), docker kill \"${latest_container_id}\", docker rm \"${latest_container_id}\"", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Stop and Delete Container", "category": "defense", "platform": "cloud"}}
{"text": "Mount the current directory on your host into the /host directory inside a container: docker run -v \"$(pwd):/host\" -it ubuntu:22.04", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Volume Mount", "category": "defense", "platform": "cloud"}}
{"text": "Setup the local system for multi-platform image builds: docker buildx inspect multiplatform || docker buildx create --name multiplatform --driver docker-container --use", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Buildx Multi-Platform Setup", "category": "defense", "platform": "cloud"}}
{"text": "Create a minimal Dockerfile into an OCI-compliant artifact: cat >> Dockerfile << EOF, FROM nginx, EOF, docker buildx build -o type=oci,dest=nginx.tar .", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker OCI Artifact Build", "category": "defense", "platform": "cloud"}}
{"text": "Build and push a multiplatform image: docker login --username ace135, docker buildx build --platform=linux/amd64,linux/arm64 --push --build-arg KEY=VALUE --tag ace135/demo .", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Multiplatform Image Build", "category": "defense", "platform": "cloud"}}
{"text": "Build and push an image with an accompanying SLSA attestation: docker buildx build --push --attest type=provenance,mode=max -t ace135/demo:slsa .", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker SLSA Attestation Build", "category": "defense", "platform": "cloud"}}
{"text": "Extract the Dockerfile used to create the specified image: docker buildx imagetools inspect jonzeolla/docker-provenance:latest --format '{{ range (index .Provenance.SLSA.metadata \"https://mobyproject.org/buildkit@v1#metadata\").source.infos }}{{ if eq .filename \"Dockerfile\" }}{{.data }}{{ end }}{{ end }}' | base64 -d", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Docker Extract Dockerfile from Image", "category": "defense", "platform": "cloud"}}
{"text": "Prowler is a multi-cloud audit tool. Install and run the tool, which will use the cloud APIs to gather information. Ensure you're logged into the correct cloud provider prior to running prowler: pip3 install prowler, prowler --help", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Prowler Multi-Cloud Audit Tool", "category": "defense", "platform": "cloud"}}
{"text": "Review options for the aws, azure, and gcp providers in Prowler: prowler aws --help, prowler azure --help, prowler gcp --help", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Prowler Cloud Provider Options", "category": "defense", "platform": "cloud"}}
{"text": "Checkov is a misconfiguration scanner. It can scan Terraform, Kubernetes, Dockerfiles, and other file types: pip3 install checkov, checkov -f example/file.tf", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Checkov Misconfiguration Scanner", "category": "defense", "platform": "cloud"}}
{"text": "Recursively scan a directory with Checkov: checkov --directory .", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Checkov Directory Scan", "category": "defense", "platform": "cloud"}}
{"text": "Find security misconfigurations in Helm Charts: checkov --framework helm --directory .", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Checkov Helm Chart Scan", "category": "defense", "platform": "cloud"}}
{"text": "Use easy_infra to run IaC tools in a secure-by-default docker image. Turn off security scans to ensure it functionally works in your environment: docker run -e DISABLE_SECURITY=true -v .:/iac seiso/easy_infra:latest-terraform terraform validate", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "easy_infra Disable Security Scans", "category": "defense", "platform": "cloud"}}
{"text": "Run security scans but suppress failures with easy_infra: docker run -e LEARNING_MODE=true -v .:/iac seiso/easy_infra:latest-terraform terraform validate", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "easy_infra Learning Mode", "category": "defense", "platform": "cloud"}}
{"text": "Fail on detected security issues with easy_infra: docker run -v .:/iac seiso/easy_infra:latest-terraform terraform validate", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "easy_infra Fail on Security Issues", "category": "defense", "platform": "cloud"}}
{"text": "Detect directories with terraform files, and run security scans and then terraform validate in each directory: docker run -e AUTODETECT=true -v .:/iac seiso/easy_infra:latest-terraform terraform validate", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "easy_infra Autodetect Terraform", "category": "defense", "platform": "cloud"}}
{"text": "See the logs from latest docker run: docker cp $(docker ps -n 1 --format \"{{.ID}}\"):/var/log/easy_infra.log ., cat easy_infra.log", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "easy_infra View Logs", "category": "defense", "platform": "cloud"}}
{"text": "Conftest uses a language called Rego to scan configuration files such as Terraform, Dockerfiles, Kubernetes manifests, and any other structured data", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Conftest Policy as Code Tool", "category": "defense", "platform": "cloud"}}
{"text": "Write a policy that disallows the use of nginx with Conftest: mkdir policy && cat > policy/policy.rego << EOF, package main, denylist := [\"nginx\"], deny[msg] { some i, input[i].Cmd == \"from\", val := input[i].Value, contains(val[i], denylist[_]), msg = sprintf(\"unallowed image found %s\", [val]) }, EOF", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Conftest Rego Policy Example", "category": "defense", "platform": "cloud"}}
{"text": "Create and scan a disallowed Dockerfile with Conftest: cat > Dockerfile << EOF, FROM nginx:latest, EOF, docker run --rm -v $(pwd):/project openpolicyagent/conftest test Dockerfile", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Conftest Scan Disallowed Dockerfile", "category": "defense", "platform": "cloud"}}
{"text": "Create and scan an allowed Dockerfile with Conftest: cat > Dockerfile << EOF, FROM httpd, EOF, docker run --rm -v $(pwd):/project openpolicyagent/conftest test Dockerfile", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Conftest Scan Allowed Dockerfile", "category": "defense", "platform": "cloud"}}
{"text": "AWS Systems Manager Parameter Store - Store secure parameter: aws ssm put-parameter --name MyParameter --value \"secret value\" --type SecureString", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "AWS SSM Put Parameter SecureString", "category": "defense", "platform": "cloud"}}
{"text": "AWS Systems Manager Parameter Store - Retrieve parameter with decryption: aws ssm get-parameter --name MyParameter --with-decryption", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "AWS SSM Get Parameter with Decryption", "category": "defense", "platform": "cloud"}}
{"text": "Azure Key Vault - Create a Resource Group: az group create --name MyResourceGroup --location EastUS", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Azure Create Resource Group", "category": "defense", "platform": "cloud"}}
{"text": "Azure Key Vault - Create a new key in the keyvault: az keyvault create --name MyKeyVault --resource-group MyResourceGroup --location EastUS", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Azure Create Key Vault", "category": "defense", "platform": "cloud"}}
{"text": "Azure Key Vault - Show details of a key vault: az keyvault show --name MyKeyVault", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Azure Show Key Vault Details", "category": "defense", "platform": "cloud"}}
{"text": "Azure Key Vault - List Azure Key Vaults: az keyvault list --resource-group MyResourceGroup", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Azure List Key Vaults", "category": "defense", "platform": "cloud"}}
{"text": "Azure Key Vault - Delete a Key Vault: az keyvault delete --name MyKeyVault --resource-group MyResourceGroup", "metadata": {"source": "SANS_Cloud_Native_Security", "title": "Azure Delete Key Vault", "category": "defense", "platform": "cloud"}}
