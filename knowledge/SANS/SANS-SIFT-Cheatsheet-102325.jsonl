{"text": "SIFT Cheat Sheet v4.0 - POCKET REFERENCE GUIDE - SANS Institute http://dfir.sans.org - by Marcus Guevara http://sans.org/for508", "metadata": {"source": "SANS_SIFT", "title": "SIFT Cheat Sheet v4.0", "category": "dfir", "platform": "linux"}}
{"text": "This cheat sheet supports the SANS Institute's FOR508 Advanced Incident Response, Threat Hunting, and Digital Forensics course. It is intended to be used as a reference for tools commonly found in the SANS Linux SIFT Workstation. It also serves as a reminder of the many Linux-based DFIR capabilities available.", "metadata": {"source": "SANS_SIFT", "title": "Purpose", "category": "dfir", "platform": "linux"}}
{"text": "fsstat - Displays details about the file system. Usage: # fsstat imagefile.img", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - File System Layer Tools (Partition Information)", "category": "dfir", "platform": "linux"}}
{"text": "blkcat - Displays the contents of a disk block. Usage: # blkcat imagefile.img block_num", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - Data Layer Tools (Block or Cluster)", "category": "dfir", "platform": "linux"}}
{"text": "blkls - Displays contents of deleted disk blocks. Usage: # blkls imagefile.img > imagefile.blkls", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - Data Layer Tools (Block or Cluster)", "category": "dfir", "platform": "linux"}}
{"text": "blkcalc - Maps between disk images and blkls results. Usage: # blkcalc imagefile.img -u blkls_num", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - Data Layer Tools (Block or Cluster)", "category": "dfir", "platform": "linux"}}
{"text": "blkstat - Display allocation status of block. Usage: # blkstat imagefile.img block_number", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - Data Layer Tools (Block or Cluster)", "category": "dfir", "platform": "linux"}}
{"text": "ils - Displays summary information for all inodes. Usage: # ils imagefile.img", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - MetaData Layer Tools (Inode, MFT, or Directory Entry)", "category": "dfir", "platform": "linux"}}
{"text": "istat - Displays info about a specific inode. Usage: # istat imagefile.img inode_num", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - MetaData Layer Tools (Inode, MFT, or Directory Entry)", "category": "dfir", "platform": "linux"}}
{"text": "icat - Displays contents of blocks allocated to an inode. Usage: # icat imagefile.img inode_num", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - MetaData Layer Tools (Inode, MFT, or Directory Entry)", "category": "dfir", "platform": "linux"}}
{"text": "ifind - Determine which inode contains specific block. Usage: # ifind imagefile.img -d block_num", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - MetaData Layer Tools (Inode, MFT, or Directory Entry)", "category": "dfir", "platform": "linux"}}
{"text": "fls - Displays all deleted entries in the image. Usage: # fls -rpd imagefile.img", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - Filename Layer Tools", "category": "dfir", "platform": "linux"}}
{"text": "ffind - Find the filename and path for an inode. Usage: # ffind imagefile.img inode_num", "metadata": {"source": "SANS_SIFT", "title": "Sleuthkit Tools - Filename Layer Tools", "category": "dfir", "platform": "linux"}}
{"text": "tsk_recover [options] image [output_dir] - The default (without options) recovers only unallocated files. -a: Recover allocated files only. -e: Recover both allocated and unallocated files. Usage: # tsk_recover /path/to/diskimage.img /path/to/recovery/output", "metadata": {"source": "SANS_SIFT", "title": "Recovering Data - tsk_recover", "category": "dfir", "platform": "linux"}}
{"text": "photorec [options] [media] - No options or media needed for basic usage. Photorec operates through an interactive interface guiding the user step-by-step. Usage: # photorec", "metadata": {"source": "SANS_SIFT", "title": "Recovering Data - photorec", "category": "dfir", "platform": "linux"}}
{"text": "foremost -o output -c signature_file -i target - Carves (recovers) files based on header and footer signatures. Target can be raw data, slack, memory, or unallocated space. Usage: # foremost -o outputdir -c /path/to/foremost.conf -i data_file.img", "metadata": {"source": "SANS_SIFT", "title": "Recovering Data - foremost", "category": "dfir", "platform": "linux"}}
{"text": "Registry Parsing - Regripper: # rip.pl -r <HIVEFILE> -f <HIVETYPE>. Options: -r Registry hive file to parse <HIVEFILE>. -f Specify <HIVETYPE> (e.g. sam, security, software, system, ntuser). -l List all plugins. Example: # rip.pl -r /mnt/windows_mount/Windows/System32/config/SAM -f sam > /cases/SAM.txt", "metadata": {"source": "SANS_SIFT", "title": "Registry Parsing - Regripper", "category": "dfir", "platform": "linux"}}
{"text": "Mounting a VHDX Image - Load NBD Module and Enable Partition Support: # modprobe nbd max_part=16", "metadata": {"source": "SANS_SIFT", "title": "Mounting a VHDX Image - Step 1", "category": "dfir", "platform": "linux"}}
{"text": "Mounting a VHDX Image - Connect the first NBD device (nbd0) to the VHDX disk image: # qemu-nbd -c /dev/nbd0 system-triage.vhdx", "metadata": {"source": "SANS_SIFT", "title": "Mounting a VHDX Image - Step 2", "category": "dfir", "platform": "linux"}}
{"text": "Mounting a VHDX Image - Inform the OS of partition table changes to /dev/nbd0: # partprobe /dev/nbd0", "metadata": {"source": "SANS_SIFT", "title": "Mounting a VHDX Image - Step 3", "category": "dfir", "platform": "linux"}}
{"text": "Mounting a VHDX Image - Create directory and mount the first partition of the nbd device: # mkdir /mnt/system-triage mountwin /dev/nbd0p1 /mnt/system-triage", "metadata": {"source": "SANS_SIFT", "title": "Mounting a VHDX Image - Step 4", "category": "dfir", "platform": "linux"}}
{"text": "Creating a Super Timeline with Plaso and Docker - Set Up Docker Container and Create a Super Timeline: # docker run -v /path/on/host:/path/in/container -v /path/on/host:/path/in/container log2timeline/plaso:version# log2timeline.py --timezone '[TIMEZONE]' --parsers '[PARSER1,PARSER2]' --storage_file /path/to/triage.plaso <data source>", "metadata": {"source": "SANS_SIFT", "title": "Creating a Super Timeline with Plaso and Docker - Step 1", "category": "dfir", "platform": "linux"}}
{"text": "Creating a Super Timeline with Plaso and Docker - Add the Filesystem Timeline to the Super Timeline: # docker run -v /path/on/host:/path/in/container log2timeline/plaso:version# log2timeline.py --parsers 'mactime' --storage_file /path/to/triage.plaso /path/to/mftecmd-final.body", "metadata": {"source": "SANS_SIFT", "title": "Creating a Super Timeline with Plaso and Docker - Step 2", "category": "dfir", "platform": "linux"}}
{"text": "Creating a Super Timeline with Plaso and Docker - Cut Timeframe and Output Super Timeline to CSV: # docker run -v /path/on/host:/path/in/container log2timeline/plaso:version# psort.py --output-time-zone 'UTC' -o l2tcsv -w /path/to/output.csv /path/to/triage.plaso \"(((parser == 'winevtx') and (timestamp_desc == 'Creation Time')) or (parser != 'winevtx')) and ( date > datetime('YYYY-MM-DDTHH:MM:SS') AND date < datetime('YYYY-MM-DDTHH:MM:SS'))\"", "metadata": {"source": "SANS_SIFT", "title": "Creating a Super Timeline with Plaso and Docker - Step 3", "category": "dfir", "platform": "linux"}}
{"text": "Filesystem Timeline Creation - Step 1 - Extract Timeline Data Using fls: fls - from The Sleuth Kit (TSK) can extract timeline data from the metadata of file systems found within a disk image. Options: -m: sets the output format to mactime. -r: recursively lists all directories and files. -i: Specifies the type of image (raw, ewf, vhd, vmdk). -o: [starting-sector]", "metadata": {"source": "SANS_SIFT", "title": "Filesystem Timeline Creation - fls Options", "category": "dfir", "platform": "linux"}}
{"text": "Filesystem Timeline Creation - fls Example: # fls -m C: -r -i ewf /path/to/diskimage.E01 > /output/bodyfile.txt", "metadata": {"source": "SANS_SIFT", "title": "Filesystem Timeline Creation - fls Example 1", "category": "dfir", "platform": "linux"}}
{"text": "Filesystem Timeline Creation - fls Example 2: # fls -m C: -r -i raw /path/diskimage.dd > /output/bodyfile.txt", "metadata": {"source": "SANS_SIFT", "title": "Filesystem Timeline Creation - fls Example 2", "category": "dfir", "platform": "linux"}}
{"text": "Filesystem Timeline Creation - Step 2 - Create Timeline Using mactime: # mactime -d -b /output/bodyfile.txt -z EST5EDT MM-DD-YYYY..MM-DD-YYYY > /cases/timeline.csv", "metadata": {"source": "SANS_SIFT", "title": "Filesystem Timeline Creation - mactime", "category": "dfir", "platform": "linux"}}
{"text": "grep is a powerful tool used to search for specific patterns of text (regular expressions) within files. grep [options] pattern [files]", "metadata": {"source": "SANS_SIFT", "title": "Search & Filter Tools - grep", "category": "dfir", "platform": "linux"}}
{"text": "grep options: -a: Treat binary files as text files. -i: Ignore case distinctions. -v: Invert the match, i.e., only show lines that do not match. -r: Recursively search through directories. -l: List only the names of files that contain the matching pattern. -n: Prefix each line of output with the line no. in its input file. -E: Interpret pattern as an extended regular expression (ERE)", "metadata": {"source": "SANS_SIFT", "title": "Search & Filter Tools - grep options", "category": "dfir", "platform": "linux"}}
{"text": "grep Example: Reference a text file with a list of case-insensitive terms to exclude from a body file: # grep -a -v -i -f /path/to/timeline_noise.txt /input/mftecmd.body > /output/mftecmd-final.body", "metadata": {"source": "SANS_SIFT", "title": "Search & Filter Tools - grep Example 1", "category": "dfir", "platform": "linux"}}
{"text": "grep Example: Recursively search directories to list any files containing \"base64\", case-insensitive: # grep -rail \"base64\"", "metadata": {"source": "SANS_SIFT", "title": "Search & Filter Tools - grep Example 2", "category": "dfir", "platform": "linux"}}
{"text": "find is used to search for files and directories in a directory hierarchy. It can be very useful for locating files based on various criteria and performing actions on those files. find [path] [options] [expression]", "metadata": {"source": "SANS_SIFT", "title": "Search & Filter Tools - find", "category": "dfir", "platform": "linux"}}
{"text": "find options: -name pattern: Search for files matching the pattern. -type t: Search for files of type t (e.g., f for regular files). -mtime n: Search for files modified n days ago. -exec command {} \\;: Execute command on matched file. -size n: Search for files of size n (e.g., +100M). -user username: Search for files owned by username. -perm mode: Search for files with specific permissions", "metadata": {"source": "SANS_SIFT", "title": "Search & Filter Tools - find options", "category": "dfir", "platform": "linux"}}
{"text": "find Example: recursively find all files ending in .exe and calculate an MD5 for each file: # find . -type f -name \\*.exe -exec md5sum {} \\;", "metadata": {"source": "SANS_SIFT", "title": "Search & Filter Tools - find Example", "category": "dfir", "platform": "linux"}}
{"text": "Using Zimmerman Tools in SIFT: The Eric Zimmerman tool suite can now run in Linux. Installation of .NET6 is required. Download Zimmerman's Tools (.NET 6 versions) https://ericzimmerman.github.io/", "metadata": {"source": "SANS_SIFT", "title": "Using Zimmerman Tools in SIFT", "category": "dfir", "platform": "linux"}}
{"text": "Zimmerman Tools Example - EvtxECmd: # dotnet EvtxECmd.dll -f ~/evtx_files/Sample.evtx -csv ~/evtx_output", "metadata": {"source": "SANS_SIFT", "title": "Using Zimmerman Tools in SIFT - EvtxECmd", "category": "dfir", "platform": "linux"}}
{"text": "Zimmerman Tools Example - bstrings: # dotnet bstrings.dll -f ~/binary_files/sample.bin -o ~/sample_output", "metadata": {"source": "SANS_SIFT", "title": "Using Zimmerman Tools in SIFT - bstrings", "category": "dfir", "platform": "linux"}}
{"text": "Zimmerman Tools - To run from anywhere, create a location alias for each of the tools: # alias mftecmd='dotnet /path/to/tools/MFTECmd.dll' # alias bstrings='dotnet /path/to/tools/bstrings.dll'", "metadata": {"source": "SANS_SIFT", "title": "Using Zimmerman Tools in SIFT - Aliases", "category": "dfir", "platform": "linux"}}
{"text": "Mounting DD Images: mount -t fstype [-o options] image mount_location. image can be a disk partition or dd image file", "metadata": {"source": "SANS_SIFT", "title": "Mounting DD Images", "category": "dfir", "platform": "linux"}}
{"text": "Mounting DD Images - Useful options to use with \"-o\": ro (mount as read only), rw (mount as read-write), loop (mount on a loop device), no exec (do not allow execution), offset=<BYTES> (logical drive mount), show_sys_files (show ntfs metafiles), streams_interface=windows (display ADS)", "metadata": {"source": "SANS_SIFT", "title": "Mounting DD Images - Options", "category": "dfir", "platform": "linux"}}
{"text": "Mounting DD Images Example: Mount an image file at mount_location: # mount -o loop,ro,show_sys_files,streams_interface=windows diskimage.dd /mnt/windows_mount", "metadata": {"source": "SANS_SIFT", "title": "Mounting DD Images - Example", "category": "dfir", "platform": "linux"}}
{"text": "Mounting E01 Images: # ewfmount diskimage.E01 /mnt/ewf", "metadata": {"source": "SANS_SIFT", "title": "Mounting E01 Images - Step 1", "category": "dfir", "platform": "linux"}}
{"text": "Mounting E01 Images: # mount -o loop,ro,show_sys_files,streams_interface=windows /mnt/ewf/ewf1 /mnt/windows_mount", "metadata": {"source": "SANS_SIFT", "title": "Mounting E01 Images - Step 2", "category": "dfir", "platform": "linux"}}
{"text": "Mounting Windows Volume Shadow Copies - Step 1 - Access Evidence as a Raw Image (skip if not E01 format): # ewfmount diskimage.E01 /mnt/ewf", "metadata": {"source": "SANS_SIFT", "title": "Mounting Windows Volume Shadow Copies - Step 1", "category": "dfir", "platform": "linux"}}
{"text": "Mounting Windows Volume Shadow Copies - Step 2 - Access Volume Shadows Within Raw Image: # vshadowmount /mnt/ewf/ewf1 /mnt/vss/", "metadata": {"source": "SANS_SIFT", "title": "Mounting Windows Volume Shadow Copies - Step 2", "category": "dfir", "platform": "linux"}}
{"text": "Mounting Windows Volume Shadow Copies - Step 3 - Mount Filesystem Within Volume Shadows: # cd /mnt/vss # for i in vss*; do mount -o ro,loop,show_sys_files,streams_interface=windows $i /mnt/shadow_mount/$i; done", "metadata": {"source": "SANS_SIFT", "title": "Mounting Windows Volume Shadow Copies - Step 3", "category": "dfir", "platform": "linux"}}
