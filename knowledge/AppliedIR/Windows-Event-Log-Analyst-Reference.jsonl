{"text": "Modern Windows systems store logs in the %SystemRoot%\\System32\\winevt\\logs directory by default in the binary XML Windows Event Logging format, designated by the .evtx extension.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Log Storage Location", "category": "logs", "platform": "windows"}}
{"text": "Logs can also be stored remotely using log subscriptions. For remote logging, a remote system running the Windows Event Collector service subscribes to subscriptions of logs produced by other systems.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Remote Log Subscriptions", "category": "logs", "platform": "windows"}}
{"text": "The types of logs to be collected can be specified at a granular level and transport occurs over HTTPS on port 5986 using WinRM.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Remote Logging Transport", "category": "logs", "platform": "windows"}}
{"text": "Events can be logged in the Security, System and Application event logs or, on modern Windows systems, they may also appear in several other log files.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Primary Event Log Files", "category": "logs", "platform": "windows"}}
{"text": "The Setup event log records activities that occurred during installation of Windows.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Setup Event Log", "category": "logs", "platform": "windows"}}
{"text": "The Forwarded Logs event log is the default location to record events received from other systems.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Forwarded Logs Event Log", "category": "logs", "platform": "windows"}}
{"text": "Log Name: The name of the Event Log where the event is stored. Useful when processing numerous logs pulled from the same system.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Log Name", "category": "logs", "platform": "windows"}}
{"text": "Source: The service, Microsoft component or application that generated the event.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Source", "category": "logs", "platform": "windows"}}
{"text": "Event ID: A code assigned to each type of audited activity.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Event ID", "category": "logs", "platform": "windows"}}
{"text": "Level: The severity assigned to the event in question.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Level", "category": "logs", "platform": "windows"}}
{"text": "User: The user account involved in triggering the activity or the user context that the source was running as when it logged the event. Note that this field often indicates \"System\" or a user that is not the cause of the event being recorded.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - User", "category": "logs", "platform": "windows"}}
{"text": "OpCode: Assigned by the source generating the log. Its meaning is left to the source.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - OpCode", "category": "logs", "platform": "windows"}}
{"text": "Logged: The local system date and time when the event was logged.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Logged", "category": "logs", "platform": "windows"}}
{"text": "Task Category: Assigned by the source generating the log. Its meaning is left to the source.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Task Category", "category": "logs", "platform": "windows"}}
{"text": "Keywords: Assigned by the source and used to group or sort events.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Keywords", "category": "logs", "platform": "windows"}}
{"text": "Computer: The computer on which the event was logged. This is useful when examining logs collected from multiple systems, but should not be considered to be the device that caused an event.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Computer", "category": "logs", "platform": "windows"}}
{"text": "Description: A text block where additional information specific to the event being logged is recorded. This is often the most significant field for the analyst.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Field - Description", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4720: A user account was created.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4720", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4722: A user account was enabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4722", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4723: A user attempted to change an account's password.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4723", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4724: An attempt was made to reset an account's password.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4724", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4725: A user account was disabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4725", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4726: A user account was deleted.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4726", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4727: A security-enabled global group was created.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4727", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4728: A member was added to a security-enabled global group.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4728", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4729: A member was removed from a security-enabled global group.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4729", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4730: A security-enabled global group was deleted.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4730", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4731: A security-enabled local group was created.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4731", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4732: A member was added to a security-enabled local group.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4732", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4733: A member was removed from a security-enabled local group.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4733", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4734: A security-enabled local group was deleted.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4734", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4735: A security-enabled local group was changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4735", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4737: A security-enabled global group was changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4737", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4738: A user account was changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4738", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4741: A computer account was created.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4741", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4742: A computer account was changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4742", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4743: A computer account was deleted.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4743", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4754: A security-enabled universal group was created.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4754", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4755: A security-enabled universal group was changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4755", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4756: A member was added to a security-enabled universal group.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4756", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4757: A member was removed from a security-enabled universal group.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4757", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4758: A security-enabled universal group was deleted.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4758", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4798: A user's local group membership was enumerated. Large numbers of these events may be indicative of adversary account enumeration.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4798", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4799: A security-enabled local group membership was enumerated. Large numbers of these events may be indicative of adversary group enumeration.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Management Event 4799", "category": "logs", "platform": "windows"}}
{"text": "Account Logon is the Microsoft term for authentication. Logon is the term used to refer to an account gaining access to a resource.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Logon vs Logon Definition", "category": "logs", "platform": "windows"}}
{"text": "Authentication (account logon) of domain accounts is performed by a domain controller within a Windows network. Local accounts (those that exist within a local SAM file rather than as a part of Active Directory) are authenticated by the local system where they exist.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Authentication Location", "category": "logs", "platform": "windows"}}
{"text": "Account logon events will be logged by the system that performs the authentication.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Account Logon Event Location", "category": "logs", "platform": "windows"}}
{"text": "The domain controllers in your network should therefore be able to provide a fairly centralized accounting of which accounts where authenticated throughout the domain.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Domain Controller Authentication Logging", "category": "logs", "platform": "windows"}}
{"text": "If you find that member servers or workstations are performing their own authentication, that is a good indicator that local user accounts are being used. Account logon events on non-domain controllers can often be an indicator of compromise.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Local Authentication Indicator", "category": "logs", "platform": "windows"}}
{"text": "Logon event logs are generated by the system that is being accessed, so logon events will be generated by systems across the network.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Event Location", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768: The successful issuance of a TGT shows that a user account was authenticated by the domain controller. The Network Information section of the event description contains additional information about the remote host in the event of a remote logon attempt. The Keywords field indicates whether the authentication attempt was successful or failed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos TGT Event 4768", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768 result code 0x6 (Decimal 6): Username not valid.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Result Code 0x6", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768 result code 0xC (Decimal 12): Policy restriction prohibiting this logon (such as a workstation restriction or time-of-day restriction).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Result Code 0xC", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768 result code 0x12 (Decimal 18): The account is locked out, disabled, or expired.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Result Code 0x12", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768 result code 0x17 (Decimal 23): The account's password is expired.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Result Code 0x17", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768 result code 0x18 (Decimal 24): The password is incorrect.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Result Code 0x18", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768 result code 0x20 (Decimal 32): The ticket has expired (common on computer accounts).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Result Code 0x20", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4768 result code 0x25 (Decimal 37): The clock skew is too great.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Result Code 0x25", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4769: A service ticket was requested by a user account for a specified resource. This event description shows the source IP of the system that made the request, the user account used, and the service to be accessed. These events provide a useful source of evidence as they track authenticated user access across the network.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Service Ticket Event 4769", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4770: A service ticket was renewed. The account name, service name, client IP address, and encryption type are recorded.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Ticket Renewal Event 4770", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4771: Depending on the reason for a failed Kerberos logon, either Event ID 4768 or Event ID 4771 is created. In either case, the result code in the event description provides additional information about the reason for the failure.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Kerberos Pre-Auth Failure Event 4771", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776: This event ID is recorded for NTLM authentication attempts. The Network Information section of the event description contains additional information about the remote host in the event of a remote logon attempt. The Keywords field indicates whether the authentication attempt succeeded or failed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Authentication Event 4776", "category": "logs", "platform": "windows"}}
{"text": "A series of failed 4776 events with Error Code C000006A (the password is invalid) followed by an Error Code C0000234 (the account is locked out) may be indicative of a failed password guessing attack.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Password Guessing Attack Pattern", "category": "logs", "platform": "windows"}}
{"text": "A series of failed 4776 events followed by a successful 4776 event may show a successful password guessing attack.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Successful Password Guessing Pattern", "category": "logs", "platform": "windows"}}
{"text": "The presence of Event ID 4776 on a member server or client is indicative of a user attempting to authenticate to a local account on that system and may in and of itself be cause for further investigation.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Local NTLM Authentication Indicator", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC0000064: The username is incorrect.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC0000064", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC000006A: The password is incorrect.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC000006A", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC000006D: Generic logon failure. Possibly bad username or password or mismatch in the LAN Manager Authentication Level between the source and target computers.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC000006D", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC000006F: Account logon outside authorized hours.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC000006F", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC0000070: Account logon from unauthorized workstation.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC0000070", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC0000071: Account logon with expired password.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC0000071", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC0000072: Account logon to account disabled by administrator.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC0000072", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC0000193: Account logon with expired account.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC0000193", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC0000224: Account logon with Change Password At Next Logon flagged.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC0000224", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xC0000234: Account logon with account locked.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xC0000234", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4776 error code 0xc0000371: The local account store does not contain secret material for the specified account.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "NTLM Error Code 0xc0000371", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4624: A logon to a system has occurred. Type 2 indicates an interactive (usually local) logon, whereas a Type 3 indicates a remote or network logon. The event description will contain information about the host and account name involved.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Successful Logon Event 4624", "category": "logs", "platform": "windows"}}
{"text": "For remote logons, focus on the Network Information section of the event description for remote host information. Correlation with the associated 4768, 4769, or 4776 events may yield additional details about a remote host.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Remote Logon Network Information", "category": "logs", "platform": "windows"}}
{"text": "Discrepancies in the record entry between the recorded hostname and its assigned IP address may be indicative of Server Message Block (SMB) relay attacks, where an attacker relays a request from one system using an IP address not associated with that system.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "SMB Relay Attack Indicator", "category": "logs", "platform": "windows"}}
{"text": "The Caller Process Name and Caller Process ID fields in the Process Information section of the event description can provide additional details about the process initiating the logon.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Process Information", "category": "logs", "platform": "windows"}}
{"text": "Successful Remote Desktop Protocol (RDP) connections usually log as Logon Type 10 in Event ID 4624. This records a successful remote interactive logon and may result in the user's credentials being cached in RAM and possibly on disk.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "RDP Logon Type 10", "category": "logs", "platform": "windows"}}
{"text": "Failed RDP logons usually result in Logon Type 3.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Failed RDP Logon Type", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 2: Interactive, such as logon at keyboard and screen of the system, or remotely using third-party remote access tools like VNC, or psexec with the -u switch. Logons of this type will cache the user's credentials in RAM for the duration of the session and may cache the user's credentials on disk.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 2 - Interactive", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 3: Network, such as access to a shared folder on this computer from elsewhere on the network. This represents a noninteractive logon, which does not cache the user's credentials in RAM or on disk.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 3 - Network", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 4: Batch (indicating a scheduled task). Batch logon type is used by batch servers, where processes may be executing on behalf of a user without their direct intervention.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 4 - Batch", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 5: Service indicates that a service was started by the Service Control Manager.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 5 - Service", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 7: Unlock indicates that an unattended workstation with a password protected screen is unlocked.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 7 - Unlock", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 8: NetworkCleartext indicates that a user logged on to this computer from the network and the user's password was passed to the authentication package in its unhashed form. Most often indicates a logon to Internet Information Services (IIS) with basic authentication.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 8 - NetworkCleartext", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 9: NewCredentials indicates that a user logged on with alternate credentials to perform actions such as with RunAs or mapping a network drive. If you want to track users attempting to log on with alternate credentials, also look for Event ID 4648.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 9 - NewCredentials", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 10: RemoteInteractive indicates that Terminal Services, Remote Desktop, or Remote Assistance for an interactive logon.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 10 - RemoteInteractive", "category": "logs", "platform": "windows"}}
{"text": "Logon Type 11: CachedInteractive (logon with cached domain credentials such as when logging on to a laptop when away from the network). The domain controller was not contacted to verify the credential, so no account logon entry is generated.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Type 11 - CachedInteractive", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625: A failed logon attempt. Large numbers of these throughout a network may be indicative of password guessing or password spraying attacks.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Failed Logon Event 4625", "category": "logs", "platform": "windows"}}
{"text": "Note that failed logons over RDP may log as Type 3 rather than Type 10, depending on the systems involved.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Failed RDP Logon Type Note", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC000005E: Currently no logon servers are available to service the logon request.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC000005E", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC0000064: User logon with misspelled or bad user account.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC0000064", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC000006A: User logon with misspelled or bad password.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC000006A", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC000006D: This is either due to a bad username or incorrect authentication information.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC000006D", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC000006E: Unknown username or bad password.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC000006E", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC000006F: User logon outside authorized hours.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC000006F", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC0000070: User logon from unauthorized workstation.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC0000070", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC0000071: User logon with expired password.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC0000071", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC0000072: User logon to account disabled by administrator.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC0000072", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC00000DC: Indicates the Server was in the wrong state to perform the desired operation.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC00000DC", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC0000133: Clocks between domain controller and other computer too far out of sync.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC0000133", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC000015B: The user has not been granted the requested logon type (also known as logon right) at this machine.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC000015B", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC000018C: The logon request failed because the trust relationship between the primary domain and the trusted domain failed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC000018C", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC0000192: An attempt was made to log on, but the Netlogon service was not started.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC0000192", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC0000193: User logon with expired account.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC0000193", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC0000224: User is required to change password at next logon.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC0000224", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC0000225: Evidently a bug in Windows and not a risk.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC0000225", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0xC0000234: User logon with account locked.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0xC0000234", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC00002EE: Failure Reason: An error occurred during logon.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC00002EE", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4625 status code 0XC0000413: Logon Failure: The machine you are logging on to is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon Failure Status 0XC0000413", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4634/4647: User logoff is recorded by Event ID 4634 or Event ID 4647. The lack of an event showing a logoff should not be considered overly suspicious, as Windows is inconsistent in logging Event ID 4634 in many cases.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logoff Events 4634/4647", "category": "logs", "platform": "windows"}}
{"text": "The Logon ID field can be used to tie the Event ID 4624 logon event with the associated logoff event (the Logon ID is unique between reboots on the same computer).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Logon ID Field Usage", "category": "logs", "platform": "windows"}}
{"text": "Type 3 (Network) logons will typically disconnect shortly after a request is complete and do not indicate the actual amount of time that a user was engaged in any particular activity.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Network Logon Duration", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4648: A logon was attempted using explicit credentials. When a user attempts to use credentials other than the ones used for the current logon session (including bypassing User Account Control [UAC] to open a process with administrator permissions), this event is logged.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Explicit Credentials Event 4648", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4672: This event ID is recorded when certain privileges associated with elevated or administrator access are granted to a logon. As with all logon events, the event log will be generated by the system being accessed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Special Privileges Event 4672", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4778: This event is logged when a session is reconnected to a Windows station. This can occur locally when the user context is switched via fast user switching. It can also occur when a session is reconnected over RDP.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Session Reconnect Event 4778", "category": "logs", "platform": "windows"}}
{"text": "To differentiate between RDP versus local session switching, look at the Session Name field within the event description. If local, the field will contain Console, and if remote, it will begin with RDP.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "RDP vs Local Session Detection", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4779: This event is logged when a session is disconnected. This can occur locally when the user context is switched via fast user switching. It can also occur when a session is reconnected over RDP.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Session Disconnect Event 4779", "category": "logs", "platform": "windows"}}
{"text": "Additional information about RDP Sessions can be found in the %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational log file.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "RDP LocalSessionManager Log Location", "category": "logs", "platform": "windows"}}
{"text": "Event ID 21 in the TerminalServices-LocalSessionManager log shows session logon events, both local and remote, including the IP from which the connection was made if remote.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Terminal Services Event 21", "category": "logs", "platform": "windows"}}
{"text": "Event ID 24 in the TerminalServices-LocalSessionManager log shows session disconnection, including the IP from which the connection was made if remote.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Terminal Services Event 24", "category": "logs", "platform": "windows"}}
{"text": "Information about RDP Sessions can also be found in the %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational log file. Event ID 1149 in this log will show the user account and source IP used to initiate an RDP session.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "RDP RemoteConnectionManager Event 1149", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5140: A network share object was accessed. The event entry provides the account name and source address of the account that accessed the object. Note that this entry will show that the share was accessed but not what files in the share were accessed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Network Share Access Event 5140", "category": "logs", "platform": "windows"}}
{"text": "A large number of Event ID 5140 events from a single account may be an indicator of an account being used to harvest or map data on the network.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Share Access Harvesting Indicator", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5142: A network share object was added.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Network Share Added Event 5142", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5143: A network share object was modified.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Network Share Modified Event 5143", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5144: A network share object was deleted.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Network Share Deleted Event 5144", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5145: A network share object was checked to see whether client can be granted desired access. Failure is only logged if the permission is denied at the file share level. If permission is denied at the NTFS level then no entry is recorded.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Network Share Permission Check Event 5145", "category": "logs", "platform": "windows"}}
{"text": "The system initiating the access may also show evidence of the connections in the registry key NTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MountPoints2.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "MountPoints2 Registry Key", "category": "logs", "platform": "windows"}}
{"text": "Event ID 106: Scheduled Task Created. The entry shows the user account that scheduled the task and the name the user assigned to the task. The Logged date and time show when the task was scheduled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Created Event 106", "category": "logs", "platform": "windows"}}
{"text": "Event ID 140: Scheduled Task Updated. The entry shows the user account that updated the task and the name of the task. The Logged date and time show when the task was updated.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Updated Event 140", "category": "logs", "platform": "windows"}}
{"text": "Event ID 141: Scheduled Task Deleted. The entry shows the user account that deleted the task and the name of the task.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Deleted Event 141", "category": "logs", "platform": "windows"}}
{"text": "Event ID 200: Scheduled Task Executed. Shows the task name and the full path to the executable on disk that was run (listed as the Action).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Executed Event 200", "category": "logs", "platform": "windows"}}
{"text": "Event ID 201: Scheduled Task Completed. Shows the task name and the full path to the executable on disk that was run (listed as the Action).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Completed Event 201", "category": "logs", "platform": "windows"}}
{"text": "Scheduled task history is stored in %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-TaskScheduler%4Operational log.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Task Scheduler Log Location", "category": "logs", "platform": "windows"}}
{"text": "Object access auditing is not enabled by default but should be enabled on sensitive systems. To do so, simply set use the Local Security Policy to set Security Settings -> Local Policies -> Audit Policy -> Audit object access to Enabled for Success and Failure.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Enable Object Access Auditing", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4698: A scheduled task was created. The event description contains the user account that created the task in the Subject section. XML details of the scheduled task are also recorded in the event description under the Task Description section.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Created Security Event 4698", "category": "logs", "platform": "windows"}}
{"text": "In Event ID 4698, the <Author> tag shows the user that originally created the task, this does not change if another user later updates the task.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Author Tag", "category": "logs", "platform": "windows"}}
{"text": "In Event ID 4698, the <User ID> shows the user context under which the task will run, which may be different than the account used to schedule the task. If <Logon Type> shows Password, then the password for the account was entered at the time the task was scheduled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task User Context", "category": "logs", "platform": "windows"}}
{"text": "In Event ID 4698, the <Command> shows the path to the executable that will run. Any arguments specified will be listed in the <Arguments> tag.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Command Tag", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4699: A scheduled task was deleted. The Subject section of the event description contains the Account Name that deleted the task as well as the Task Name.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Deleted Security Event 4699", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4700: A scheduled task was enabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Enabled Event 4700", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4701: A scheduled task was disabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Disabled Event 4701", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4702: A scheduled task was updated. The user who initiated the update appears in the Subject section of the event description. The details of the task after its modification are listed in the XML in the event description.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Scheduled Task Updated Security Event 4702", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4656: A handle to an object was requested. When a process attempts to gain a handle to an audited object, this event is created. The details of the object to which the handle was requested and the handle ID assigned to the handle are listed in the Object section of the event description.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Object Handle Requested Event 4656", "category": "logs", "platform": "windows"}}
{"text": "Obtaining a handle to an object does not mean that all the permissions requested were actually used. Look for additional Event ID 4663 entries with the same Handle ID to determine which permissions were used.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Handle vs Access Distinction", "category": "logs", "platform": "windows"}}
{"text": "The Handle ID is kept unique between reboots on the same computer.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Handle ID Uniqueness", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4657: A registry value was modified. The user account and process responsible for opening the handle are listed in the event description. The Object Name field indicates the full path and name of the registry key where the value was modified.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Registry Value Modified Event 4657", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4657 generates only when a key value is modified, not if the key itself is modified.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Registry Modification Scope", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4658: The handle to an object was closed. The user account and process responsible for opening the handle are listed in the event description.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Object Handle Closed Event 4658", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4660: An object was deleted. The user account and process responsible for opening the handle are listed in the event description.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Object Deleted Event 4660", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4663: An attempt was made to access an object. This event is logged when a process attempts to interact with an object, rather than just obtain a handle to the object.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Object Access Attempt Event 4663", "category": "logs", "platform": "windows"}}
{"text": "Since Windows 8/Server 2012, additional logging can be enabled via Audit Removeable Storage policy. Once enabled, Windows will create additional Event ID 4663 entries whenever an account accesses a file system object that is on removable storage.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Removable Storage Auditing", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4719: System audit policy was changed. The Audit Policy Change section will list the specific changes that were made to the audit policy.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Audit Policy Changed Event 4719", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1102: Regardless of the settings in the audit policy, if the Security event log is cleared, Event ID 1102 will be recorded as the first entry in the new, blank log. You can tell the name of the user account that cleared the log in the details of the entry.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Security Log Cleared Event 1102", "category": "logs", "platform": "windows"}}
{"text": "A similar event, with ID 104, is generated in the System log if it is cleared.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "System Log Cleared Event 104", "category": "logs", "platform": "windows"}}
{"text": "Event ID 6005: The event log service was started. This will occur at system boot time, and whenever the system is manually started.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Log Service Started Event 6005", "category": "logs", "platform": "windows"}}
{"text": "Event ID 6006: The event log service was stopped. While this obviously occurs at system shutdown or restart, its occurrence at other times may be indicative of malicious attempts to avoid logging of activity or to modify the logs.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Event Log Service Stopped Event 6006", "category": "logs", "platform": "windows"}}
{"text": "Event ID 7034: A service terminated unexpectedly. The event description will display the name of the services and may display the number of times that this service has crashed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Service Crashed Event 7034", "category": "logs", "platform": "windows"}}
{"text": "Event ID 7036: A service was stopped or started. The event description provides the name of the service, but no details of which user account requested the service to stop is provided.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Service State Change Event 7036", "category": "logs", "platform": "windows"}}
{"text": "Event ID 7040: The start type for a service was changed. The event description will display the name of the service that was changed and describe the change that was made.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Service Start Type Changed Event 7040", "category": "logs", "platform": "windows"}}
{"text": "Event ID 7045: A service was installed by the system. The name of the service is found in the Service Name field of the event description, and the full path to the associated executable is found in the Service File Name field.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Service Installed Event 7045", "category": "logs", "platform": "windows"}}
{"text": "Many tools, such as psexec, create a service on the remote system to execute commands. Many of these tools will create a randomly named service (which stands out in the logs as highly unusual) or will run an executable from locations like the Temp folder.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Psexec Service Creation Pattern", "category": "logs", "platform": "windows"}}
{"text": "If you have enabled Advanced Audit Policy Configuration > System Audit Policies > System > Audit Security System Extension in your GPOs, Windows 10 and Server 2016/2019 systems will also record Event ID 4697 in the Security event log.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Security System Extension Event 4697", "category": "logs", "platform": "windows"}}
{"text": "The WLAN log is located at %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-WLAN-AutoConfig%4Operational.evtx.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WLAN Log Location", "category": "logs", "platform": "windows"}}
{"text": "Event ID 8001: WLAN service has successfully connected to a wireless network. The event description provides the Connection Mode indicating if this was an automatic connection based on a configured profile or a manual connection.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WLAN Connected Event 8001", "category": "logs", "platform": "windows"}}
{"text": "Event ID 8002: WLAN service failed to connect to a wireless network. The event description will contain the Connection Mode, associated Profile Name, and the SSID along with a Failure Reason field.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WLAN Connection Failed Event 8002", "category": "logs", "platform": "windows"}}
{"text": "Unlike many Linux shells (such as bash) the Windows cmd.exe shell does not maintain a history of commands run by users.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Windows Command History Limitation", "category": "logs", "platform": "windows"}}
{"text": "To enable process tracking, set Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Audit Policy -> Audit process tracking.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Enable Process Tracking Auditing", "category": "logs", "platform": "windows"}}
{"text": "To capture the command line in process creation events, enable Computer Configuration -> Administrative Templates -> System -> Audit Process Creation -> Include command line in process creation events.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Enable Command Line Logging", "category": "logs", "platform": "windows"}}
{"text": "Keep in mind that some command line arguments may contain sensitive information such as passwords, so secure access to such logs accordingly.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Command Line Security Consideration", "category": "logs", "platform": "windows"}}
{"text": "Event ID 4688: A new process has been created. The event description provides the Process ID and Process Name, Creator Process ID, Creator Process Name, and Process Command Line (if enabled separately).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Process Creation Event 4688", "category": "logs", "platform": "windows"}}
{"text": "In Windows 10 and Server 2016/2019, Event ID 4688 provides details about the Creator Subject and the Target Subject.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Process Creation Subject Fields", "category": "logs", "platform": "windows"}}
{"text": "Token Elevation Type 1 indicates a full token, with all privileges available to that user account, such as when the user is the built-in administrator account or User Access Control (UAC) is disabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Token Elevation Type 1", "category": "logs", "platform": "windows"}}
{"text": "Token Elevation Type 2 indicates that a full token was issued by the user specifying to bypass UAC, such as through the Run As Administrator option.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Token Elevation Type 2", "category": "logs", "platform": "windows"}}
{"text": "Token Elevation Type 3 indicates that administrator privileges were removed due to UAC.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Token Elevation Type 3", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5031: The Windows Firewall Service blocked an application from accepting incoming connections on the network.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Firewall Blocked Incoming Event 5031", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5152: The WFP blocked a packet.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WFP Blocked Packet Event 5152", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5154: The WFP has permitted an application or service to listen on a port for incoming connections.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WFP Permitted Listen Event 5154", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5156: The WFP has allowed a connection.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WFP Allowed Connection Event 5156", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5157: The WFP has blocked a connection.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WFP Blocked Connection Event 5157", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5158: The WFP has permitted a bind to a local port.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WFP Permitted Bind Event 5158", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5159: The WFP has blocked a bind to a local port.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "WFP Blocked Bind Event 5159", "category": "logs", "platform": "windows"}}
{"text": "AppLocker event logs are stored in C:\\Windows\\System32\\winevt\\Logs and have names such as Microsoft-Windows-AppLocker%4EXE and DLL.evtx.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "AppLocker Log Location", "category": "logs", "platform": "windows"}}
{"text": "Windows Defender maintains an event log located at C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-Windows Defender%4Operational.evtx.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Windows Defender Log Location", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1006: The antimalware engine found malware or other potentially unwanted software.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Malware Found Event 1006", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1007: The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Action Performed Event 1007", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1008: The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Action Failed Event 1008", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1013: The antimalware platform deleted history of malware and other potentially unwanted software.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender History Deleted Event 1013", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1015: The antimalware platform detected suspicious behavior.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Suspicious Behavior Event 1015", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1116: The antimalware platform detected malware or other potentially unwanted software.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Malware Detected Event 1116", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1117: The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Protection Action Event 1117", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1118: The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Protection Failed Event 1118", "category": "logs", "platform": "windows"}}
{"text": "Event ID 1119: The antimalware platform encountered a critical error when trying to take action on malware or other potentially unwanted software.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Critical Error Event 1119", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5001: Real-time protection is disabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Real-time Disabled Event 5001", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5004: The real-time protection configuration changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Config Changed Event 5004", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5007: The antimalware platform configuration changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Platform Config Changed Event 5007", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5010: Scanning for malware and other potentially unwanted software is disabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Scanning Disabled Event 5010", "category": "logs", "platform": "windows"}}
{"text": "Event ID 5012: Scanning for viruses is disabled.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Defender Virus Scanning Disabled Event 5012", "category": "logs", "platform": "windows"}}
{"text": "Windows exploit protection logs its activities in the C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-Security-Mitigations%4KernelMode.evtx and Microsoft-Windows-Security-Mitigations%4UserMode.evtx log files.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Exploit Protection Log Location", "category": "logs", "platform": "windows"}}
{"text": "Sysmon creates logs presented in Event Viewer under Applications and Services Logs\\Microsoft\\Windows\\Sysmon\\Operational and is stored in C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-Sysmon%4Operational.evtx.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Log Location", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 1: Process creation (includes many details such as process ID, path to executable, hash of executable, command line used to launch, user account used to launch, parent process ID, path and command line for parent executable, and more).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Process Creation Event 1", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 2: A process changed a file creation time.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon File Time Change Event 2", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 3: Network connection.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Network Connection Event 3", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 4: Sysmon service state changed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Service State Event 4", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 5: Process terminated.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Process Terminated Event 5", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 6: Driver loaded.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Driver Loaded Event 6", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 7: Image loaded (records when a module is loaded in a specific process).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Image Loaded Event 7", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 8: CreateRemoteThread (creating a thread in another process).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon CreateRemoteThread Event 8", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 9: RawAccessRead (raw access to drive data using \\\\.\\  notation).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon RawAccessRead Event 9", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 10: ProcessAccess (opening access to another process's memory space).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon ProcessAccess Event 10", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 11: FileCreate (creating or overwriting a file).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon FileCreate Event 11", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 12: Registry key or value created or deleted.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Registry Create/Delete Event 12", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 13: Registry value modification.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Registry Modification Event 13", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 14: Registry key or value renamed.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Registry Renamed Event 14", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 15: FileCreateStreamHash (creation of an alternate data stream).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon ADS Creation Event 15", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 16: Sysmon configuration change.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Config Change Event 16", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 17: Named pipe created.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Named Pipe Created Event 17", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 18: Named pipe connected.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Named Pipe Connected Event 18", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 19: WMIEventFilter activity detected.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon WMI Filter Event 19", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 20: WMIEventConsumer activity detected.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon WMI Consumer Event 20", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 21: WMIEventConsumerToFilter activity detected.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon WMI Binding Event 21", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 22: DNS query event (Windows 8 and later).", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon DNS Query Event 22", "category": "logs", "platform": "windows"}}
{"text": "Sysmon Event ID 255: Sysmon error.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Sysmon Error Event 255", "category": "logs", "platform": "windows"}}
{"text": "PowerShell logging must be enabled via Group Policy at Computer Configuration -> Policies -> Administrative Templates -> Windows Components -> Windows PowerShell.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Logging GPO Location", "category": "logs", "platform": "windows"}}
{"text": "Module Logging: Logs pipeline execution events; Logs to event logs.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Module Logging", "category": "logs", "platform": "windows"}}
{"text": "Script Block Logging: Captures de-obfuscated commands sent to PowerShell; Captures the commands only, not the resulting output; Logs to event logs.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Script Block Logging", "category": "logs", "platform": "windows"}}
{"text": "Transcription: Captures PowerShell input and output; Will not capture output of outside programs that are run, only PowerShell; Logs to text files in user specified location.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Transcription", "category": "logs", "platform": "windows"}}
{"text": "PowerShell event log entries appear in %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-PowerShell%4Operational.evtx.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Operational Log Location", "category": "logs", "platform": "windows"}}
{"text": "PowerShell Event ID 4103: Shows pipeline execution from the module logging facility. Includes the user context used to run the commands. Hostname field will contain Console if executed locally or will show if run from a remote system.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Pipeline Event 4103", "category": "logs", "platform": "windows"}}
{"text": "PowerShell Event ID 4104: Shows script block logging entries. Captures the commands sent to PowerShell, but not the output. Logs full details of each block only on first use to conserve space. Will show as a Warning level event if Microsoft deems the activity Suspicious.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Script Block Event 4104", "category": "logs", "platform": "windows"}}
{"text": "Additional PowerShell entries can be found in %SystemRoot%\\System32\\winevt\\Logs\\Windows PowerShell.evtx.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "Windows PowerShell Log Location", "category": "logs", "platform": "windows"}}
{"text": "PowerShell Event ID 400: Indicates the start of command execution or session. Hostname field shows if (local) Console or the remote session that caused the execution.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Session Start Event 400", "category": "logs", "platform": "windows"}}
{"text": "PowerShell Event ID 800: Shows pipeline execution details. UserID shows account used. Hostname field shows if (local) Console or the remote session that caused the execution. Since many malicious scripts encode options with Base64, check the HostApplication field for options encoded with the -enc or -EncodedCommand parameter.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Pipeline Details Event 800", "category": "logs", "platform": "windows"}}
{"text": "Remember that PowerShell Remoting requires authenticated access, so look for the associated Account Logon and Logon events as well.", "metadata": {"source": "AIR_Windows_Event_Log", "title": "PowerShell Remoting Authentication", "category": "logs", "platform": "windows"}}
