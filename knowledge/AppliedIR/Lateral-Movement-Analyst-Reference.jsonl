{"text": "Client-side attacks through phishing, rogue Wi-Fi access points, USB drops, and even physical attacks on unattended devices have become a common attack vector.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Client-Side Attack Vectors", "category": "attack", "platform": "windows"}}
{"text": "As IT teams have improved their ability to secure network perimeters, the use of external attacks to exploit vulnerabilities has grown increasingly difficult for attackers.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Network Perimeter Security Impact", "category": "attack", "platform": "windows"}}
{"text": "Attacks routinely target clients through phishing emails or social media posts designed to entice a user to click on a link, executable or macro to run malicious code.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Phishing Attack Methods", "category": "attack", "platform": "windows"}}
{"text": "Advanced threat actors proactively target hotel Wi-Fi infrastructure (such as hotels and cafes) to perform man-in-the-middle attacks and introduce malicious software onto unsuspecting business traveler's phones and laptops, or steal credentials as they pass through the rogue Wi-Fi access points to later gain access to corporate network resources.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Rogue Wi-Fi Attacks", "category": "attack", "platform": "windows"}}
{"text": "BYOD programs that allow users unrestricted use of a personal device that is then allowed to connect to a secure, internal network have only increased the effectiveness of client-side attacks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "BYOD Security Risks", "category": "attack", "platform": "windows"}}
{"text": "Once a client system is compromised, attackers will set to work to collect credentials from that machine.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Post-Compromise Credential Collection", "category": "attack", "platform": "windows"}}
{"text": "Using tools such as Metasploit's Meterpreter, Mimikatz, Mimikittenz, Windows Credential Editor, key loggers, sniffers and others, attackers are able to capture credentials such as user names and passwords from client systems or off the wire when the client returns to the corporate network.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Credential Theft Tools", "category": "attack", "platform": "windows"}}
{"text": "Credentials do not need to be full username and cleartext password pairs. Attackers can steal hashed representations of passwords, load them into memory, and allow Windows passthrough authentication to handle authentication to other systems as an arbitrary user through pass-the-hash attacks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Pass-the-Hash Attacks", "category": "attack", "platform": "windows"}}
{"text": "Even with multifactor authentication in use, after a user has authenticated an attacker can steal authenticated Kerberos service tickets to impersonate the user and access remote systems.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Kerberos Ticket Theft", "category": "attack", "platform": "windows"}}
{"text": "These service tickets are issued with a 10-hour validity by default, giving an attacker ample time to leverage completed authentication to access networked resources.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Kerberos Ticket Validity", "category": "attack", "platform": "windows"}}
{"text": "Attackers who compromise your domain controller may be able to impersonate the Kerberos service itself, granting themselves a so called \"Golden Ticket\" capable of issuing credentials for any resource in the Kerberos realm.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Golden Ticket Attack", "category": "attack", "platform": "windows"}}
{"text": "While many of the attacks mentioned above focus on Windows, don't forget that other operating systems are not immune to similar attacks. Whether using RDP or ssh, an attacker with valid credentials is able to wreak havoc within your internal network.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Cross-Platform Credential Attacks", "category": "attack", "platform": "windows"}}
{"text": "No matter how \"Next generation\" your security product may be, attackers are already working on ways to bypass it. Layered security best practices still apply, so combining antivirus, white listing, and heuristic detection with strong auditing policies is the best approach.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Layered Security Defense", "category": "defense", "platform": "windows"}}
{"text": "Give users accounts with the least privilege necessary to perform tasks. This includes any administrator accounts you may use within your environment.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Least Privilege Principle", "category": "defense", "platform": "windows"}}
{"text": "Don't use your Enterprise Administrator account for common admin functions. Instead create administrative accounts with specific organizational units or tasks in mind and use the account with the least privilege needed to accomplish each task.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Administrative Account Segmentation", "category": "defense", "platform": "windows"}}
{"text": "If the box you log onto has been compromised, the attacker can scrape your administrative credentials out of memory, giving them access to anything that your account can access.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Memory Credential Scraping Risk", "category": "attack", "platform": "windows"}}
{"text": "Consider the use of secure administrative workstations for privileged account access rather than using your daily-use workstation for administrative tasks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Secure Administrative Workstations", "category": "defense", "platform": "windows"}}
{"text": "Attackers will target administrators' computers knowing that key stroke loggers and RAM scraping tools on those systems may lead to credentials for elevated accounts.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Administrator Targeting", "category": "attack", "platform": "windows"}}
{"text": "By using a hardened, restricted-access system with additional inbound connection controls to perform your administrative logons, you make it that much harder for an attacker to obtain the privileged credentials he is seeking.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Hardened Admin Systems", "category": "defense", "platform": "windows"}}
{"text": "Don't allow your web apps to use weak password hashing algorithms such as unsalted MD5 to store credentials.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Password Hashing Requirements", "category": "defense", "platform": "windows"}}
{"text": "If credentials are lost, be sure you are monitoring the inside of your network to detect their use. Workstations usually logon to a handful of servers in your environment. When you see a workstation suddenly authenticating to other workstations or to servers that it has never accessed before, that should be a clue.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Internal Network Monitoring", "category": "defense", "platform": "windows"}}
{"text": "Too many organizations simply are not monitoring internal user activity, and attackers are heavily leveraging this blind spot.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Internal Monitoring Gap", "category": "defense", "platform": "windows"}}
{"text": "Account Logon is the Microsoft term for authentication. Logon is the term used to refer to an account gaining access to a resource.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Account Logon vs Logon Definition", "category": "forensics", "platform": "windows"}}
{"text": "Both Account Logon and Logon events will be recorded in the Security event log.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Security Event Log Location", "category": "forensics", "platform": "windows"}}
{"text": "Authentication (account logon) of domain accounts is performed by a domain controller within a Windows network.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Domain Authentication", "category": "forensics", "platform": "windows"}}
{"text": "Local accounts (those that exist within a local SAM file rather than as a part of Active Directory) are authenticated by the local system where they exist.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Local Account Authentication", "category": "forensics", "platform": "windows"}}
{"text": "Account logon events will be logged by the system that performs the authentication.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Account Logon Event Location", "category": "forensics", "platform": "windows"}}
{"text": "Auditing of Account Logon and Logon events is easily set by Group Policy.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Group Policy Auditing", "category": "defense", "platform": "windows"}}
{"text": "The ability to store event logs on remote systems (either using the native Microsoft remote logging features or third-party SIEM or other tools) helps safeguard logs from alteration or destruction.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Remote Log Storage", "category": "defense", "platform": "windows"}}
{"text": "The domain controllers in your network should therefore be able to provide a fairly centralized accounting of which accounts where authenticated throughout the domain.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Domain Controller Centralized Logging", "category": "forensics", "platform": "windows"}}
{"text": "To get a full picture, you will need to query each of your DCs since the one that performs the authentication creates the associated event log.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Multiple DC Log Collection", "category": "forensics", "platform": "windows"}}
{"text": "If you find that member servers or workstations are performing their own authentication, that is a good indicator that local user accounts are being used.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Local Account Usage Indicator", "category": "forensics", "platform": "windows"}}
{"text": "Account logon events on non-domain controllers can often be an indicator of compromise.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Non-DC Account Logon IOC", "category": "forensics", "platform": "windows"}}
{"text": "Logon event logs are generated by the system that is being accessed, so logon events will be generated by systems all across the network, providing another reason to aggregate logs to a central location.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Logon Event Distribution", "category": "forensics", "platform": "windows"}}
{"text": "4768 - The issuance of a Ticket Granting Ticket (TGT) shows that a particular user account was authenticated by the domain controller.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4768 TGT Issuance", "category": "forensics", "platform": "windows"}}
{"text": "4769 - A service ticket was issued to a particular user account for a specified resource. This event will show the source IP of the system that made the request, the user account used, and the service to be accessed. These events provide a useful source of evidence as they track authenticated user access across the network.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4769 Service Ticket", "category": "forensics", "platform": "windows"}}
{"text": "4776 - While less common in a domain environment, NTLM may still be used for authentication. Additionally, many attack tools downgrade authentication attempts to NTLM when authenticating.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4776 NTLM Authentication", "category": "forensics", "platform": "windows"}}
{"text": "4624 - A logon to a system has occurred. Type 2 indicates an interactive (local) logon, while a Type 3 indicates a remote or network logon.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4624 Logon Types", "category": "forensics", "platform": "windows"}}
{"text": "4625 - A failed logon attempt.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4625 Failed Logon", "category": "forensics", "platform": "windows"}}
{"text": "4672 - This Event ID is recorded when certain privileges associated with elevated or administrator access are granted to a logon. As with all logon events, the event log will be generated by the system being accessed.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4672 Special Privileges", "category": "forensics", "platform": "windows"}}
{"text": "4776 - An NTLM-based authentication has occurred. When found on a non-domain controller this indicates the use of a local user account. Since most domains are designed to use domain rather than local user accounts, the presence of this Event ID on member servers or client workstations is frequently suspicious.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4776 on Non-DC", "category": "forensics", "platform": "windows"}}
{"text": "4634/4647 - User logoff is recorded by Event ID 4634 or Event ID 4647. The lack of an event showing a logoff should not be considered overly suspicious, as Windows is inconsistent in logging event 4634 in many cases.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4634 4647 Logoff", "category": "forensics", "platform": "windows"}}
{"text": "If a new account is created, Event ID 4720 will be created on a domain controller for a domain account or on the local system for a local account.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4720 Account Creation", "category": "forensics", "platform": "windows"}}
{"text": "On the system being accessed Event ID 5140, a network share object was accessed, will show when a shared folder or other shared object is accessed. The event entry provides the account name and source address of the account that accessed the object.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 5140 Share Access", "category": "forensics", "platform": "windows"}}
{"text": "The system initiating the access may show evidence of the connections in the registry key NTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MountPoints2.", "metadata": {"source": "AIR_Lateral_Movement", "title": "MountPoints2 Registry Artifact", "category": "forensics", "platform": "windows"}}
{"text": "If RDP is routinely used by your administrators, help desk, or others it provides an attractive attack vector for adversaries who are trying to blend in with standard network activity.", "metadata": {"source": "AIR_Lateral_Movement", "title": "RDP Attack Vector", "category": "attack", "platform": "windows"}}
{"text": "An attacker can use the Microsoft Remote Desktop Connection (mstsc.exe) tool to access a victim system.", "metadata": {"source": "AIR_Lateral_Movement", "title": "mstsc.exe for RDP Attacks", "category": "attack", "platform": "windows"}}
{"text": "While you hopefully are not exposing the default port 3389 to the Internet, port forwarding set up as a pivot on other, Internet accessible systems does make this possible from either external or internal hosts.", "metadata": {"source": "AIR_Lateral_Movement", "title": "RDP Port Forwarding Pivot", "category": "attack", "platform": "windows"}}
{"text": "4624 - The logon event will show either a Type 10 or Type 3 when RDP is used, depending on the versions of Windows used and their specific configuration.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4624 RDP Logon Types", "category": "forensics", "platform": "windows"}}
{"text": "4778 - This event is logged when a session is reconnected to a Windows station. This can occur locally when the user context is switched via fast user switching. It can also occur when a session is reconnected over RDP.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4778 Session Reconnect", "category": "forensics", "platform": "windows"}}
{"text": "To differentiate between RDP versus local session switching, look at the Session Name field within the event description. If local, the field will contain Console, and if remote, it will begin with RDP.", "metadata": {"source": "AIR_Lateral_Movement", "title": "RDP vs Local Session Detection", "category": "forensics", "platform": "windows"}}
{"text": "4779 - This event is logged when a session is disconnected. This can occur locally when the user context is switched via fast user switching. It can also occur when a session is reconnected over RDP. A full logoff from an RDP session is logged with Event ID 4637 or 4647.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4779 Session Disconnect", "category": "forensics", "platform": "windows"}}
{"text": "The %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational log may contain the IP address and logon user name of the originating computer in Event IDs 21, 22 or 25. Event ID 41 may also contain the logon user name.", "metadata": {"source": "AIR_Lateral_Movement", "title": "TerminalServices-LocalSessionManager Log", "category": "forensics", "platform": "windows"}}
{"text": "The %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational log may record Event ID 1149 that contains the initiating IP address and logon user name.", "metadata": {"source": "AIR_Lateral_Movement", "title": "TerminalServices-RemoteConnectionManager Log", "category": "forensics", "platform": "windows"}}
{"text": "The %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-RemoteDesktopServices-RdpCoreTS%4Operational log may record Event ID 131 containing the initiating IP address and logon user name.", "metadata": {"source": "AIR_Lateral_Movement", "title": "RdpCoreTS Operational Log", "category": "forensics", "platform": "windows"}}
{"text": "The %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServices-RDPClient%4Operational log records the systems to which the host-initiated connections using Event IDs 1024 and 1102.", "metadata": {"source": "AIR_Lateral_Movement", "title": "RDPClient Operational Log", "category": "forensics", "platform": "windows"}}
{"text": "You may also find evidence of connections on the initiating system in the NTUSER.DAT\\Software\\Microsoft\\Terminal Server Client\\Server registry key.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Terminal Server Client Registry", "category": "forensics", "platform": "windows"}}
{"text": "Event ID 21 in this log shows session logon events, both local and remote, including the IP from which the connection was made if remote. Event ID 24 in this log shows session disconnection, including the IP from which the connection was made if remote.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 21 24 Session Events", "category": "forensics", "platform": "windows"}}
{"text": "For local logons, the Source Network Address field of the event description will read LOCAL rather than provide the remote IP.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Local Logon Source Address", "category": "forensics", "platform": "windows"}}
{"text": "You can also configure network security monitoring solutions to watch for activity on port 3389, the default RDP port. For example, Zeek provides logging of RDP activity observed on the wire.", "metadata": {"source": "AIR_Lateral_Movement", "title": "RDP Network Monitoring", "category": "defense", "platform": "windows"}}
{"text": "Malicious attackers can leverage the built-in Windows at and schtasks commands to both expand their influence and maintain persistence within a victim environment.", "metadata": {"source": "AIR_Lateral_Movement", "title": "at schtasks for Persistence", "category": "attack", "platform": "windows"}}
{"text": "The at command, while deprecated in the latest versions of Windows, is still in use on older Windows versions. The command allows for a process to be executed on regular intervals in the future on either a local or remote machine.", "metadata": {"source": "AIR_Lateral_Movement", "title": "at Command Usage", "category": "attack", "platform": "windows"}}
{"text": "at [\\\\targetIP] [HH:MM][A|P] [command]", "metadata": {"source": "AIR_Lateral_Movement", "title": "at Command Syntax", "category": "attack", "platform": "windows"}}
{"text": "schtasks /create /tn [taskname] /s [targetIP] /u [user] /p [password] /sc [frequency] /st [starttime] /sd [startdate] /tr [command]", "metadata": {"source": "AIR_Lateral_Movement", "title": "schtasks Command Syntax", "category": "attack", "platform": "windows"}}
{"text": "If run with administrator credentials, the /ru SYSTEM option allows for the specific program to be executed with System-level permissions.", "metadata": {"source": "AIR_Lateral_Movement", "title": "schtasks SYSTEM Execution", "category": "attack", "platform": "windows"}}
{"text": "Attackers with valid credentials are therefore able to schedule commands to run on systems as a means of exfiltrating data, maintaining persistent access, expanding control, or other tasks as they see fit.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Scheduled Task Attack Uses", "category": "attack", "platform": "windows"}}
{"text": "The schtasks command will list items scheduled both with schtasks and with at whereas the at command will not show jobs scheduled with schtasks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "schtasks vs at Visibility", "category": "forensics", "platform": "windows"}}
{"text": "Schtasks /query /fo csv > scheduled_tasks.csv", "metadata": {"source": "AIR_Lateral_Movement", "title": "schtasks Query Command", "category": "forensics", "platform": "windows"}}
{"text": "The PowerShell cmdlet Get-ScheduledTask will show the path, name and state of scheduled tasks when run.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Get-ScheduledTask Cmdlet", "category": "forensics", "platform": "windows"}}
{"text": "On the system where the task is scheduled, additional details can be found in the %SystemRoot%\\System32\\Tasks folder. Each task created with schtasks creates an XML file with the same name as the task in this location.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Scheduled Tasks XML Location", "category": "forensics", "platform": "windows"}}
{"text": "Under the \"RegistrationInfo\" section, the \"Author\" field shows the account used to schedule the task and the \"Date\" field shows the local system date and time when the task was registered.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Task XML RegistrationInfo", "category": "forensics", "platform": "windows"}}
{"text": "In the \"Principals\" section, the \"UserID\" field shows the user context under which the task will execute.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Task XML Principals UserID", "category": "forensics", "platform": "windows"}}
{"text": "The Triggers section provides details on when the task will run and the Exec field under the Actions section details what will be run.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Task XML Triggers Actions", "category": "forensics", "platform": "windows"}}
{"text": "The Service Controller command, sc, is able to create, stop, and start services. Services are processes that run outside of the context of a logged-on user, allowing them to start automatically at system boot time.", "metadata": {"source": "AIR_Lateral_Movement", "title": "sc Command Service Control", "category": "attack", "platform": "windows"}}
{"text": "By running a process as a service, the malicious actor can ensure persistence of the service on the system, including allowing for automating restarting or other actions should the process stop execution.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Service Persistence Mechanism", "category": "attack", "platform": "windows"}}
{"text": "net use \\\\[targetIP] [password] /u:[Admin_User]", "metadata": {"source": "AIR_Lateral_Movement", "title": "net use Authentication Syntax", "category": "attack", "platform": "windows"}}
{"text": "sc \\\\[targetIP] create [svcname] binpath= [executable]", "metadata": {"source": "AIR_Lateral_Movement", "title": "sc create Remote Syntax", "category": "attack", "platform": "windows"}}
{"text": "The executable must be packaged in a way that provides for the necessary service control options, including responding back to the OS when it has successfully started. Without this acknowledgement, Windows will kill the service after about 30 seconds.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Service Executable Requirements", "category": "attack", "platform": "windows"}}
{"text": "Any arbitrary executable can be packaged for use as a service through the use of the free ServifyThis tool made available on GitHub by InGuardians (https://github.com/inguardians/ServifyThis).", "metadata": {"source": "AIR_Lateral_Movement", "title": "ServifyThis Tool", "category": "attack", "platform": "windows"}}
{"text": "sc \\\\[targetIP] start [svcname]", "metadata": {"source": "AIR_Lateral_Movement", "title": "sc start Remote Syntax", "category": "attack", "platform": "windows"}}
{"text": "Administrators should establish a baseline of what services are running on each of their systems. This can be accomplished using WMIC or PowerShell either as a local script that runs at set intervals, or as a centralized script that queries remote systems and stores this type of data in a central location.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Service Baseline Defense", "category": "defense", "platform": "windows"}}
{"text": "Event ID 7045 records the creation of a new service on the system, including the path to the executable service file name. This event, recorded in the System event log, can be useful in identifying the creation of malicious services on victim systems.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 7045 Service Creation", "category": "forensics", "platform": "windows"}}
{"text": "When a service is created, the path to its associated executable is stored in the registry. Examining the entries in the registry under HKLM\\SYSTEM\\CurrentControlSet\\Services for unusual entries can help locate malicious services.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Services Registry Location", "category": "forensics", "platform": "windows"}}
{"text": "The ImagePath key will specify the location of the associated executable on disk for each service.", "metadata": {"source": "AIR_Lateral_Movement", "title": "ImagePath Registry Key", "category": "forensics", "platform": "windows"}}
{"text": "psexec is an administration tool that leverages SMB to remotely execute commands on other systems. While not a native Windows binary, it is provided by Sysinternals, which is owned by Microsoft.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Description", "category": "attack", "platform": "windows"}}
{"text": "The command allows remote execution of programs over an encrypted network connection when provided with the necessary credentials. If the executable to be run is not already on the target system, it can be copied by psexec to the target and then executed.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Capabilities", "category": "attack", "platform": "windows"}}
{"text": "psexec \\\\[targetIP] [-d] [-e] [-u user] [-p password] [command]", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Syntax", "category": "attack", "platform": "windows"}}
{"text": "A common technique is to use cmd.exe as the remote command to grant a remote shell to the attacker.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Remote Shell", "category": "attack", "platform": "windows"}}
{"text": "The -c switch can be added to copy the executable to the target first if the desired executable is not already on the target or is not in a location found in the system path on the target.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec -c Switch", "category": "attack", "platform": "windows"}}
{"text": "The -d switch is used to execute the specified command in a non-interactive manner and detach without waiting for the created process to terminate.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec -d Switch", "category": "attack", "platform": "windows"}}
{"text": "The -e switch can optionally be used to disable creation of a user profile on the remote system.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec -e Switch", "category": "attack", "platform": "windows"}}
{"text": "The -s switch can be used to run the remote process in the context of the System account.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec -s Switch", "category": "attack", "platform": "windows"}}
{"text": "When used for legitimate system administration tasks, note that the use of the -u switch causes the remote system to treat the logon as interactive, which results in caching of the logon credential in RAM. If the remote system is already compromised, this can expose the credential to an attacker.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Credential Caching Risk", "category": "attack", "platform": "windows"}}
{"text": "The Metasploit team has also added a version of psexec as an exploit module in the Metasploit Framework. The psexec module requires a valid credential to access the remote system, but can accept either a cleartext password or a password hash representation to facilitate pass-the-hash attacks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Metasploit PsExec Module", "category": "attack", "platform": "windows"}}
{"text": "In the absence of a valid credential, the module will attempt to logon as Guest.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Metasploit PsExec Guest Logon", "category": "attack", "platform": "windows"}}
{"text": "The psexec Metasploit exploit module uses valid administrator credentials to copy an executable to the target system, create a service to load the desired payload, delete the service it created, and then delete the uploaded executable.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Metasploit PsExec Operation", "category": "attack", "platform": "windows"}}
{"text": "By default, both the executable and the service are given a random string of characters as a name; however, arbitrary names can be specified by the attacker.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Metasploit PsExec Random Names", "category": "attack", "platform": "windows"}}
{"text": "The creation of the service generates an Event ID 7045 in the System event log, complete with the name of the service created (Service Name field) and the executable that was used to create it (Service File Name field).", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Event ID 7045 Detection", "category": "forensics", "platform": "windows"}}
{"text": "The executable may be uploaded with a random or explicitly provided name, or the Service File Name may be PowerShell run with a long, Base64-encoded command.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec PowerShell Payload", "category": "attack", "platform": "windows"}}
{"text": "If enabled, Event ID 4697 will also be logged in the Security event log recording the service being installed on the system.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4697 Service Install", "category": "forensics", "platform": "windows"}}
{"text": "By default, the Sysinternals version of psexec will also install itself as a service with a service name of PSEXESVC and an associated executable of psexesvc.exe written to disk, making it easy to spot in the event 7045 System event log records.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PSEXESVC Service Artifact", "category": "forensics", "platform": "windows"}}
{"text": "The name of the service and its associated executable can be changed to any arbitrary name using the -r switch when psexec is run.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec -r Switch Rename", "category": "attack", "platform": "windows"}}
{"text": "Unlike the Metasploit version, the Sysinternals version of psexec does not automatically delete the service upon completion.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Sysinternals PsExec Persistence", "category": "forensics", "platform": "windows"}}
{"text": "By default, the Sysinternals psexec will also cause a user profile to be created on the remote system if one does not already exist for the associated user credential.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec User Profile Creation", "category": "forensics", "platform": "windows"}}
{"text": "Checking for the presence of unusual user profiles can be a useful indicator of unauthorized activity.", "metadata": {"source": "AIR_Lateral_Movement", "title": "User Profile Anomaly Detection", "category": "forensics", "platform": "windows"}}
{"text": "When the session ends, you may see an event 7036 in the System event log showing the PSEXESVC service entering a stopped state.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 7036 PSEXESVC Stop", "category": "forensics", "platform": "windows"}}
{"text": "On the system initiating the connection, when the -u switch is used, an event 4648 is recorded, showing the account initiating the use of the credential in the Subject section, the credential provided with the -u switch in the Account Whose Credentials Were Used section, and the remote system targeted in the Target Server section.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Event ID 4648 PsExec Source", "category": "forensics", "platform": "windows"}}
{"text": "This utility also writes to a registry key in NTUSER.DAT\\Software\\Sysinternals\\PsExec where it sets the EulaAccepted value to 1. This key is named PsExec even if the attacker named the tool something else in an attempt to conceal its execution.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Registry EULA Artifact", "category": "forensics", "platform": "windows"}}
{"text": "If the attacker uses the currently logged-on user's credentials, Windows will record the access on the remote system with event 4624, Type 3 (Network logon). However, if the attacker explicitly provides a different credential to psexec with the -u switch, Windows treats this as an interactive logon (event 4624, Type 2) on the remote system.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Logon Type Detection", "category": "forensics", "platform": "windows"}}
{"text": "Other tools implementing variations on the PsExec idea exist, such as CSExec, PAExec, and RemCom.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PsExec Alternative Tools", "category": "attack", "platform": "windows"}}
{"text": "You can look for Event ID 7045 (new service was installed) and Event ID 7036 (service was started/stopped) in the System event log and Event ID 4697 in the Security event log to try to identify the malicious services associated with these types of attacks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Remote Execution Service Detection", "category": "forensics", "platform": "windows"}}
{"text": "Windows Management Instrumentation (WMI) is a Microsoft-provided platform for simplifying administrative tasks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI Description", "category": "attack", "platform": "windows"}}
{"text": "Windows Management Instrumentation Command-line utility (WMIC) is a command-line tool that can execute WMI commands on local or remote systems.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMIC Description", "category": "attack", "platform": "windows"}}
{"text": "WMIC uses Distributed Component Object Model (DCOM) to connect to remote systems to execute commands, meaning that in environments with WinRM and/or PowerShell remoting disabled, WMIC provides an attractive option to attackers.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMIC DCOM Connection", "category": "attack", "platform": "windows"}}
{"text": "PowerShell is likewise able to access and manipulate systems using WMI. The older Get-WmiObject cmdlet uses DCOM to access remote systems and the newer Get-CimInstance cmdlet uses PowerShell remoting, providing flexibility for accessing WMI on remote systems for both attackers and defenders.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell WMI Cmdlets", "category": "attack", "platform": "windows"}}
{"text": "The scope of WMI is truly massive, allowing attackers to perform a variety of actions on remote systems including listing files, enabling/unlocking user accounts, gathering system information, starting and stopping services, creating or stopping processes, and many other tasks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI Attack Capabilities", "category": "attack", "platform": "windows"}}
{"text": "WMIC does not encrypt its network traffic when run against a remote system, making network security monitoring a viable approach to detect malicious use of WMIC.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMIC Unencrypted Traffic", "category": "defense", "platform": "windows"}}
{"text": "WMI can be used as a persistence mechanism using WMI subscriptions. WMI subscriptions allow for an event to be triggered when a specific condition is met. This is a common persistence technique used by PowerShell-based, post-exploitation frameworks.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI Subscription Persistence", "category": "attack", "platform": "windows"}}
{"text": "The action that will occur is referred to as an event consumer. The event that triggers the action is called an event filter. An event filter is connected to its associated event consumer through a filter to consumer binding.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI Event Components", "category": "attack", "platform": "windows"}}
{"text": "When the event described by the filter is triggered (its condition is true), the filter sends certain events (those that matched its filter) to the event consumer to take its defined action on those events.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI Event Trigger Mechanism", "category": "attack", "platform": "windows"}}
{"text": "WMI subscriptions can be created using PowerShell or through Managed Object Format (MOF) files using mofcomp.exe.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI Subscription Creation", "category": "attack", "platform": "windows"}}
{"text": "Once created, a WMI subscription is stored in the WMI database, located in the %SystemRoot%\\wbem\\Repository folder.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI Repository Location", "category": "forensics", "platform": "windows"}}
{"text": "Sysmon can be configured to monitor WMIEventFilter activity (event 19), WMIEventConsumer activity (event 20), and WMIEventConsumerToFilter activity (event 21).", "metadata": {"source": "AIR_Lateral_Movement", "title": "Sysmon WMI Monitoring", "category": "defense", "platform": "windows"}}
{"text": "The %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-WMI-Activity%4Operational log also records information about use of WMI. Event IDs 5860 and 5861 record details of event consumers.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI-Activity Operational Log", "category": "forensics", "platform": "windows"}}
{"text": "Searching through these for encoded PowerShell commands or other unusual entries may help identify malicious use of WMI.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WMI PowerShell Detection", "category": "forensics", "platform": "windows"}}
{"text": "Tools like Autoruns can also help identify the use of WMI subscriptions as a persistence mechanism.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Autoruns WMI Detection", "category": "defense", "platform": "windows"}}
{"text": "You can query a live system for information regarding WMI subscriptions using PowerShell. The Kansa framework does this very effectively, providing the capability to stack results from different systems for comparison.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Kansa WMI Query", "category": "defense", "platform": "windows"}}
{"text": "If analyzing an offline image, WMI subscriptions are stored in the WMI database, located in the %SystemRoot%\\wbem\\Repository folder, which can be parsed using the open-source python-cim tool.", "metadata": {"source": "AIR_Lateral_Movement", "title": "python-cim WMI Parsing", "category": "forensics", "platform": "windows"}}
{"text": "Windows Remote Management (WinRM) allows for commands to be sent to remote Windows computers over HTTP or HTTPS by leveraging the Web Services for Management protocol.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WinRM Description", "category": "attack", "platform": "windows"}}
{"text": "WinRM runs as a service under the Network Service account, and as native Microsoft components, use of these tools will bypass many whitelisting solutions providing another attractive option for attackers.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WinRM Whitelist Bypass", "category": "attack", "platform": "windows"}}
{"text": "Use of the Windows Remote Services command, winrs, allows for execution of arbitrary commands on remote systems.", "metadata": {"source": "AIR_Lateral_Movement", "title": "winrs Command", "category": "attack", "platform": "windows"}}
{"text": "winrs -r:http://target_host \"cmd\"", "metadata": {"source": "AIR_Lateral_Movement", "title": "winrs Syntax", "category": "attack", "platform": "windows"}}
{"text": "WinRM utilizes TCP port 5985 for HTTP traffic and TCP port 5986 for HTTPS by default.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WinRM Default Ports", "category": "defense", "platform": "windows"}}
{"text": "These events will be logged in the %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-WinRM%4Operational log file.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WinRM Operational Log", "category": "forensics", "platform": "windows"}}
{"text": "When a connection is initiated using WinRM, Event ID 6 will be generated. This event will include the remote destination to which the connection was attempted.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WinRM Event ID 6", "category": "forensics", "platform": "windows"}}
{"text": "The appearance of Event ID 6 on local workstations or other computers where administrative tasks are not frequently done may be suspicious.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WinRM Event ID 6 Detection", "category": "forensics", "platform": "windows"}}
{"text": "Event ID 91 will be logged on the system where the connection is received. This log will include the user field which shows the account used to authenticate the connection.", "metadata": {"source": "AIR_Lateral_Movement", "title": "WinRM Event ID 91", "category": "forensics", "platform": "windows"}}
{"text": "PowerShell is another example of a tool that provides a great deal of capability, but whether that capability is used for good or evil is entirely at the discretion of the user.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Dual Use", "category": "attack", "platform": "windows"}}
{"text": "PowerShell's Remoting feature makes it the ideal mechanism to move throughout a network. Any action that can be taken on a Windows system can be taken through PowerShell, without the need for additional malware to be installed.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Remoting for Lateral Movement", "category": "attack", "platform": "windows"}}
{"text": "Empire (www.powershellempire.com) and similar projects leverage this fact into complete post-exploitation kits that allow an attacker to maintain almost unparalleled control over a victim network, all using PowerShell scripts.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Empire Framework", "category": "attack", "platform": "windows"}}
{"text": "PowerShell has become a favorite attack mechanism for adversaries of all flavors.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Attack Popularity", "category": "attack", "platform": "windows"}}
{"text": "Although Empire is no longer officially supported, it is still available for download, and many similar projects continue to advance the use of PowerShell and the underlying .NET Framework for post-exploitation command and control.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Empire Successor Projects", "category": "attack", "platform": "windows"}}
{"text": "Covenant (https://github.com/cobbr/Covenant) and the Faction C2 Framework (www.factionc2.com) are examples of projects that continue to be actively developed.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Covenant Faction C2 Tools", "category": "attack", "platform": "windows"}}
{"text": "In addition to PowerShell Remoting, many older PowerShell cmdlets support the -ComputerName parameter to execute the cmdlet on a remote system. These cmdlets generally use DCOM to accomplish this (though the mechanism may vary) rather than use PowerShell Remoting.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell ComputerName Parameter", "category": "attack", "platform": "windows"}}
{"text": "PowerShell Remoting is enabled by default for members of the Administrators group and Remote Management Users group on Windows Server 2012 and later.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Remoting Default", "category": "defense", "platform": "windows"}}
{"text": "Disabling PowerShell Remoting might discourage its use by attackers, but it also disables one of the most useful tools in the administrator's arsenal for daily administrative tasks as well as baselining and incident handling.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Remoting Trade-off", "category": "defense", "platform": "windows"}}
{"text": "Kansa allows defenders to gather data from collections of systems, stack the results, and look for deviations from the norm. Kansa can be a powerful tool in preparing for and responding to incidents.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Kansa Framework", "category": "defense", "platform": "windows"}}
{"text": "An update to the Kansa framework, ARTHIR, is also an outstanding option for incident response.", "metadata": {"source": "AIR_Lateral_Movement", "title": "ARTHIR Framework", "category": "defense", "platform": "windows"}}
{"text": "Microsoft continues to increase the logs available surrounding PowerShell to help combat its nefarious use. These logging facilities must be enabled via Group Policy, specifically at Computer Configuration > Policies > Administrative Templates > Windows Components > Windows PowerShell.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Logging Group Policy", "category": "defense", "platform": "windows"}}
{"text": "Module Logging: Logs pipeline execution events; Logs to event logs.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Module Logging", "category": "defense", "platform": "windows"}}
{"text": "Script Block Logging: Captures de-obfuscated commands sent to PowerShell; Captures the commands only, not the resulting output; Logs to event logs.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Script Block Logging", "category": "defense", "platform": "windows"}}
{"text": "Transcription: Captures PowerShell input and output; Will not capture output of outside programs that are run, only PowerShell; Logs to text files.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Transcription Logging", "category": "defense", "platform": "windows"}}
{"text": "Inside of %SystemRoot%\\System32\\winevt\\Logs\\Microsoft-Windows-PowerShell%4Operational you will find two events of particular note.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Operational Log", "category": "forensics", "platform": "windows"}}
{"text": "4103: Shows pipeline execution from the module logging facility; Includes the user context used to run the commands; Hostname field will show \"Console\" if executed locally or will show if run from a remote system; Can correlate account logon and logon events to determine further information about the source of a remote connection.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Event ID 4103", "category": "forensics", "platform": "windows"}}
{"text": "4104: Shows script block logging entries; Logs full details of each block only on first use to conserve space; Will show as a \"Warning\" level event if Microsoft deems the activity \"Suspicious.\"", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Event ID 4104", "category": "forensics", "platform": "windows"}}
{"text": "Additional entries are located in the %SystemRoot%\\System32\\winevt\\Logs\\Windows PowerShell log.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Windows PowerShell Log", "category": "forensics", "platform": "windows"}}
{"text": "Event 400: Indicates the start of command execution or session; Hostname field shows if (local) console or remote session caused the execution.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Event 400", "category": "forensics", "platform": "windows"}}
{"text": "Event 800: Shows pipeline execution details; UserID shows account used; Hostname field shows if (local) console or remote session caused the execution; Since many malicious scripts encode options with Base64, check the HostApplication field for options encoded with -enc switch.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Event 800", "category": "forensics", "platform": "windows"}}
{"text": "You may also find a PowerShell history file per user, located at %HOMEPATH%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell History File Location", "category": "forensics", "platform": "windows"}}
{"text": "You can confirm the location on a system by running the Get-PSReadLineOption cmdlet and checking the HistorySavePath.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Get-PSReadLineOption Cmdlet", "category": "forensics", "platform": "windows"}}
{"text": "The MaximumHistoryCount will show the number of lines that will be stored in the ConsoleHost_history.txt file before it starts overwriting older entries (the default is 4096).", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell History Count", "category": "forensics", "platform": "windows"}}
{"text": "Remember that PowerShell remoting uses WinRM to establish connections to remote machines. As a result, the same detection methods used for WinRM also apply to PowerShell Remoting.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell WinRM Connection", "category": "forensics", "platform": "windows"}}
{"text": "Note that regardless of whether HTTP or HTTPS is used in the WinRM transfer, PowerShell encrypts all remoting commands with AES-256 after the initial authentication.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell AES-256 Encryption", "category": "defense", "platform": "windows"}}
{"text": "Network defenders can help secure PowerShell in their environment by creating constrained endpoints with restricted PowerShell session configurations, which allows more granular control over which users can use PowerShell remoting and which cmdlets they can run.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Constrained Endpoints", "category": "defense", "platform": "windows"}}
{"text": "The Just Enough Administration PowerShell security controls can be used to provide necessary access while minimizing the risk of abuse.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Just Enough Administration", "category": "defense", "platform": "windows"}}
{"text": "Consider applying host-based firewall rules to allow inbound PowerShell Remoting sessions only from trusted administration workstations rather than from all arbitrary systems.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Firewall Rules", "category": "defense", "platform": "windows"}}
{"text": "Implement outbound restrictions to keep systems that don't need to initiate outbound PowerShell Remoting sessions from initiating outbound connections on TCP ports 5985 and 5986.", "metadata": {"source": "AIR_Lateral_Movement", "title": "PowerShell Outbound Restrictions", "category": "defense", "platform": "windows"}}
{"text": "Preventive defensive strategies designed to keep attackers from penetrating the network are no longer adequate defense. Active defense measures within the network, threat hunting for intruders, and countermeasures located within your environment are the new baseline for adequate security.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Active Defense Strategy", "category": "defense", "platform": "windows"}}
{"text": "All IT security staff must change their mindset to realize that protecting the network perimeter in order to fend off evil is a doomed enterprise.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Perimeter Defense Limitations", "category": "defense", "platform": "windows"}}
{"text": "Malicious actors will gain influence over user end points, inside staff will make mistakes, and malicious actors will occasionally emerge from the ranks of our own users.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Insider Threat Reality", "category": "defense", "platform": "windows"}}
{"text": "We must shift the defensive strategy from one of only prevention to one of prevention, detection and mitigation.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Defense Strategy Shift", "category": "defense", "platform": "windows"}}
{"text": "Networks must be designed not only to attempt to keep attackers out, but also to make their lives as difficult as possible once they do gain an internal foothold.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Defense in Depth Network Design", "category": "defense", "platform": "windows"}}
{"text": "Networks should be segmented with strong barriers in place between different logical groupings of resources.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Network Segmentation", "category": "defense", "platform": "windows"}}
{"text": "An attacker who finds himself on the inside of your network should have to fight for every inch of territory that she seeks to own, not be given free reign over a flat network with no further impediments.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Flat Network Risk", "category": "defense", "platform": "windows"}}
{"text": "Ideally, private VLANs isolating each workstation from all others, and allowing access only to the handful of resources needed by each (such as email, proxy, file servers, and possibly a default gateway) would be implemented so that an intruder's ability to further pivot throughout a network is minimized.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Private VLAN Isolation", "category": "defense", "platform": "windows"}}
{"text": "Internal networks should be forensically ready, generating adequate logging events, aggregating those logs on secure servers, and maintaining them for sufficient time to facilitate effective incident investigations.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Forensic Readiness", "category": "defense", "platform": "windows"}}
{"text": "Ensuring logging of critical events, including process tracking and command line auditing, is vital to a forensically ready network.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Process and Command Line Logging", "category": "defense", "platform": "windows"}}
{"text": "Asset inventories, network diagrams, change management procedures, and incident response plans should be current and up to date.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Documentation Requirements", "category": "defense", "platform": "windows"}}
{"text": "Security teams should use automation scripts to gather and update system baselines to be used as comparisons during incident analysis.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Automated Baseline Collection", "category": "defense", "platform": "windows"}}
{"text": "Network security monitoring should be in place to detect and deter malicious internal activity, and end points should be secured through layered defenses including antivirus, white listing, and heuristic detection mechanisms.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Endpoint Layered Defense", "category": "defense", "platform": "windows"}}
{"text": "Honey items or canaries such as heavily monitored files, digitally watermarked files, honey pot systems, honey credentials, and other mechanisms can be used to further detect malicious actors roving about areas of the network where legitimate users should not be.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Honeypots and Canaries", "category": "defense", "platform": "windows"}}
{"text": "Only by making our environments as inhospitable to attackers as possible will we be able to continue to deter attack, detect intruders, and secure our assets from the multitude of adversaries that we face.", "metadata": {"source": "AIR_Lateral_Movement", "title": "Adversary-Hostile Environment", "category": "defense", "platform": "windows"}}
