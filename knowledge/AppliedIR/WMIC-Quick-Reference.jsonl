{"text": "WMIC Quick Reference Version 20191223", "metadata": {"source": "AIR_WMIC", "title": "Document Header", "category": "reference", "platform": "windows"}}
{"text": "/Node:\"System1\",\"System2\" - Specifies the host, or comma-separated list of hosts, against which the command will run (System1,System2 in this example).", "metadata": {"source": "AIR_WMIC", "title": "WMIC Switch /Node with hosts", "category": "reference", "platform": "windows"}}
{"text": "/Node:@filename.txt - Specifies a file containing a list of hosts against which the command should be run, listed one per line (filename.txt in this example). The @ sign indicates that a file will be provided.", "metadata": {"source": "AIR_WMIC", "title": "WMIC Switch /Node with file", "category": "reference", "platform": "windows"}}
{"text": "/failfast:on - Reduces the amount of time wmic will wait on a response from a host. Useful when running against large numbers of systems, some of which may not be up and responding.", "metadata": {"source": "AIR_WMIC", "title": "WMIC Switch /failfast", "category": "reference", "platform": "windows"}}
{"text": "/User:username - An optional switch to specify an alternative username to be used as the credential for running the command against remote systems (username in this example).", "metadata": {"source": "AIR_WMIC", "title": "WMIC Switch /User", "category": "reference", "platform": "windows"}}
{"text": "/Password - An optional switch to specify the password to be used for the alternative username provided with the /User switch. This switch should never be used since it may expose the plaintext password if command-line auditing is in use. Instead, when this switch is omitted, the user is prompted for the password when the /User switch is used. This is the more secure approach.", "metadata": {"source": "AIR_WMIC", "title": "WMIC Switch /Password", "category": "reference", "platform": "windows"}}
{"text": "/Output:filename.txt - Redirect the output to a file (filename.txt in this example). Standard shell redirects like > will also work.", "metadata": {"source": "AIR_WMIC", "title": "WMIC Switch /Output", "category": "reference", "platform": "windows"}}
{"text": "/Append:filename.txt - Redirect the output to a file (filename.txt in this example) but append rather than overwrite if data already exists. Standard shell redirects like >> will also work.", "metadata": {"source": "AIR_WMIC", "title": "WMIC Switch /Append", "category": "reference", "platform": "windows"}}
{"text": "BASEBOARD - Information about the system main board", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias BASEBOARD", "category": "reference", "platform": "windows"}}
{"text": "BIOS - The Basic/Input Output System", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias BIOS", "category": "reference", "platform": "windows"}}
{"text": "COMPUTERSYSTEM - Computer name, domain name, logged-in user, and hardware details of the system", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias COMPUTERSYSTEM", "category": "reference", "platform": "windows"}}
{"text": "ENVIRONMENT - Information about system environment variables", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias ENVIRONMENT", "category": "reference", "platform": "windows"}}
{"text": "GROUP - Information about groups", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias GROUP", "category": "reference", "platform": "windows"}}
{"text": "LOGICALDISK - Information on volumes, including filesystem and free space", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias LOGICALDISK", "category": "reference", "platform": "windows"}}
{"text": "NICCONFIG - Information about network card, IP address", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias NICCONFIG", "category": "reference", "platform": "windows"}}
{"text": "OS - Information about the installed OS, including version", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias OS", "category": "reference", "platform": "windows"}}
{"text": "PAGEFILE - Information about the system's pagefile", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias PAGEFILE", "category": "reference", "platform": "windows"}}
{"text": "PROCESS - Information about running processes", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias PROCESS", "category": "reference", "platform": "windows"}}
{"text": "PRODUCT - Information about software products installed", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias PRODUCT", "category": "reference", "platform": "windows"}}
{"text": "QFE - Information about Windows updates applied (stands for Quick Fix Engineering)", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias QFE", "category": "reference", "platform": "windows"}}
{"text": "SERVICE - Information about services", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias SERVICE", "category": "reference", "platform": "windows"}}
{"text": "SHARE - Information about network shares", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias SHARE", "category": "reference", "platform": "windows"}}
{"text": "STARTUP - Limited information about user startup items", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias STARTUP", "category": "reference", "platform": "windows"}}
{"text": "USERACCOUNT - Information about configured user accounts", "metadata": {"source": "AIR_WMIC", "title": "WMIC Alias USERACCOUNT", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator = (Equal to)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator Equal", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator < (Less than)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator Less Than", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator > (Greater than)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator Greater Than", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator <= (Less than or equal to)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator Less Than or Equal", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator >= (Greater than or equal to)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator Greater Than or Equal", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator != or <> (Not equal to)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator Not Equal", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator IS (Valid only to compare a value to NULL)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator IS", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator IS NOT (Valid only to compare a value to NULL)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator IS NOT", "category": "reference", "platform": "windows"}}
{"text": "WQL where clause operator LIKE (Allows for pattern matching of a string)", "metadata": {"source": "AIR_WMIC", "title": "WQL Operator LIKE", "category": "reference", "platform": "windows"}}
{"text": "Provide a brief listing of the environment variables on the local system and stores the results, formatted as a list, to a text file on a remote share on server1: wmic environment list brief /format:list > \\\\server1\\BaselineData\\Client2\\environment.txt", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Environment Variables", "category": "reference", "platform": "windows"}}
{"text": "Query a remote system called server1 to get the name, process ID, parent process ID, thread count, handle count, and command line used to start each process. Output the results to a file called processes.txt on the local system: wmic /node:server1 /output:processes.txt process get name, processid, parentprocessid, threadcount, handlecount, commandline", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Remote Process Query", "category": "reference", "platform": "windows"}}
{"text": "Delete all processes named scvhost.exe on the local system: wmic process where name=\"scvhost.exe\" delete", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Delete Process", "category": "reference", "platform": "windows"}}
{"text": "Display the name and executable path of any process running on the local system where \"Download\" is included in the path to the associated executable: wmic process where (ExecutablePath LIKE \"%Download%\") get name, executablepath", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Process Path Filter", "category": "reference", "platform": "windows"}}
{"text": "Display the name executable path, and parent process ID of any process running on the local system where \"Windows\" is not included in the path to the associated executable: wmic process where (NOT ExecutablePath LIKE \"%Windows%\") get name, executablepath, ParentProcessID", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Process Exclude Windows Path", "category": "reference", "platform": "windows"}}
{"text": "Enable PowerShell Remoting on a remote system called server1: wmic /node:server1 process call create \"winrm quickconfig\"", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Enable PowerShell Remoting", "category": "reference", "platform": "windows"}}
{"text": "Display the IP address, MAC address, Default Gateway and DNS host name for the local system: wmic nicconfig get MACAddress, DefaultIPGateway, IPAddress, DNSHostName", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Network Configuration", "category": "reference", "platform": "windows"}}
{"text": "Display the shares hosted on a remote system called server1: wmic /node:server1 share list brief", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example List Shares", "category": "reference", "platform": "windows"}}
{"text": "Exclude the default administrative shares from the above-mentioned list: wmic /node:server1 share where (NOT Name LIKE \"%$\") list brief", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Exclude Admin Shares", "category": "reference", "platform": "windows"}}
{"text": "Output the name, caption, state, start mode, and path to executable for services running on the remote system server1 to a CSV file called services.csv: wmic /node:Server1 /user:administrator@company.demo service get Name, Caption, State, StartMode, pathname /format:csv > services.csv", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example Services to CSV", "category": "reference", "platform": "windows"}}
{"text": "Display details of quick fix engineering patches applied to a list of systems. The list is stored one system per line in the Systems.txt file: wmic /node:@Systems.txt qfe get csname, description, FixComments, HotFixID, InstalledBy, InstalledOn, ServicePackInEffect", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example QFE Patches", "category": "reference", "platform": "windows"}}
{"text": "Example of using a for loop to perform multiple queries a list of systems (in Systems.txt), outputting the results for each system into a text file named for that system and the date in YYYMMDD format: for /F %i in (Systems.txt) do @echo scanning %i & wmic /node:%i /failfast:on process get name, processid, parentprocessid, threadcount, handlecount >> %i%date:~-4,4%%date:~-7,2%%date:~-10,2%.txt & wmic /node:%i /failfast:on environment list brief >> %i%date:~-4,4%%date:~-7,2%%date:~-10,2%.txt & wmic /node:%i /failfast:on nicconfig get MACAddress, DefaultIPGateway, IPAddress, IPSubnet, DNSHostName, DNSDomain >> %i%date:~-4,4%%date:~-7,2%%date:~-10,2%.txt & wmic /node:%i /failfast:on service get Name, Caption, State, ServiceType, StartMode, pathname >> %i%date:~-4,4%%date:~-7,2%%date:~-10,2%.txt & wmic /node:%i /failfast:on qfe get description, FixComments, HotFixID, InstalledBy, InstalledOn, ServicePackInEffect >> %i%date:~-4,4%%date:~-7,2%%date:~-10,2%.txt", "metadata": {"source": "AIR_WMIC", "title": "WMIC Example For Loop Multi-Query", "category": "reference", "platform": "windows"}}
